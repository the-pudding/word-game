var us=Object.defineProperty,cs=Object.defineProperties;var hs=Object.getOwnPropertyDescriptors;var Kr=Object.getOwnPropertySymbols;var ds=Object.prototype.hasOwnProperty,fs=Object.prototype.propertyIsEnumerable;var Xr=(n,e,t)=>e in n?us(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,xe=(n,e)=>{for(var t in e||(e={}))ds.call(e,t)&&Xr(n,t,e[t]);if(Kr)for(var t of Kr(e))fs.call(e,t)&&Xr(n,t,e[t]);return n},dt=(n,e)=>cs(n,hs(e));import{S as Z,i as ee,s as te,e as y,c as b,b as S,g as P,d,l as ae,N as ps,M as m,E as q,O as nt,t as O,k as C,a as T,h as j,m as N,P as ce,G as wt,Q as L,R as ve,v as yt,C as Qr,T as ms,U as vs,V as qn,j as oe,W as gs,X as me,q as x,n as _e,o as F,p as we,w as re,x as ne,y as se,B as ie,Y as _s,Z as ws,_ as Er,$ as Wn,a0 as Jn,a1 as $t,a2 as Vn,a3 as ys,f as bs,a4 as ks,H as Es,a5 as Ts,a6 as Ss,a7 as Os}from"./index-5fe9b45c.js";import{d as Nt,w as Pe}from"./index-0e2bbb5e.js";function Zr(n,e,t){const r=n.slice();return r[5]=e[t],r}function en(n){let e,t;return{c(){e=y("link"),this.h()},l(r){e=b(r,"LINK",{rel:!0,href:!0,as:!0,type:!0,crossorigin:!0}),this.h()},h(){S(e,"rel","preload"),S(e,"href",t=n[5]),S(e,"as","font"),S(e,"type","font/woff2"),S(e,"crossorigin","")},m(r,s){P(r,e,s)},p(r,s){s&16&&t!==(t=r[5])&&S(e,"href",t)},d(r){r&&d(e)}}}function js(n){let e,t,r,s,i,o,a,l,u,h,c,f,g,v,_,E,k,$,U,W,M,R,z,D,J,Y;document.title=e=n[0];let I=n[4],H=[];for(let B=0;B<I.length;B+=1)H[B]=en(Zr(n,I,B));return{c(){t=y("meta"),r=y("meta"),s=y("meta"),i=y("meta"),o=y("meta"),a=y("meta"),l=y("meta"),u=y("meta"),h=y("meta"),c=y("meta"),g=y("meta"),v=y("meta"),_=y("meta"),E=y("meta"),k=y("meta"),$=y("meta"),U=y("meta"),W=y("meta"),M=y("meta"),z=y("meta"),D=y("link");for(let B=0;B<H.length;B+=1)H[B].c();Y=ae(),this.h()},l(B){const p=ps('[data-svelte="svelte-1ad9fm2"]',document.head);t=b(p,"META",{name:!0,content:!0}),r=b(p,"META",{name:!0,content:!0}),s=b(p,"META",{name:!0,content:!0}),i=b(p,"META",{property:!0,content:!0}),o=b(p,"META",{property:!0,content:!0}),a=b(p,"META",{property:!0,content:!0}),l=b(p,"META",{property:!0,content:!0}),u=b(p,"META",{property:!0,content:!0}),h=b(p,"META",{property:!0,content:!0}),c=b(p,"META",{property:!0,content:!0}),g=b(p,"META",{property:!0,content:!0}),v=b(p,"META",{property:!0,content:!0}),_=b(p,"META",{property:!0,content:!0}),E=b(p,"META",{name:!0,content:!0}),k=b(p,"META",{name:!0,content:!0}),$=b(p,"META",{name:!0,content:!0}),U=b(p,"META",{name:!0,content:!0}),W=b(p,"META",{name:!0,content:!0}),M=b(p,"META",{name:!0,content:!0}),z=b(p,"META",{name:!0,content:!0}),D=b(p,"LINK",{rel:!0,href:!0});for(let w=0;w<H.length;w+=1)H[w].l(p);Y=ae(),p.forEach(d),this.h()},h(){S(t,"name","description"),S(t,"content",n[1]),S(r,"name","author"),S(r,"content","The Pudding"),S(s,"name","news_keywords"),S(s,"content",n[3]),S(i,"property","og:title"),S(i,"content",n[0]),S(o,"property","og:site_name"),S(o,"content","The Pudding"),S(a,"property","og:url"),S(a,"content",n[2]),S(l,"property","og:description"),S(l,"content",n[1]),S(u,"property","og:type"),S(u,"content","article"),S(h,"property","og:locale"),S(h,"content","en_US"),S(c,"property","og:image"),S(c,"content",f=n[2]+"/assets/social-facebook.jpg"),S(g,"property","og:image:type"),S(g,"content","image/jpeg"),S(v,"property","og:image:width"),S(v,"content","1200"),S(_,"property","og:image:height"),S(_,"content","600"),S(E,"name","twitter:card"),S(E,"content","summary_large_image"),S(k,"name","twitter:site"),S(k,"content","https://pudding.cool"),S($,"name","twitter:creator"),S($,"content","@puddingviz"),S(U,"name","twitter:title"),S(U,"content",n[0]),S(W,"name","twitter:description"),S(W,"content",n[1]),S(M,"name","twitter:image:src"),S(M,"content",R=n[2]+"/assets/social-twitter.jpg"),S(z,"name","robots"),S(z,"content","max-image-preview:large"),S(D,"rel","canonical"),S(D,"href",J=n[2]+"/")},m(B,p){m(document.head,t),m(document.head,r),m(document.head,s),m(document.head,i),m(document.head,o),m(document.head,a),m(document.head,l),m(document.head,u),m(document.head,h),m(document.head,c),m(document.head,g),m(document.head,v),m(document.head,_),m(document.head,E),m(document.head,k),m(document.head,$),m(document.head,U),m(document.head,W),m(document.head,M),m(document.head,z),m(document.head,D);for(let w=0;w<H.length;w+=1)H[w].m(document.head,null);m(document.head,Y)},p(B,[p]){if(p&1&&e!==(e=B[0])&&(document.title=e),p&2&&S(t,"content",B[1]),p&8&&S(s,"content",B[3]),p&1&&S(i,"content",B[0]),p&4&&S(a,"content",B[2]),p&2&&S(l,"content",B[1]),p&4&&f!==(f=B[2]+"/assets/social-facebook.jpg")&&S(c,"content",f),p&1&&S(U,"content",B[0]),p&2&&S(W,"content",B[1]),p&4&&R!==(R=B[2]+"/assets/social-twitter.jpg")&&S(M,"content",R),p&4&&J!==(J=B[2]+"/")&&S(D,"href",J),p&16){I=B[4];let w;for(w=0;w<I.length;w+=1){const A=Zr(B,I,w);H[w]?H[w].p(A,p):(H[w]=en(A),H[w].c(),H[w].m(Y.parentNode,Y))}for(;w<H.length;w+=1)H[w].d(1);H.length=I.length}},i:q,o:q,d(B){d(t),d(r),d(s),d(i),d(o),d(a),d(l),d(u),d(h),d(c),d(g),d(v),d(_),d(E),d(k),d($),d(U),d(W),d(M),d(z),d(D),nt(H,B),d(Y)}}}function Ps(n,e,t){let{title:r="Title TK"}=e,{description:s="Description TK"}=e,{url:i="https://pudding.cool"}=e,{keywords:o=""}=e,{preloadFont:a=[]}=e;return n.$$set=l=>{"title"in l&&t(0,r=l.title),"description"in l&&t(1,s=l.description),"url"in l&&t(2,i=l.url),"keywords"in l&&t(3,o=l.keywords),"preloadFont"in l&&t(4,a=l.preloadFont)},[r,s,i,o,a]}class Ll extends Z{constructor(e){super(),ee(this,e,Ps,js,te,{title:0,description:1,url:2,keywords:3,preloadFont:4})}}function $s(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function Rs(n,e,t){n=+n,e=+e,t=(s=arguments.length)<2?(e=n,n=0,1):s<3?1:+t;for(var r=-1,s=Math.max(0,Math.ceil((e-n)/t))|0,i=new Array(s);++r<s;)i[r]=n+r*t;return i}var As=Is(Math.random);function Is(n){return function(t,r=0,s=t.length){let i=s-(r=+r);for(;i;){const o=n()*i--|0,a=t[i+r];t[i+r]=t[o+r],t[o+r]=a}return t}}function fr(n,e){let t=0;if(e===void 0)for(let r of n)(r=+r)&&(t+=r);else{let r=-1;for(let s of n)(s=+e(s,++r,n))&&(t+=s)}return t}var tn={},ur={},cr=34,ft=10,hr=13;function Yn(n){return new Function("d","return {"+n.map(function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'}).join(",")+"}")}function Cs(n,e){var t=Yn(n);return function(r,s){return e(t(r),s,n)}}function rn(n){var e=Object.create(null),t=[];return n.forEach(function(r){for(var s in r)s in e||t.push(e[s]=s)}),t}function pe(n,e){var t=n+"",r=t.length;return r<e?new Array(e-r+1).join(0)+t:t}function Ns(n){return n<0?"-"+pe(-n,6):n>9999?"+"+pe(n,6):pe(n,4)}function xs(n){var e=n.getUTCHours(),t=n.getUTCMinutes(),r=n.getUTCSeconds(),s=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":Ns(n.getUTCFullYear())+"-"+pe(n.getUTCMonth()+1,2)+"-"+pe(n.getUTCDate(),2)+(s?"T"+pe(e,2)+":"+pe(t,2)+":"+pe(r,2)+"."+pe(s,3)+"Z":r?"T"+pe(e,2)+":"+pe(t,2)+":"+pe(r,2)+"Z":t||e?"T"+pe(e,2)+":"+pe(t,2)+"Z":"")}function Us(n){var e=new RegExp('["'+n+`
\r]`),t=n.charCodeAt(0);function r(c,f){var g,v,_=s(c,function(E,k){if(g)return g(E,k-1);v=E,g=f?Cs(E,f):Yn(E)});return _.columns=v||[],_}function s(c,f){var g=[],v=c.length,_=0,E=0,k,$=v<=0,U=!1;c.charCodeAt(v-1)===ft&&--v,c.charCodeAt(v-1)===hr&&--v;function W(){if($)return ur;if(U)return U=!1,tn;var R,z=_,D;if(c.charCodeAt(z)===cr){for(;_++<v&&c.charCodeAt(_)!==cr||c.charCodeAt(++_)===cr;);return(R=_)>=v?$=!0:(D=c.charCodeAt(_++))===ft?U=!0:D===hr&&(U=!0,c.charCodeAt(_)===ft&&++_),c.slice(z+1,R-1).replace(/""/g,'"')}for(;_<v;){if((D=c.charCodeAt(R=_++))===ft)U=!0;else if(D===hr)U=!0,c.charCodeAt(_)===ft&&++_;else if(D!==t)continue;return c.slice(z,R)}return $=!0,c.slice(z,v)}for(;(k=W())!==ur;){for(var M=[];k!==tn&&k!==ur;)M.push(k),k=W();f&&(M=f(M,E++))==null||g.push(M)}return g}function i(c,f){return c.map(function(g){return f.map(function(v){return h(g[v])}).join(n)})}function o(c,f){return f==null&&(f=rn(c)),[f.map(h).join(n)].concat(i(c,f)).join(`
`)}function a(c,f){return f==null&&(f=rn(c)),i(c,f).join(`
`)}function l(c){return c.map(u).join(`
`)}function u(c){return c.map(h).join(n)}function h(c){return c==null?"":c instanceof Date?xs(c):e.test(c+="")?'"'+c.replace(/"/g,'""')+'"':c}return{parse:r,parseRows:s,format:o,formatBody:a,formatRows:l,formatRow:u,formatValue:h}}var Ds=Us(","),Ms=Ds.parse;function Bs(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Rt(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,r=n.slice(0,t);return[r.length>1?r[0]+r.slice(2):r,+n.slice(t+1)]}function Ls(n){return n=Rt(Math.abs(n)),n?n[1]:NaN}function zs(n,e){return function(t,r){for(var s=t.length,i=[],o=0,a=n[0],l=0;s>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),i.push(t.substring(s-=a,s+a)),!((l+=a+1)>r));)a=n[o=(o+1)%n.length];return i.reverse().join(e)}}function Fs(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var Gs=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pr(n){if(!(e=Gs.exec(n)))throw new Error("invalid format: "+n);var e;return new Tr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}pr.prototype=Tr.prototype;function Tr(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}Tr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Hs(n){e:for(var e=n.length,t=1,r=-1,s;t<e;++t)switch(n[t]){case".":r=s=t;break;case"0":r===0&&(r=t),s=t;break;default:if(!+n[t])break e;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(s+1):n}var Kn;function qs(n,e){var t=Rt(n,e);if(!t)return n+"";var r=t[0],s=t[1],i=s-(Kn=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Rt(n,Math.max(0,e+i-1))[0]}function nn(n,e){var t=Rt(n,e);if(!t)return n+"";var r=t[0],s=t[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}var sn={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:Bs,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>nn(n*100,e),r:nn,s:qs,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function on(n){return n}var an=Array.prototype.map,ln=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Ws(n){var e=n.grouping===void 0||n.thousands===void 0?on:zs(an.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",s=n.decimal===void 0?".":n.decimal+"",i=n.numerals===void 0?on:Fs(an.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"\u2212":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function u(c){c=pr(c);var f=c.fill,g=c.align,v=c.sign,_=c.symbol,E=c.zero,k=c.width,$=c.comma,U=c.precision,W=c.trim,M=c.type;M==="n"?($=!0,M="g"):sn[M]||(U===void 0&&(U=12),W=!0,M="g"),(E||f==="0"&&g==="=")&&(E=!0,f="0",g="=");var R=_==="$"?t:_==="#"&&/[boxX]/.test(M)?"0"+M.toLowerCase():"",z=_==="$"?r:/[%p]/.test(M)?o:"",D=sn[M],J=/[defgprs%]/.test(M);U=U===void 0?6:/[gprs]/.test(M)?Math.max(1,Math.min(21,U)):Math.max(0,Math.min(20,U));function Y(I){var H=R,B=z,p,w,A;if(M==="c")B=D(I)+B,I="";else{I=+I;var K=I<0||1/I<0;if(I=isNaN(I)?l:D(Math.abs(I),U),W&&(I=Hs(I)),K&&+I==0&&v!=="+"&&(K=!1),H=(K?v==="("?v:a:v==="-"||v==="("?"":v)+H,B=(M==="s"?ln[8+Kn/3]:"")+B+(K&&v==="("?")":""),J){for(p=-1,w=I.length;++p<w;)if(A=I.charCodeAt(p),48>A||A>57){B=(A===46?s+I.slice(p+1):I.slice(p))+B,I=I.slice(0,p);break}}}$&&!E&&(I=e(I,1/0));var V=H.length+I.length+B.length,G=V<k?new Array(k-V+1).join(f):"";switch($&&E&&(I=e(G+I,G.length?k-B.length:1/0),G=""),g){case"<":I=H+I+B+G;break;case"=":I=H+G+I+B;break;case"^":I=G.slice(0,V=G.length>>1)+H+I+B+G.slice(V);break;default:I=G+H+I+B;break}return i(I)}return Y.toString=function(){return c+""},Y}function h(c,f){var g=u((c=pr(c),c.type="f",c)),v=Math.max(-8,Math.min(8,Math.floor(Ls(f)/3)))*3,_=Math.pow(10,-v),E=ln[8+v/3];return function(k){return g(_*k)+E}}return{format:u,formatPrefix:h}}var Tt,Xn;Js({thousands:",",grouping:[3],currency:["$",""]});function Js(n){return Tt=Ws(n),Xn=Tt.format,Tt.formatPrefix,Tt}function Qe(n,e,t){this.k=n,this.x=e,this.y=t}Qe.prototype={constructor:Qe,scale:function(n){return n===1?this:new Qe(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new Qe(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new Qe(1,0,0);Qe.prototype;const At=4,un=()=>Rs(At).map(()=>[]),cn=n=>fr(n.filter(e=>e.valid),e=>e.points),It=Pe(),tt=Pe(!1),Ee=Pe(-1),Sr=Nt([Ee,tt],([n,e],t)=>{n>=At-1&&!e?t("post"):t(!e&&n===-1?"pre":"mid")}),Te=Pe({user:un(),opponent:un()}),mr=Pe([]),Vs=Nt(Te,(n,e)=>{const t=n.user.map(cn),r=n.opponent.map(cn);e({user:t,opponent:r})}),Or=Nt(Vs,(n,e)=>{const t=fr(n.user),r=fr(n.opponent);e({user:t,opponent:r})}),Ys=n=>[].concat(...n),hn=n=>{const e=n.filter(t=>t.valid).map(t=>t.lemmas.split("|"));return Ys(e)},jr=Nt([Te,Ee],([n,e],t)=>{if(e<0)return;const r=hn(n.user[e]),s=hn(n.opponent[e]),i=[...r,...s];t(i)}),ye=Pe(void 0),ze=Pe(void 0),xt=Pe(void 0);function Ks(n){let e,t,r,s,i,o,a,l,u,h,c;return{c(){e=y("nav"),t=y("button"),r=O("Hamburger"),s=C(),i=y("button"),o=O("Rules"),a=C(),l=y("button"),u=O("About"),this.h()},l(f){e=b(f,"NAV",{class:!0});var g=T(e);t=b(g,"BUTTON",{});var v=T(t);r=j(v,"Hamburger"),v.forEach(d),s=N(g),i=b(g,"BUTTON",{});var _=T(i);o=j(_,"Rules"),_.forEach(d),a=N(g),l=b(g,"BUTTON",{});var E=T(l);u=j(E,"About"),E.forEach(d),g.forEach(d),this.h()},h(){S(e,"class","svelte-bz9c25")},m(f,g){P(f,e,g),m(e,t),m(t,r),m(e,s),m(e,i),m(i,o),m(e,a),m(e,l),m(l,u),h||(c=[ce(t,"click",n[1]),ce(i,"click",n[2]),ce(l,"click",n[3])],h=!0)},p:q,i:q,o:q,d(f){f&&d(e),h=!1,wt(c)}}}function Xs(n,e,t){let r;return L(n,ye,a=>t(0,r=a)),[r,()=>{ve(ye,r="hamburger",r)},()=>{ve(ye,r="rules",r)},()=>{ve(ye,r="about",r)}]}class Qs extends Z{constructor(e){super(),ee(this,e,Xs,Ks,te,{})}}let Ue,mt;const rt=Pe(0),Qn=n=>{mt||(mt=n);const e=Math.round(n-mt);mt=n,rt.update(t=>t+e),Ue=window.requestAnimationFrame(Qn)},vt={start(){Ue||(mt=null,Ue=window.requestAnimationFrame(Qn))},stop(){Ue&&(window.cancelAnimationFrame(Ue),Ue=null)},toggle(){Ue?vt.stop():vt.start()},set(n){typeof n=="number"&&rt.set(n)},reset(){rt.set(0)}},Pt=({lemmas:n,corpus:e})=>!!n.split("|").filter(r=>!!e.find(s=>s===r)).length;async function Ut(n){const t=await(await fetch(n)).text();return Ms(t)}async function Zs(n){const e=`https://pudding.cool/projects/word-game-data/wod-answers/${n}.csv?version=${Date.now()}`;return(await Ut(e)).map(s=>dt(xe({},s),{round:+s.round,timestamp:+s.timestamp,points:+s.points}))}function ei(n,e,t){let r,s,i,o,a;L(n,It,f=>t(2,r=f)),L(n,Ee,f=>t(3,s=f)),L(n,Te,f=>t(4,i=f)),L(n,rt,f=>t(0,o=f)),L(n,jr,f=>t(5,a=f));let l=[];const u=f=>Pt({lemmas:f,corpus:a}),h=({lemmas:f})=>{const g=!u(f);return{valid:g,reason:g?void 0:0}},c=()=>{const f=l.findIndex(g=>g.round===s&&o>=g.timestamp);if(f>-1){const[g]=l.splice(f,1),v=xe(xe({},g),h(g));ve(Te,i.wod[s]=[...i.wod[s],v],i)}};return yt(async()=>{l=await Zs(r)}),n.$$.update=()=>{n.$$.dirty&1&&c()},[o]}class ti extends Z{constructor(e){super(),ee(this,e,ei,null,te,{})}}function dn(n){return Object.prototype.toString.call(n)==="[object Date]"}function vr(n,e){if(n===e||n!==n)return()=>n;const t=typeof n;if(t!==typeof e||Array.isArray(n)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(n)){const r=e.map((s,i)=>vr(n[i],s));return s=>r.map(i=>i(s))}if(t==="object"){if(!n||!e)throw new Error("Object cannot be null");if(dn(n)&&dn(e)){n=n.getTime(),e=e.getTime();const i=e-n;return o=>new Date(n+o*i)}const r=Object.keys(e),s={};return r.forEach(i=>{s[i]=vr(n[i],e[i])}),i=>{const o={};return r.forEach(a=>{o[a]=s[a](i)}),o}}if(t==="number"){const r=e-n;return s=>n+s*r}throw new Error(`Cannot interpolate ${t} values`)}function Zn(n,e={}){const t=Pe(n);let r,s=n;function i(o,a){if(n==null)return t.set(n=o),Promise.resolve();s=o;let l=r,u=!1,{delay:h=0,duration:c=400,easing:f=qn,interpolate:g=vr}=Qr(Qr({},e),a);if(c===0)return l&&(l.abort(),l=null),t.set(n=s),Promise.resolve();const v=ms()+h;let _;return r=vs(E=>{if(E<v)return!0;u||(_=g(n,o),typeof c=="function"&&(c=c(n,o)),u=!0),l&&(l.abort(),l=null);const k=E-v;return k>c?(t.set(n=o),!1):(t.set(n=_(f(k/c))),!0)}),r.promise}return{set:i,update:(o,a)=>i(o(s,n),a),subscribe:t.subscribe}}function ri(n,{delay:e=0,duration:t=400,easing:r=qn}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:i=>`opacity: ${i*s}`}}function fn(n){let e,t,r,s;return{c(){e=y("span"),t=O(n[2]),this.h()},l(i){e=b(i,"SPAN",{class:!0});var o=T(e);t=j(o,n[2]),o.forEach(d),this.h()},h(){S(e,"class","svelte-xlb350")},m(i,o){P(i,e,o),m(e,t),s=!0},p(i,o){(!s||o&4)&&oe(t,i[2])},i(i){s||(r&&r.end(1),s=!0)},o(i){r=gs(e,ri,{}),s=!1},d(i){i&&d(e),i&&r&&r.end()}}}function ni(n){let e,t,r,s,i=n[1]&&fn(n);return{c(){e=y("li"),t=O(n[3]),r=C(),i&&i.c(),this.h()},l(o){e=b(o,"LI",{class:!0});var a=T(e);t=j(a,n[3]),r=N(a),i&&i.l(a),a.forEach(d),this.h()},h(){S(e,"class","svelte-xlb350"),me(e,"invalid",n[0])},m(o,a){P(o,e,a),m(e,t),m(e,r),i&&i.m(e,null),s=!0},p(o,[a]){(!s||a&8)&&oe(t,o[3]),o[1]?i?(i.p(o,a),a&2&&x(i,1)):(i=fn(o),i.c(),x(i,1),i.m(e,null)):i&&(_e(),F(i,1,1,()=>{i=null}),we()),a&1&&me(e,"invalid",o[0])},i(o){s||(x(i),s=!0)},o(o){F(i),s=!1},d(o){o&&d(e),i&&i.d()}}}function si(n,e,t){let r,s,i,o,{wod:a}=e,{valid:l}=e,{text:u}=e,{revealWod:h}=e,{points:c}=e;const f=Zn(0,{duration:1e3});let g=!0;return f.set(1).then(()=>{t(9,g=!1)}),n.$$set=v=>{"wod"in v&&t(4,a=v.wod),"valid"in v&&t(5,l=v.valid),"text"in v&&t(6,u=v.text),"revealWod"in v&&t(7,h=v.revealWod),"points"in v&&t(8,c=v.points)},n.$$.update=()=>{n.$$.dirty&240&&t(3,r=a&&l&&!h?u.split("").map(()=>"\u2589").join(""):u),n.$$.dirty&32&&t(0,s=!l),n.$$.dirty&257&&t(2,i=s||!c?"":`+${c}`),n.$$.dirty&656&&t(1,o=g&&(!a||!h))},[s,o,i,r,a,l,u,h,c,g]}class ii extends Z{constructor(e){super(),ee(this,e,si,ni,te,{wod:4,valid:5,text:6,revealWod:7,points:8})}}function pn(n,e,t){const r=n.slice();return r[2]=e[t].valid,r[3]=e[t].text,r[4]=e[t].revealWod,r[5]=e[t].points,r}function mn(n,e){let t,r,s;return r=new ii({props:{wod:e[1],valid:e[2],text:e[3],revealWod:e[4],points:e[5]}}),{key:n,first:null,c(){t=ae(),re(r.$$.fragment),this.h()},l(i){t=ae(),ne(r.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){P(i,t,o),se(r,i,o),s=!0},p(i,o){e=i;const a={};o&2&&(a.wod=e[1]),o&1&&(a.valid=e[2]),o&1&&(a.text=e[3]),o&1&&(a.revealWod=e[4]),o&1&&(a.points=e[5]),r.$set(a)},i(i){s||(x(r.$$.fragment,i),s=!0)},o(i){F(r.$$.fragment,i),s=!1},d(i){i&&d(t),ie(r,i)}}}function oi(n){let e,t=[],r=new Map,s,i=n[0];const o=a=>a[3];for(let a=0;a<i.length;a+=1){let l=pn(n,i,a),u=o(l);r.set(u,t[a]=mn(u,l))}return{c(){e=y("ul");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=b(a,"UL",{class:!0});var l=T(e);for(let u=0;u<t.length;u+=1)t[u].l(l);l.forEach(d),this.h()},h(){S(e,"class","svelte-12ad0m2")},m(a,l){P(a,e,l);for(let u=0;u<t.length;u+=1)t[u].m(e,null);s=!0},p(a,[l]){l&3&&(i=a[0],_e(),t=_s(t,l,o,1,a,i,r,e,ws,mn,null,pn),we())},i(a){if(!s){for(let l=0;l<i.length;l+=1)x(t[l]);s=!0}},o(a){for(let l=0;l<t.length;l+=1)F(t[l]);s=!1},d(a){a&&d(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function ai(n,e,t){let{guesses:r}=e,{wod:s=!1}=e;return n.$$set=i=>{"guesses"in i&&t(0,r=i.guesses),"wod"in i&&t(1,s=i.wod)},[r,s]}class es extends Z{constructor(e){super(),ee(this,e,ai,oi,te,{guesses:0,wod:1})}}function vn(n){let e,t;return e=new es({props:{guesses:n[0],wod:!0}}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},p(r,s){const i={};s&1&&(i.guesses=r[0]),e.$set(i)},i(r){t||(x(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function li(n){let e,t,r,s;t=new es({props:{guesses:n[1]}});let i=!n[2]&&vn(n);return{c(){e=y("div"),re(t.$$.fragment),r=C(),i&&i.c(),this.h()},l(o){e=b(o,"DIV",{class:!0});var a=T(e);ne(t.$$.fragment,a),r=N(a),i&&i.l(a),a.forEach(d),this.h()},h(){S(e,"class","svelte-7qsaem")},m(o,a){P(o,e,a),se(t,e,null),m(e,r),i&&i.m(e,null),s=!0},p(o,[a]){const l={};a&2&&(l.guesses=o[1]),t.$set(l),o[2]?i&&(_e(),F(i,1,1,()=>{i=null}),we()):i?(i.p(o,a),a&4&&x(i,1)):(i=vn(o),i.c(),x(i,1),i.m(e,null))},i(o){s||(x(t.$$.fragment,o),x(i),s=!0)},o(o){F(t.$$.fragment,o),F(i),s=!1},d(o){o&&d(e),ie(t),i&&i.d()}}}const ui=0;function ci(n,e,t){let r,s,i,o,a;L(n,Ee,u=>t(3,i=u)),L(n,Te,u=>t(4,o=u)),L(n,ze,u=>t(2,a=u));const l=u=>u.reason===void 0||u.reason===ui;return n.$$.update=()=>{n.$$.dirty&24&&t(1,r=o.user[i].filter(l)),n.$$.dirty&24&&t(0,s=o.wod[i].filter(l))},[s,r,a,i,o]}class hi extends Z{constructor(e){super(),ee(this,e,ci,li,te,{})}}var di=[{row:0,value:"q"},{row:0,value:"w"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"a"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:2,value:"Shift"},{row:2,value:"z"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"m"},{row:2,value:"Backspace"},{row:3,value:"Page1"},{row:3,value:","},{row:3,value:"Space"},{row:3,value:"."},{row:3,value:"Enter"},{row:0,value:"1",page:1},{row:0,value:"2",page:1},{row:0,value:"3",page:1},{row:0,value:"4",page:1},{row:0,value:"5",page:1},{row:0,value:"6",page:1},{row:0,value:"7",page:1},{row:0,value:"8",page:1},{row:0,value:"9",page:1},{row:0,value:"0",page:1},{row:1,value:"!",page:1},{row:1,value:"@",page:1},{row:1,value:"#",page:1},{row:1,value:"$",page:1},{row:1,value:"%",page:1},{row:1,value:"^",page:1},{row:1,value:"&",page:1},{row:1,value:"*",page:1},{row:1,value:"(",page:1},{row:1,value:")",page:1},{row:2,value:"-",page:1},{row:2,value:"_",page:1},{row:2,value:"=",page:1},{row:2,value:"+",page:1},{row:2,value:";",page:1},{row:2,value:":",page:1},{row:2,value:"'",page:1},{row:2,value:'"',page:1},{row:2,value:"<",page:1},{row:2,value:">",page:1},{row:3,value:"Page0",page:1},{row:3,value:"/",page:1},{row:3,value:"?",page:1},{row:3,value:"[",page:1},{row:3,value:"]",page:1},{row:3,value:"{",page:1},{row:3,value:"}",page:1},{row:3,value:"|",page:1},{row:3,value:"\\",page:1},{row:3,value:"~",page:1}],fi=[{row:0,value:"q"},{row:0,value:"w"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"a"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:2,value:"z"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"m"},{row:2,value:"Backspace"}],pi=[{row:0,value:"q"},{row:0,value:"w"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"a"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:2,value:"Enter"},{row:2,value:"z"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"m"},{row:2,value:"Backspace"}],mi=[{row:0,value:"a"},{row:0,value:"z"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"q"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:1,value:"m"},{row:2,value:"Shift"},{row:2,value:"w"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"Backspace"},{row:3,value:"Page1"},{row:3,value:","},{row:3,value:"Space"},{row:3,value:"."},{row:3,value:"Enter"},{row:0,value:"1",page:1},{row:0,value:"2",page:1},{row:0,value:"3",page:1},{row:0,value:"4",page:1},{row:0,value:"5",page:1},{row:0,value:"6",page:1},{row:0,value:"7",page:1},{row:0,value:"8",page:1},{row:0,value:"9",page:1},{row:0,value:"0",page:1},{row:1,value:"!",page:1},{row:1,value:"@",page:1},{row:1,value:"#",page:1},{row:1,value:"$",page:1},{row:1,value:"%",page:1},{row:1,value:"^",page:1},{row:1,value:"&",page:1},{row:1,value:"*",page:1},{row:1,value:"(",page:1},{row:1,value:")",page:1},{row:2,value:"-",page:1},{row:2,value:"_",page:1},{row:2,value:"=",page:1},{row:2,value:"+",page:1},{row:2,value:";",page:1},{row:2,value:":",page:1},{row:2,value:"'",page:1},{row:2,value:'"',page:1},{row:2,value:"<",page:1},{row:2,value:">",page:1},{row:3,value:"Page0",page:1},{row:3,value:"/",page:1},{row:3,value:"?",page:1},{row:3,value:"[",page:1},{row:3,value:"]",page:1},{row:3,value:"{",page:1},{row:3,value:"}",page:1},{row:3,value:"|",page:1},{row:3,value:"\\",page:1},{row:3,value:"~",page:1}],vi=[{row:0,value:"a"},{row:0,value:"z"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"q"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:1,value:"m"},{row:2,value:"w"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"Backspace"}],gi=[{row:0,value:"a"},{row:0,value:"z"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"q"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:1,value:"m"},{row:2,value:"Enter"},{row:2,value:"w"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"Backspace"}],_i='<svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-delete"><path d="M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"></path><line x1="18" y1="9" x2="12" y2="15"></line><line x1="12" y1="9" x2="18" y2="15"></line></svg>',wi='<svg width="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-corner-down-left"><polyline points="9 10 4 15 9 20"></polyline><path d="M20 4v7a4 4 0 0 1-4 4H4"></path></svg>';function gn(n,e,t){const r=n.slice();return r[27]=e[t],r[29]=t,r}function _n(n,e,t){const r=n.slice();return r[30]=e[t],r}function wn(n,e,t){const r=n.slice();return r[33]=e[t].value,r[34]=e[t].display,r}function yi(n){let e=n[34]+"",t;return{c(){t=O(e)},l(r){t=j(r,e)},m(r,s){P(r,t,s)},p(r,s){s[0]&8&&e!==(e=r[34]+"")&&oe(t,e)},d(r){r&&d(t)}}}function bi(n){let e,t=n[34]+"",r;return{c(){e=new Wn(!1),r=ae(),this.h()},l(s){e=Jn(s,!1),r=ae(),this.h()},h(){e.a=r},m(s,i){e.m(t,s,i),P(s,r,i)},p(s,i){i[0]&8&&t!==(t=s[34]+"")&&e.p(t)},d(s){s&&d(r),s&&e.d()}}}function yn(n){let e,t,r,s,i;function o(g,v){return v[0]&8&&(t=null),t==null&&(t=!!g[34].includes("<svg")),t?bi:yi}let a=o(n,[-1,-1]),l=a(n);function u(...g){return n[19](n[33],...g)}function h(...g){return n[20](n[33],...g)}function c(){return n[21](n[33])}function f(){return n[22](n[33])}return{c(){e=y("button"),l.c(),this.h()},l(g){e=b(g,"BUTTON",{class:!0});var v=T(e);l.l(v),v.forEach(d),this.h()},h(){S(e,"class",r="key key--"+n[33]+" "+(n[0][n[33]]||"")+" svelte-zdf3cm"),me(e,"single",n[33].length===1),me(e,"active",n[33]===n[2])},m(g,v){P(g,e,v),l.m(e,null),s||(i=[ce(e,"touchstart",u),ce(e,"mousedown",h),ce(e,"touchend",c,{passive:!0}),ce(e,"mouseup",f)],s=!0)},p(g,v){n=g,a===(a=o(n,v))&&l?l.p(n,v):(l.d(1),l=a(n),l&&(l.c(),l.m(e,null))),v[0]&9&&r!==(r="key key--"+n[33]+" "+(n[0][n[33]]||"")+" svelte-zdf3cm")&&S(e,"class",r),v[0]&9&&me(e,"single",n[33].length===1),v[0]&13&&me(e,"active",n[33]===n[2])},d(g){g&&d(e),l.d(),s=!1,wt(i)}}}function bn(n){let e,t=n[30],r=[];for(let s=0;s<t.length;s+=1)r[s]=yn(wn(n,t,s));return{c(){e=y("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=b(s,"DIV",{class:!0});var i=T(e);for(let o=0;o<r.length;o+=1)r[o].l(i);i.forEach(d),this.h()},h(){S(e,"class","row row--"+n[29]+" svelte-zdf3cm")},m(s,i){P(s,e,i);for(let o=0;o<r.length;o+=1)r[o].m(e,null)},p(s,i){if(i[0]&61){t=s[30];let o;for(o=0;o<t.length;o+=1){const a=wn(s,t,o);r[o]?r[o].p(a,i):(r[o]=yn(a),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=t.length}},d(s){s&&d(e),nt(r,s)}}}function kn(n){let e,t,r=n[27],s=[];for(let i=0;i<r.length;i+=1)s[i]=bn(_n(n,r,i));return{c(){e=y("div");for(let i=0;i<s.length;i+=1)s[i].c();t=C(),this.h()},l(i){e=b(i,"DIV",{class:!0});var o=T(e);for(let a=0;a<s.length;a+=1)s[a].l(o);t=N(o),o.forEach(d),this.h()},h(){S(e,"class","page svelte-zdf3cm"),me(e,"visible",n[29]===n[1])},m(i,o){P(i,e,o);for(let a=0;a<s.length;a+=1)s[a].m(e,null);m(e,t)},p(i,o){if(o[0]&61){r=i[27];let a;for(a=0;a<r.length;a+=1){const l=_n(i,r,a);s[a]?s[a].p(l,o):(s[a]=bn(l),s[a].c(),s[a].m(e,t))}for(;a<s.length;a+=1)s[a].d(1);s.length=r.length}o[0]&2&&me(e,"visible",i[29]===i[1])},d(i){i&&d(e),nt(s,i)}}}function ki(n){let e,t=n[3],r=[];for(let s=0;s<t.length;s+=1)r[s]=kn(gn(n,t,s));return{c(){e=y("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=b(s,"DIV",{class:!0});var i=T(e);for(let o=0;o<r.length;o+=1)r[o].l(i);i.forEach(d),this.h()},h(){S(e,"class","svelte-keyboard")},m(s,i){P(s,e,i);for(let o=0;o<r.length;o+=1)r[o].m(e,null)},p(s,i){if(i[0]&63){t=s[3];let o;for(o=0;o<t.length;o+=1){const a=gn(s,t,o);r[o]?r[o].p(a,i):(r[o]=kn(a),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=t.length}},i:q,o:q,d(s){s&&d(e),nt(r,s)}}}const Ei="abcdefghijklmnopqrstuvwxyz";function Ti(n,e,t){let r,s,i,o,a,l,u,h,c,{custom:f}=e,{localizationLayout:g="qwerty"}=e,{layout:v="standard"}=e,{noSwap:_=[]}=e,{keyClass:E={}}=e,k=0,$=!1,U;const W={qwerty:{standard:di,crossword:fi,wordle:pi},azerty:{standard:mi,crossword:vi,wordle:gi}},M=Er(),R={Page0:"abc",Page1:"?123",Space:" ",Shift:"abc",Enter:wi,Backspace:_i},z=p=>[...new Set(p)],D=(p,w)=>{if(p.preventDefault(),t(2,U=w),w.includes("Page"))t(1,k=+w.substr(-1));else if(w==="Shift")t(10,$=!$);else{let A=w;$&&Ei.includes(w)&&(A=w.toUpperCase()),M("keydown",A)}return p.stopPropagation(),!1},J=p=>{setTimeout(()=>{p===U&&t(2,U=void 0)},50)},Y=(p,w)=>D(w,p),I=(p,w)=>D(w,p),H=p=>J(p),B=p=>J(p);return n.$$set=p=>{"custom"in p&&t(6,f=p.custom),"localizationLayout"in p&&t(7,g=p.localizationLayout),"layout"in p&&t(8,v=p.layout),"noSwap"in p&&t(9,_=p.noSwap),"keyClass"in p&&t(0,E=p.keyClass)},n.$$.update=()=>{n.$$.dirty[0]&448&&t(18,r=f||W[g][v]||standard),n.$$.dirty[0]&263680&&t(17,s=r.map(p=>{let w=p.display;const A=R[p.value];return A&&!_.includes(p.value)&&!p.noSwap&&(w=A),w||(w=$?p.value.toUpperCase():p.value),p.value==="Shift"&&(w=$?A:A.toUpperCase()),dt(xe({},p),{display:w})})),n.$$.dirty[0]&131072&&t(15,i=s.filter(p=>!p.page)),n.$$.dirty[0]&131072&&t(13,o=s.filter(p=>p.page)),n.$$.dirty[0]&32768&&t(14,a=z(i.map(p=>p.row))),n.$$.dirty[0]&16384&&a.sort((p,w)=>p-w),n.$$.dirty[0]&8192&&t(16,l=z(o.map(p=>p.row))),n.$$.dirty[0]&65536&&l.sort((p,w)=>p-w),n.$$.dirty[0]&49152&&t(12,u=a.map(p=>i.filter(w=>w.row===p))),n.$$.dirty[0]&24576&&t(11,h=a.map(p=>o.filter(w=>w.row===p))),n.$$.dirty[0]&6144&&t(3,c=[u,h])},[E,k,U,c,D,J,f,g,v,_,$,h,u,o,a,i,l,s,r,Y,I,H,B]}class Si extends Z{constructor(e){super(),ee(this,e,Ti,ki,te,{custom:6,localizationLayout:7,layout:8,noSwap:9,keyClass:0},null,[-1,-1])}}function Oi(n){let e,t,r,s,i,o,a,l,u,h,c,f,g,v,_;return i=new Si({props:{layout:"wordle"}}),i.$on("keydown",n[2]),{c(){e=y("div"),t=y("p"),r=O(n[1]),s=C(),re(i.$$.fragment),o=C(),a=y("div"),l=y("form"),u=y("input"),h=C(),c=y("button"),f=O("Submit"),this.h()},l(E){e=b(E,"DIV",{class:!0});var k=T(e);t=b(k,"P",{});var $=T(t);r=j($,n[1]),$.forEach(d),s=N(k),ne(i.$$.fragment,k),k.forEach(d),o=N(E),a=b(E,"DIV",{class:!0});var U=T(a);l=b(U,"FORM",{});var W=T(l);u=b(W,"INPUT",{maxlength:!0,class:!0}),h=N(W),c=b(W,"BUTTON",{type:!0,class:!0});var M=T(c);f=j(M,"Submit"),M.forEach(d),W.forEach(d),U.forEach(d),this.h()},h(){S(e,"class","keyboard svelte-1jya41k"),S(u,"maxlength","15"),S(u,"class","svelte-1jya41k"),S(c,"type","submit"),S(c,"class","svelte-1jya41k"),S(a,"class","no-keyboard svelte-1jya41k")},m(E,k){P(E,e,k),m(e,t),m(t,r),m(e,s),se(i,e,null),P(E,o,k),P(E,a,k),m(a,l),m(l,u),$t(u,n[1]),n[5](u),m(l,h),m(l,c),m(c,f),g=!0,v||(_=[ce(u,"input",n[4]),ce(l,"submit",n[3])],v=!0)},p(E,[k]){(!g||k&2)&&oe(r,E[1]),k&2&&u.value!==E[1]&&$t(u,E[1])},i(E){g||(x(i.$$.fragment,E),g=!0)},o(E){F(i.$$.fragment,E),g=!1},d(E){E&&d(e),ie(i),E&&d(o),E&&d(a),n[5](null),v=!1,wt(_)}}}function ji(n,e,t){const r=Er();let s,i="";const o=()=>{i&&r("submit",i),t(1,i="")},a=c=>{c.detail==="Enter"?o():c.detail==="Backspace"?t(1,i=i.substring(0,i.length-1)):t(1,i=`${i}${c.detail}`)},l=c=>{c.preventDefault(),t(1,i=i.trim().toLowerCase()),o()};yt(()=>{s.focus()});function u(){i=this.value,t(1,i)}function h(c){Vn[c?"unshift":"push"](()=>{s=c,t(0,s)})}return[s,i,a,l,u,h]}class Pi extends Z{constructor(e){super(),ee(this,e,ji,Oi,te,{})}}function $i(n){let e,t;return{c(){e=y("p"),t=O(n[0]),this.h()},l(r){e=b(r,"P",{class:!0});var s=T(e);t=j(s,n[0]),s.forEach(d),this.h()},h(){S(e,"class","svelte-jyzswz")},m(r,s){P(r,e,s),m(e,t)},p(r,[s]){s&1&&oe(t,r[0])},i:q,o:q,d(r){r&&d(e)}}}const En=1e3;function Ri(n,e,t){let r,s,i;L(n,tt,l=>t(1,s=l)),L(n,rt,l=>t(2,i=l));const o=15*En,a=l=>{l?vt.start():(vt.stop(),vt.reset())};return n.$$.update=()=>{n.$$.dirty&4&&t(0,r=Math.floor((o-i)/En)),n.$$.dirty&1&&r<=0&&ve(tt,s=!1,s),n.$$.dirty&2&&a(s)},[r,s,i]}class Ai extends Z{constructor(e){super(),ee(this,e,Ri,$i,te,{})}}function Ii(n){let e,t,r,s,i;return{c(){e=y("div"),t=y("p"),r=O("Type as many words as you can that..."),s=C(),i=y("p"),this.h()},l(o){e=b(o,"DIV",{class:!0});var a=T(e);t=b(a,"P",{class:!0});var l=T(t);r=j(l,"Type as many words as you can that..."),l.forEach(d),s=N(a),i=b(a,"P",{class:!0});var u=T(i);u.forEach(d),a.forEach(d),this.h()},h(){S(t,"class","instructions svelte-12uh45b"),S(i,"class","clue svelte-12uh45b"),S(e,"class","svelte-12uh45b")},m(o,a){P(o,e,a),m(e,t),m(t,r),m(e,s),m(e,i),i.innerHTML=n[0]},p(o,[a]){a&1&&(i.innerHTML=o[0])},i:q,o:q,d(o){o&&d(e)}}}function Ci(n,e,t){let{clue:r}=e;return n.$$set=s=>{"clue"in s&&t(0,r=s.clue)},[r]}class Ni extends Z{constructor(e){super(),ee(this,e,Ci,Ii,te,{clue:0})}}function Tn(n){let e,t,r,s,i,o=n[0].wod+"",a;return{c(){e=y("p"),t=y("span"),r=O("Michelle"),s=C(),i=y("span"),a=O(o),this.h()},l(l){e=b(l,"P",{class:!0});var u=T(e);t=b(u,"SPAN",{class:!0});var h=T(t);r=j(h,"Michelle"),h.forEach(d),s=N(u),i=b(u,"SPAN",{class:!0});var c=T(i);a=j(c,o),c.forEach(d),u.forEach(d),this.h()},h(){S(t,"class","name svelte-1xmjoob"),S(i,"class","score svelte-1xmjoob"),S(e,"class","svelte-1xmjoob")},m(l,u){P(l,e,u),m(e,t),m(t,r),m(e,s),m(e,i),m(i,a)},p(l,u){u&1&&o!==(o=l[0].wod+"")&&oe(a,o)},d(l){l&&d(e)}}}function xi(n){let e,t,r,s,i,o,a=n[0].user+"",l,u,h=!n[1]&&Tn(n);return{c(){e=y("div"),t=y("p"),r=y("span"),s=O("You"),i=C(),o=y("span"),l=O(a),u=C(),h&&h.c(),this.h()},l(c){e=b(c,"DIV",{class:!0});var f=T(e);t=b(f,"P",{class:!0});var g=T(t);r=b(g,"SPAN",{class:!0});var v=T(r);s=j(v,"You"),v.forEach(d),i=N(g),o=b(g,"SPAN",{class:!0});var _=T(o);l=j(_,a),_.forEach(d),g.forEach(d),u=N(f),h&&h.l(f),f.forEach(d),this.h()},h(){S(r,"class","name svelte-1xmjoob"),S(o,"class","score svelte-1xmjoob"),S(t,"class","svelte-1xmjoob"),S(e,"class","svelte-1xmjoob")},m(c,f){P(c,e,f),m(e,t),m(t,r),m(r,s),m(t,i),m(t,o),m(o,l),m(e,u),h&&h.m(e,null)},p(c,[f]){f&1&&a!==(a=c[0].user+"")&&oe(l,a),c[1]?h&&(h.d(1),h=null):h?h.p(c,f):(h=Tn(c),h.c(),h.m(e,null))},i:q,o:q,d(c){c&&d(e),h&&h.d()}}}function Ui(n,e,t){let r,s;return L(n,Or,i=>t(0,r=i)),L(n,ze,i=>t(1,s=i)),[r,s]}class Di extends Z{constructor(e){super(),ee(this,e,Ui,xi,te,{})}}function Sn(n){let e,t,r=n[0].text+"",s,i,o=n[2][n[0].reason]+"",a;return{c(){e=y("p"),t=y("strong"),s=O(r),i=C(),a=O(o),this.h()},l(l){e=b(l,"P",{class:!0});var u=T(e);t=b(u,"STRONG",{});var h=T(t);s=j(h,r),h.forEach(d),i=N(u),a=j(u,o),u.forEach(d),this.h()},h(){S(e,"class","svelte-2dcxu0")},m(l,u){P(l,e,u),m(e,t),m(t,s),m(e,i),m(e,a)},p(l,u){u&1&&r!==(r=l[0].text+"")&&oe(s,r),u&1&&o!==(o=l[2][l[0].reason]+"")&&oe(a,o)},d(l){l&&d(e)}}}function Mi(n){let e,t=n[1]&&Sn(n);return{c(){e=y("div"),t&&t.c(),this.h()},l(r){e=b(r,"DIV",{class:!0});var s=T(e);t&&t.l(s),s.forEach(d),this.h()},h(){S(e,"class","svelte-2dcxu0")},m(r,s){P(r,e,s),t&&t.m(e,null)},p(r,[s]){r[1]?t?t.p(r,s):(t=Sn(r),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},i:q,o:q,d(r){r&&d(e),t&&t.d()}}}const Bi=2500;function Li(n,e,t){let r,s,i;L(n,Ee,c=>t(4,s=c)),L(n,Te,c=>t(5,i=c));let o,a=!1,l=0;const u=["(or a variation) was played by opponent","is too short","contains non-letters","is not in the word list","was already entered"],h=()=>{t(3,l=i.user[s].length),clearTimeout(o),r.valid?t(1,a=!1):(t(1,a=!0),o=setTimeout(()=>t(1,a=!1),Bi))};return n.$$.update=()=>{n.$$.dirty&48&&t(0,r=i.user[s][i.user[s].length-1]),n.$$.dirty&48&&(i.user[s].length||t(3,l=0)),n.$$.dirty&57&&r&&i.user[s].length!==l&&h()},[r,a,u,l,s,i]}class zi extends Z{constructor(e){super(),ee(this,e,Li,Mi,te,{})}}function Fi(n){let e,t,r,s,i,o,a,l,u,h,c,f,g,v;return t=new Ni({props:{clue:n[0]}}),s=new Ai({}),a=new hi({}),u=new Di({}),c=new zi({}),g=new Pi({}),g.$on("submit",n[1]),{c(){e=y("div"),re(t.$$.fragment),r=C(),re(s.$$.fragment),i=C(),o=y("div"),re(a.$$.fragment),l=C(),re(u.$$.fragment),h=C(),re(c.$$.fragment),f=C(),re(g.$$.fragment),this.h()},l(_){e=b(_,"DIV",{class:!0});var E=T(e);ne(t.$$.fragment,E),r=N(E),ne(s.$$.fragment,E),i=N(E),o=b(E,"DIV",{class:!0});var k=T(o);ne(a.$$.fragment,k),l=N(k),ne(u.$$.fragment,k),h=N(k),ne(c.$$.fragment,k),f=N(k),ne(g.$$.fragment,k),k.forEach(d),E.forEach(d),this.h()},h(){S(o,"class","board svelte-1uowmjb"),S(e,"class","play svelte-1uowmjb")},m(_,E){P(_,e,E),se(t,e,null),m(e,r),se(s,e,null),m(e,i),m(e,o),se(a,o,null),m(o,l),se(u,o,null),m(o,h),se(c,o,null),m(o,f),se(g,o,null),v=!0},p(_,[E]){const k={};E&1&&(k.clue=_[0]),t.$set(k)},i(_){v||(x(t.$$.fragment,_),x(s.$$.fragment,_),x(a.$$.fragment,_),x(u.$$.fragment,_),x(c.$$.fragment,_),x(g.$$.fragment,_),v=!0)},o(_){F(t.$$.fragment,_),F(s.$$.fragment,_),F(a.$$.fragment,_),F(u.$$.fragment,_),F(c.$$.fragment,_),F(g.$$.fragment,_),v=!1},d(_){_&&d(e),ie(t),ie(s),ie(a),ie(u),ie(c),ie(g)}}}function Gi(n,e,t){let r,s,i,o,a,l,u,h;L(n,Ee,R=>t(5,o=R)),L(n,Te,R=>t(7,a=R)),L(n,rt,R=>t(8,l=R)),L(n,jr,R=>t(9,u=R)),L(n,mr,R=>t(10,h=R));let{clues:c}=e,{answers:f}=e;const g=R=>{const z=s.find(D=>D.word===R);return z?z.lemmas:""},v=R=>!i.includes(R),_=({text:R,lemmas:z})=>Pt({lemmas:z,corpus:u}),E=({text:R,lemmas:z})=>{const D=a.user[o].map(J=>J.lemmas);return Pt({lemmas:z,corpus:D})},k=R=>new RegExp(/([^a-z])/,"g").test(R),$=({text:R,lemmas:z})=>{let D=!0,J;return R.length<4?(D=!1,J=1):k(R)?(D=!1,J=2):v(R)?(D=!1,J=3):E({text:R,lemmas:z})?(D=!1,J=4):_({text:R,lemmas:z})&&(D=!1,J=0),{valid:D,reason:J}},U=({text:R,timestamp:z})=>{const{points:D}=s.find(J=>J.word===R);return+D},W=R=>{a.wod[o].forEach(z=>{const D=z.lemmas.split("|");Pt({lemmas:R,corpus:D})&&(z.revealWod=!0)})},M=async({detail:R})=>{const z=R,D=g(z),{valid:J,reason:Y}=$({text:z,lemmas:D}),I=l,H=J?U({text:z,timestamp:I}):void 0,B={text:z,lemmas:D,points:H,timestamp:I,round:o,valid:J,reason:Y};ve(Te,a.user[o]=[...a.user[o],B],a),W(D)};return n.$$set=R=>{"clues"in R&&t(2,c=R.clues),"answers"in R&&t(3,f=R.answers)},n.$$.update=()=>{n.$$.dirty&36&&t(0,r=c[o]),n.$$.dirty&40&&t(4,s=f[o]),n.$$.dirty&16&&ve(mr,h=s,h),n.$$.dirty&16&&(i=s.map(R=>R.word))},[r,M,c,f,s,o]}class Hi extends Z{constructor(e){super(),ee(this,e,Gi,Fi,te,{clues:2,answers:3})}}function qi(n){let e,t;return{c(){e=y("p"),t=O(n[0]),this.h()},l(r){e=b(r,"P",{class:!0});var s=T(e);t=j(s,n[0]),s.forEach(d),this.h()},h(){S(e,"class","svelte-1sj1s4l")},m(r,s){P(r,e,s),m(e,t)},p(r,[s]){s&1&&oe(t,r[0])},i:q,o:q,d(r){r&&d(e)}}}const On=3;function Wi(n,e,t){let r,s;const i=Er(),o=-1,a=On*1e3,l=Zn(On,{duration:a});return L(n,l,u=>t(2,s=u)),l.set(o).then(()=>{i("end")}),n.$$.update=()=>{n.$$.dirty&4&&t(0,r=s<0?"Begin!":Math.floor(s)+1)},[r,l,s]}class Ji extends Z{constructor(e){super(),ee(this,e,Wi,qi,te,{})}}function jn(n){let e,t,r=n[2].wod+"",s;return{c(){e=y("p"),t=O("Michelle: "),s=O(r)},l(i){e=b(i,"P",{});var o=T(e);t=j(o,"Michelle: "),s=j(o,r),o.forEach(d)},m(i,o){P(i,e,o),m(e,t),m(e,s)},p(i,o){o&4&&r!==(r=i[2].wod+"")&&oe(s,r)},d(i){i&&d(e)}}}function Vi(n){let e,t,r=n[0]+1+"",s,i,o,a,l,u=n[1]?"Your score":"You",h,c,f=n[2].user+"",g,v,_,E=!n[1]&&jn(n);return{c(){e=y("p"),t=O("Round "),s=O(r),i=O(" of "),o=O(At),a=C(),l=y("p"),h=O(u),c=O(": "),g=O(f),v=C(),E&&E.c(),_=ae()},l(k){e=b(k,"P",{});var $=T(e);t=j($,"Round "),s=j($,r),i=j($," of "),o=j($,At),$.forEach(d),a=N(k),l=b(k,"P",{});var U=T(l);h=j(U,u),c=j(U,": "),g=j(U,f),U.forEach(d),v=N(k),E&&E.l(k),_=ae()},m(k,$){P(k,e,$),m(e,t),m(e,s),m(e,i),m(e,o),P(k,a,$),P(k,l,$),m(l,h),m(l,c),m(l,g),P(k,v,$),E&&E.m(k,$),P(k,_,$)},p(k,[$]){$&1&&r!==(r=k[0]+1+"")&&oe(s,r),$&2&&u!==(u=k[1]?"Your score":"You")&&oe(h,u),$&4&&f!==(f=k[2].user+"")&&oe(g,f),k[1]?E&&(E.d(1),E=null):E?E.p(k,$):(E=jn(k),E.c(),E.m(_.parentNode,_))},i:q,o:q,d(k){k&&d(e),k&&d(a),k&&d(l),k&&d(v),E&&E.d(k),k&&d(_)}}}function Yi(n,e,t){let r,s,i;return L(n,Ee,o=>t(0,r=o)),L(n,ze,o=>t(1,s=o)),L(n,Or,o=>t(2,i=o)),[r,s,i]}class Ki extends Z{constructor(e){super(),ee(this,e,Yi,Vi,te,{})}}function Pn(n,e,t){const r=n.slice();return r[10]=e[t].text,r[11]=e[t].points,r}function $n(n){let e,t,r,s,i,o,a,l,u,h,c,f,g=n[2].slice(0,7),v=[];for(let _=0;_<g.length;_+=1)v[_]=Rn(Pn(n,g,_));return{c(){e=y("p"),t=O("Here are some words that Michelle got that you didn't:"),r=C(),s=y("table"),i=y("thead"),o=y("th"),a=O("Word"),l=C(),u=y("th"),h=O("Points"),c=C(),f=y("tbody");for(let _=0;_<v.length;_+=1)v[_].c();this.h()},l(_){e=b(_,"P",{});var E=T(e);t=j(E,"Here are some words that Michelle got that you didn't:"),E.forEach(d),r=N(_),s=b(_,"TABLE",{class:!0});var k=T(s);i=b(k,"THEAD",{});var $=T(i);o=b($,"TH",{});var U=T(o);a=j(U,"Word"),U.forEach(d),l=N($),u=b($,"TH",{});var W=T(u);h=j(W,"Points"),W.forEach(d),$.forEach(d),c=N(k),f=b(k,"TBODY",{});var M=T(f);for(let R=0;R<v.length;R+=1)v[R].l(M);M.forEach(d),k.forEach(d),this.h()},h(){S(s,"class","svelte-1nqgcdy")},m(_,E){P(_,e,E),m(e,t),P(_,r,E),P(_,s,E),m(s,i),m(i,o),m(o,a),m(i,l),m(i,u),m(u,h),m(s,c),m(s,f);for(let k=0;k<v.length;k+=1)v[k].m(f,null)},p(_,E){if(E&4){g=_[2].slice(0,7);let k;for(k=0;k<g.length;k+=1){const $=Pn(_,g,k);v[k]?v[k].p($,E):(v[k]=Rn($),v[k].c(),v[k].m(f,null))}for(;k<v.length;k+=1)v[k].d(1);v.length=g.length}},d(_){_&&d(e),_&&d(r),_&&d(s),nt(v,_)}}}function Rn(n){let e,t,r=n[10]+"",s,i,o,a=n[11]+"",l;return{c(){e=y("tr"),t=y("td"),s=O(r),i=C(),o=y("td"),l=O(a)},l(u){e=b(u,"TR",{});var h=T(e);t=b(h,"TD",{});var c=T(t);s=j(c,r),c.forEach(d),i=N(h),o=b(h,"TD",{});var f=T(o);l=j(f,a),f.forEach(d),h.forEach(d)},m(u,h){P(u,e,h),m(e,t),m(t,s),m(e,i),m(e,o),m(o,l)},p(u,h){h&4&&r!==(r=u[10]+"")&&oe(s,r),h&4&&a!==(a=u[11]+"")&&oe(l,a)},d(u){u&&d(e)}}}function Xi(n){let e,t,r,s,i,o,a,l,u,h,c,f,g,v=n[2].length&&$n(n);return{c(){e=y("p"),t=O("There were "),r=y("strong"),s=O(n[3]),i=O(" possible words that satisfied the clue."),o=C(),v&&v.c(),a=C(),l=y("p"),u=O("Here are some common words that "),h=O(n[0]),c=O(": "),f=new Wn(!1),g=O("."),this.h()},l(_){e=b(_,"P",{});var E=T(e);t=j(E,"There were "),r=b(E,"STRONG",{});var k=T(r);s=j(k,n[3]),k.forEach(d),i=j(E," possible words that satisfied the clue."),E.forEach(d),o=N(_),v&&v.l(_),a=N(_),l=b(_,"P",{});var $=T(l);u=j($,"Here are some common words that "),h=j($,n[0]),c=j($,": "),f=Jn($,!1),g=j($,"."),$.forEach(d),this.h()},h(){f.a=g},m(_,E){P(_,e,E),m(e,t),m(e,r),m(r,s),m(e,i),P(_,o,E),v&&v.m(_,E),P(_,a,E),P(_,l,E),m(l,u),m(l,h),m(l,c),f.m(n[1],l),m(l,g)},p(_,[E]){E&8&&oe(s,_[3]),_[2].length?v?v.p(_,E):(v=$n(_),v.c(),v.m(a.parentNode,a)):v&&(v.d(1),v=null),E&1&&oe(h,_[0]),E&2&&f.p(_[1])},i:q,o:q,d(_){_&&d(e),_&&d(o),v&&v.d(_),_&&d(a),_&&d(l)}}}function Qi(n,e,t){let r,s,i,o,a,l,u,h,c,f;return L(n,ze,g=>t(5,l=g)),L(n,jr,g=>t(6,u=g)),L(n,mr,g=>t(7,h=g)),L(n,Ee,g=>t(8,c=g)),L(n,Te,g=>t(9,f=g)),n.$$.update=()=>{n.$$.dirty&128&&t(3,r=Xn(",")(h.length)),n.$$.dirty&768&&t(2,s=f.wod[c].filter(g=>g.valid&&!g.guessedByUserLate)),n.$$.dirty&192&&t(4,i=h.filter(g=>+g.points==1).filter(g=>!u.includes(v=>v.text))),n.$$.dirty&16&&t(1,o=As(i).slice(0,5).map(g=>`<span>${g.word}</span>`).join(", ")),n.$$.dirty&32&&t(0,a=l?"you didn't get":"neither of you got")},[a,o,s,r,i,l,u,h,c,f]}class Zi extends Z{constructor(e){super(),ee(this,e,Qi,Xi,te,{})}}function An(n){let e,t;return{c(){e=y("h2"),t=O(n[1]),this.h()},l(r){e=b(r,"H2",{class:!0});var s=T(e);t=j(s,n[1]),s.forEach(d),this.h()},h(){S(e,"class","svelte-4gydqf")},m(r,s){P(r,e,s),m(e,t)},p(r,s){s&2&&oe(t,r[1])},d(r){r&&d(e)}}}function In(n){let e;function t(i,o){return i[2]?ro:i[3]?to:eo}let r=t(n),s=r(n);return{c(){s.c(),e=ae()},l(i){s.l(i),e=ae()},m(i,o){s.m(i,o),P(i,e,o)},p(i,o){r!==(r=t(i))&&(s.d(1),s=r(i),s&&(s.c(),s.m(e.parentNode,e)))},d(i){s.d(i),i&&d(e)}}}function eo(n){let e,t;return{c(){e=y("p"),t=O("Tie!")},l(r){e=b(r,"P",{});var s=T(e);t=j(s,"Tie!"),s.forEach(d)},m(r,s){P(r,e,s),m(e,t)},d(r){r&&d(e)}}}function to(n){let e,t;return{c(){e=y("p"),t=O("You lose!")},l(r){e=b(r,"P",{});var s=T(e);t=j(s,"You lose!"),s.forEach(d)},m(r,s){P(r,e,s),m(e,t)},d(r){r&&d(e)}}}function ro(n){let e,t;return{c(){e=y("p"),t=O("You win!")},l(r){e=b(r,"P",{});var s=T(e);t=j(s,"You win!"),s.forEach(d)},m(r,s){P(r,e,s),m(e,t)},d(r){r&&d(e)}}}function no(n){let e,t,r,s,i,o,a,l=!n[4]&&An(n);r=new Ki({}),i=new Zi({});let u=n[0]==="post"&&!n[4]&&In(n);return{c(){e=y("div"),l&&l.c(),t=C(),re(r.$$.fragment),s=C(),re(i.$$.fragment),o=C(),u&&u.c(),this.h()},l(h){e=b(h,"DIV",{class:!0});var c=T(e);l&&l.l(c),t=N(c),ne(r.$$.fragment,c),s=N(c),ne(i.$$.fragment,c),o=N(c),u&&u.l(c),c.forEach(d),this.h()},h(){S(e,"class","svelte-4gydqf")},m(h,c){P(h,e,c),l&&l.m(e,null),m(e,t),se(r,e,null),m(e,s),se(i,e,null),m(e,o),u&&u.m(e,null),a=!0},p(h,[c]){h[4]?l&&(l.d(1),l=null):l?l.p(h,c):(l=An(h),l.c(),l.m(e,t)),h[0]==="post"&&!h[4]?u?u.p(h,c):(u=In(h),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(h){a||(x(r.$$.fragment,h),x(i.$$.fragment,h),a=!0)},o(h){F(r.$$.fragment,h),F(i.$$.fragment,h),a=!1},d(h){h&&d(e),l&&l.d(),ie(r),ie(i),u&&u.d()}}}function so(n,e,t){let r,s,i,o,a,l,u,h;L(n,Sr,v=>t(0,a=v)),L(n,Ee,v=>t(7,l=v)),L(n,Or,v=>t(5,u=v)),L(n,ze,v=>t(4,h=v));const c={ahead:["Live look at her: \u{1F92A}.","She says this is almost as good as a day with boba.","She's really channeling her inner Jessie O'Connor.","Nice try. Follow me on Twitter @mich_mcghee."],behind:["Live look at Michelle: \u{1F62D}.","Michelle says this is almost as bad as a day without boba.","Michelle will try to channel her inner Jessie O'Connor this next round.","Ugh. Rematch?"]},f=()=>{const v=i?"Tie!":r?"You win!":"You lose!",_=r||i?c.behind[l]:c.ahead[l];return`${v} A message from Michelle: ${_}`},g=()=>{const v=i?"It's all tied up.":r?"You're in the lead!":"Michelle's in the lead.",_=r||i?c.behind[l]:c.ahead[l];return`${v} ${_}`};return n.$$.update=()=>{n.$$.dirty&32&&t(2,r=u.user>u.wod),n.$$.dirty&32&&t(3,s=u.user<u.wod),n.$$.dirty&32&&(i=u.user===u.wod),n.$$.dirty&1&&t(1,o=a==="post"?f():g())},[a,o,r,s,h,u]}class io extends Z{constructor(e){super(),ee(this,e,so,no,te,{})}}async function oo(n){const e=`https://pudding.cool/projects/word-game-data/wod-info/${n}.csv?version=${Date.now()}`;return await Ut(e)}function ao(n){let e,t,r,s,i,o,a,l,u,h,c,f,g,v,_,E,k,$,U,W,M,R,z,D,J,Y,I,H,B,p;return{c(){e=y("h2"),t=O("Welcome to "),r=y("strong"),s=O("Not Wordle!"),i=C(),o=y("p"),a=O("One person a day gets the chance to play against the world in a game of words."),l=C(),u=y("p"),h=O("Today that person is "),c=y("strong"),f=O(n[1]),g=O(" from "),v=O(n[2]),_=O(". Can you beat them?"),E=C(),k=y("p"),$=O("Do you want to be the "),U=y("strong"),W=O("Word Opponent of the Day?"),M=O(" Sign up here to be in the running."),R=C(),z=y("button"),D=O("BIG SIGNUP BUTTON"),J=C(),Y=y("p"),I=y("button"),H=O("How to Play"),this.h()},l(w){e=b(w,"H2",{class:!0});var A=T(e);t=j(A,"Welcome to "),r=b(A,"STRONG",{});var K=T(r);s=j(K,"Not Wordle!"),K.forEach(d),A.forEach(d),i=N(w),o=b(w,"P",{});var V=T(o);a=j(V,"One person a day gets the chance to play against the world in a game of words."),V.forEach(d),l=N(w),u=b(w,"P",{class:!0});var G=T(u);h=j(G,"Today that person is "),c=b(G,"STRONG",{});var ge=T(c);f=j(ge,n[1]),g=j(ge," from "),v=j(ge,n[2]),ge.forEach(d),_=j(G,". Can you beat them?"),G.forEach(d),E=N(w),k=b(w,"P",{});var he=T(k);$=j(he,"Do you want to be the "),U=b(he,"STRONG",{});var Se=T(U);W=j(Se,"Word Opponent of the Day?"),Se.forEach(d),M=j(he," Sign up here to be in the running."),he.forEach(d),R=N(w),z=b(w,"BUTTON",{});var Ge=T(z);D=j(Ge,"BIG SIGNUP BUTTON"),Ge.forEach(d),J=N(w),Y=b(w,"P",{});var He=T(Y);I=b(He,"BUTTON",{});var $e=T(I);H=j($e,"How to Play"),$e.forEach(d),He.forEach(d),this.h()},h(){S(e,"class","svelte-5kylwb"),S(u,"class","custom svelte-5kylwb"),me(u,"visible",n[0])},m(w,A){P(w,e,A),m(e,t),m(e,r),m(r,s),P(w,i,A),P(w,o,A),m(o,a),P(w,l,A),P(w,u,A),m(u,h),m(u,c),m(c,f),m(c,g),m(c,v),m(u,_),P(w,E,A),P(w,k,A),m(k,$),m(k,U),m(U,W),m(k,M),P(w,R,A),P(w,z,A),m(z,D),P(w,J,A),P(w,Y,A),m(Y,I),m(I,H),B||(p=ce(I,"click",n[4]),B=!0)},p(w,[A]){A&2&&oe(f,w[1]),A&4&&oe(v,w[2]),A&1&&me(u,"visible",w[0])},i:q,o:q,d(w){w&&d(e),w&&d(i),w&&d(o),w&&d(l),w&&d(u),w&&d(E),w&&d(k),w&&d(R),w&&d(z),w&&d(J),w&&d(Y),B=!1,p()}}}function lo(n,e,t){let r,s;L(n,It,u=>t(0,r=u)),L(n,ye,u=>t(3,s=u));let i,o;const a=async()=>{const u=await oo(r),h="what is your name?",c="where do you live?";t(1,i=u.find(f=>f.question===h).answer),t(2,o=u.find(f=>f.question===c).answer)},l=()=>{ve(ye,s="rules",s)};return n.$$.update=()=>{n.$$.dirty&1&&r&&a()},[r,i,o,s,l]}class uo extends Z{constructor(e){super(),ee(this,e,lo,ao,te,{})}}const co="1.35.3",ts={"X-Client-Info":`supabase-js/${co}`},ho="supabase.auth.token";function fo(n){return n.replace(/\/$/,"")}const po=()=>typeof window!="undefined",mo="1.22.16",vo="http://localhost:9999",go={"X-Client-Info":`gotrue-js/${mo}`},St=10,De={ERROR_MESSAGE:"Request Failed",MAX_RETRIES:10,RETRY_INTERVAL:2},pt="supabase.auth.token",_o={name:"sb",lifetime:60*60*8,domain:"",path:"/",sameSite:"lax"};var bt=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const wo=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),yo=(n,e)=>{if(!(n!=null&&n.status))return e({message:De.ERROR_MESSAGE});if(typeof n.json!="function")return e(n);n.json().then(t=>e({message:wo(t),status:(n==null?void 0:n.status)||500}))},bo=(n,e,t)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||(r.headers=Object.assign({"Content-Type":"text/plain;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(t)),r};function Dt(n,e,t,r,s){return bt(this,void 0,void 0,function*(){return new Promise((i,o)=>{n(t,bo(e,r,s)).then(a=>{if(!a.ok)throw a;return r!=null&&r.noResolveJson?i:a.json()}).then(a=>i(a)).catch(a=>yo(a,o))})})}function dr(n,e,t){return bt(this,void 0,void 0,function*(){return Dt(n,"GET",e,t)})}function de(n,e,t,r){return bt(this,void 0,void 0,function*(){return Dt(n,"POST",e,r,t)})}function Cn(n,e,t,r){return bt(this,void 0,void 0,function*(){return Dt(n,"PUT",e,r,t)})}function ko(n,e,t,r){return bt(this,void 0,void 0,function*(){return Dt(n,"DELETE",e,r,t)})}function Eo(n,e,t){const r=t||{},s=encodeURIComponent,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;if(typeof s!="function")throw new TypeError("option encode is invalid");if(!i.test(n))throw new TypeError("argument name is invalid");const o=s(e);if(o&&!i.test(o))throw new TypeError("argument val is invalid");let a=n+"="+o;if(r.maxAge!=null){const l=r.maxAge-0;if(isNaN(l)||!isFinite(l))throw new TypeError("option maxAge is invalid");a+="; Max-Age="+Math.floor(l)}if(r.domain){if(!i.test(r.domain))throw new TypeError("option domain is invalid");a+="; Domain="+r.domain}if(r.path){if(!i.test(r.path))throw new TypeError("option path is invalid");a+="; Path="+r.path}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");a+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(a+="; HttpOnly"),r.secure&&(a+="; Secure"),r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a}function To(n){if(!n||!n.headers||!n.headers.host)throw new Error('The "host" request header is not available');const e=n.headers.host.indexOf(":")>-1&&n.headers.host.split(":")[0]||n.headers.host;return!(["localhost","127.0.0.1"].indexOf(e)>-1||e.endsWith(".local"))}function So(n,e){var t,r,s;return Eo(n.name,n.value,{maxAge:n.maxAge,expires:new Date(Date.now()+n.maxAge*1e3),httpOnly:!0,secure:e,path:(t=n.path)!==null&&t!==void 0?t:"/",domain:(r=n.domain)!==null&&r!==void 0?r:"",sameSite:(s=n.sameSite)!==null&&s!==void 0?s:"lax"})}function gr(n,e,t){const r=t.map(i=>So(i,To(n))),s=e.getHeader("Set-Cookie");return s&&(s instanceof Array?Array.prototype.push.apply(r,s):typeof s=="string"&&r.push(s)),r}function Ot(n,e,t){e.setHeader("Set-Cookie",gr(n,e,t))}var Oo=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function jo(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var _r={exports:{}};(function(n,e){var t=typeof self!="undefined"?self:Oo,r=function(){function i(){this.fetch=!1,this.DOMException=t.DOMException}return i.prototype=t,new i}();(function(i){(function(o){var a={searchParams:"URLSearchParams"in i,iterable:"Symbol"in i&&"iterator"in Symbol,blob:"FileReader"in i&&"Blob"in i&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in i,arrayBuffer:"ArrayBuffer"in i};function l(p){return p&&DataView.prototype.isPrototypeOf(p)}if(a.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(p){return p&&u.indexOf(Object.prototype.toString.call(p))>-1};function c(p){if(typeof p!="string"&&(p=String(p)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(p))throw new TypeError("Invalid character in header field name");return p.toLowerCase()}function f(p){return typeof p!="string"&&(p=String(p)),p}function g(p){var w={next:function(){var A=p.shift();return{done:A===void 0,value:A}}};return a.iterable&&(w[Symbol.iterator]=function(){return w}),w}function v(p){this.map={},p instanceof v?p.forEach(function(w,A){this.append(A,w)},this):Array.isArray(p)?p.forEach(function(w){this.append(w[0],w[1])},this):p&&Object.getOwnPropertyNames(p).forEach(function(w){this.append(w,p[w])},this)}v.prototype.append=function(p,w){p=c(p),w=f(w);var A=this.map[p];this.map[p]=A?A+", "+w:w},v.prototype.delete=function(p){delete this.map[c(p)]},v.prototype.get=function(p){return p=c(p),this.has(p)?this.map[p]:null},v.prototype.has=function(p){return this.map.hasOwnProperty(c(p))},v.prototype.set=function(p,w){this.map[c(p)]=f(w)},v.prototype.forEach=function(p,w){for(var A in this.map)this.map.hasOwnProperty(A)&&p.call(w,this.map[A],A,this)},v.prototype.keys=function(){var p=[];return this.forEach(function(w,A){p.push(A)}),g(p)},v.prototype.values=function(){var p=[];return this.forEach(function(w){p.push(w)}),g(p)},v.prototype.entries=function(){var p=[];return this.forEach(function(w,A){p.push([A,w])}),g(p)},a.iterable&&(v.prototype[Symbol.iterator]=v.prototype.entries);function _(p){if(p.bodyUsed)return Promise.reject(new TypeError("Already read"));p.bodyUsed=!0}function E(p){return new Promise(function(w,A){p.onload=function(){w(p.result)},p.onerror=function(){A(p.error)}})}function k(p){var w=new FileReader,A=E(w);return w.readAsArrayBuffer(p),A}function $(p){var w=new FileReader,A=E(w);return w.readAsText(p),A}function U(p){for(var w=new Uint8Array(p),A=new Array(w.length),K=0;K<w.length;K++)A[K]=String.fromCharCode(w[K]);return A.join("")}function W(p){if(p.slice)return p.slice(0);var w=new Uint8Array(p.byteLength);return w.set(new Uint8Array(p)),w.buffer}function M(){return this.bodyUsed=!1,this._initBody=function(p){this._bodyInit=p,p?typeof p=="string"?this._bodyText=p:a.blob&&Blob.prototype.isPrototypeOf(p)?this._bodyBlob=p:a.formData&&FormData.prototype.isPrototypeOf(p)?this._bodyFormData=p:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(p)?this._bodyText=p.toString():a.arrayBuffer&&a.blob&&l(p)?(this._bodyArrayBuffer=W(p.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(p)||h(p))?this._bodyArrayBuffer=W(p):this._bodyText=p=Object.prototype.toString.call(p):this._bodyText="",this.headers.get("content-type")||(typeof p=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(p)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var p=_(this);if(p)return p;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?_(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(k)}),this.text=function(){var p=_(this);if(p)return p;if(this._bodyBlob)return $(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(U(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(J)}),this.json=function(){return this.text().then(JSON.parse)},this}var R=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function z(p){var w=p.toUpperCase();return R.indexOf(w)>-1?w:p}function D(p,w){w=w||{};var A=w.body;if(p instanceof D){if(p.bodyUsed)throw new TypeError("Already read");this.url=p.url,this.credentials=p.credentials,w.headers||(this.headers=new v(p.headers)),this.method=p.method,this.mode=p.mode,this.signal=p.signal,!A&&p._bodyInit!=null&&(A=p._bodyInit,p.bodyUsed=!0)}else this.url=String(p);if(this.credentials=w.credentials||this.credentials||"same-origin",(w.headers||!this.headers)&&(this.headers=new v(w.headers)),this.method=z(w.method||this.method||"GET"),this.mode=w.mode||this.mode||null,this.signal=w.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&A)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(A)}D.prototype.clone=function(){return new D(this,{body:this._bodyInit})};function J(p){var w=new FormData;return p.trim().split("&").forEach(function(A){if(A){var K=A.split("="),V=K.shift().replace(/\+/g," "),G=K.join("=").replace(/\+/g," ");w.append(decodeURIComponent(V),decodeURIComponent(G))}}),w}function Y(p){var w=new v,A=p.replace(/\r?\n[\t ]+/g," ");return A.split(/\r?\n/).forEach(function(K){var V=K.split(":"),G=V.shift().trim();if(G){var ge=V.join(":").trim();w.append(G,ge)}}),w}M.call(D.prototype);function I(p,w){w||(w={}),this.type="default",this.status=w.status===void 0?200:w.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in w?w.statusText:"OK",this.headers=new v(w.headers),this.url=w.url||"",this._initBody(p)}M.call(I.prototype),I.prototype.clone=function(){return new I(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new v(this.headers),url:this.url})},I.error=function(){var p=new I(null,{status:0,statusText:""});return p.type="error",p};var H=[301,302,303,307,308];I.redirect=function(p,w){if(H.indexOf(w)===-1)throw new RangeError("Invalid status code");return new I(null,{status:w,headers:{location:p}})},o.DOMException=i.DOMException;try{new o.DOMException}catch{o.DOMException=function(w,A){this.message=w,this.name=A;var K=Error(w);this.stack=K.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function B(p,w){return new Promise(function(A,K){var V=new D(p,w);if(V.signal&&V.signal.aborted)return K(new o.DOMException("Aborted","AbortError"));var G=new XMLHttpRequest;function ge(){G.abort()}G.onload=function(){var he={status:G.status,statusText:G.statusText,headers:Y(G.getAllResponseHeaders()||"")};he.url="responseURL"in G?G.responseURL:he.headers.get("X-Request-URL");var Se="response"in G?G.response:G.responseText;A(new I(Se,he))},G.onerror=function(){K(new TypeError("Network request failed"))},G.ontimeout=function(){K(new TypeError("Network request failed"))},G.onabort=function(){K(new o.DOMException("Aborted","AbortError"))},G.open(V.method,V.url,!0),V.credentials==="include"?G.withCredentials=!0:V.credentials==="omit"&&(G.withCredentials=!1),"responseType"in G&&a.blob&&(G.responseType="blob"),V.headers.forEach(function(he,Se){G.setRequestHeader(Se,he)}),V.signal&&(V.signal.addEventListener("abort",ge),G.onreadystatechange=function(){G.readyState===4&&V.signal.removeEventListener("abort",ge)}),G.send(typeof V._bodyInit=="undefined"?null:V._bodyInit)})}return B.polyfill=!0,i.fetch||(i.fetch=B,i.Headers=v,i.Request=D,i.Response=I),o.Headers=v,o.Request=D,o.Response=I,o.fetch=B,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,n.exports=e})(_r,_r.exports);var Mt=jo(_r.exports),Pr=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};function Ie(n){return Math.round(Date.now()/1e3)+n}function Po(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Re=()=>typeof window!="undefined";function Ce(n,e){var t;e||(e=((t=window==null?void 0:window.location)===null||t===void 0?void 0:t.href)||""),n=n.replace(/[\[\]]/g,"\\$&");const r=new RegExp("[?&#]"+n+"(=([^&#]*)|&|#|$)"),s=r.exec(e);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}const $o=n=>{let e;return n?e=n:typeof fetch=="undefined"?e=Mt:e=fetch,(...t)=>e(...t)},Ro=(n,e,t)=>Pr(void 0,void 0,void 0,function*(){Re()&&(yield n==null?void 0:n.setItem(e,JSON.stringify(t)))}),Ao=(n,e)=>Pr(void 0,void 0,void 0,function*(){const t=Re()&&(yield n==null?void 0:n.getItem(e));if(!t)return null;try{return JSON.parse(t)}catch{return t}}),Io=(n,e)=>{const t=Re()&&(n==null?void 0:n.getItem(e));if(!t||typeof t!="string")return null;try{return JSON.parse(t)}catch{return t}},Co=(n,e)=>Pr(void 0,void 0,void 0,function*(){Re()&&(yield n==null?void 0:n.removeItem(e))});var le=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class No{constructor({url:e="",headers:t={},cookieOptions:r,fetch:s}){this.url=e,this.headers=t,this.cookieOptions=Object.assign(Object.assign({},_o),r),this.fetch=$o(s)}_createRequestHeaders(e){const t=Object.assign({},this.headers);return t.Authorization=`Bearer ${e}`,t}cookieName(){var e;return(e=this.cookieOptions.name)!==null&&e!==void 0?e:""}getUrlForProvider(e,t){const r=[`provider=${encodeURIComponent(e)}`];if(t!=null&&t.redirectTo&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),t!=null&&t.queryParams){const s=new URLSearchParams(t.queryParams);r.push(`${s}`)}return`${this.url}/authorize?${r.join("&")}`}signUpWithEmail(e,t,r={}){return le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let i="";r.redirectTo&&(i="?redirect_to="+encodeURIComponent(r.redirectTo));const o=yield de(this.fetch,`${this.url}/signup${i}`,{email:e,password:t,data:r.data,gotrue_meta_security:{hcaptcha_token:r.captchaToken}},{headers:s}),a=Object.assign({},o);return a.expires_in&&(a.expires_at=Ie(o.expires_in)),{data:a,error:null}}catch(s){return{data:null,error:s}}})}signInWithEmail(e,t,r={}){return le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let i="?grant_type=password";r.redirectTo&&(i+="&redirect_to="+encodeURIComponent(r.redirectTo));const o=yield de(this.fetch,`${this.url}/token${i}`,{email:e,password:t},{headers:s}),a=Object.assign({},o);return a.expires_in&&(a.expires_at=Ie(o.expires_in)),{data:a,error:null}}catch(s){return{data:null,error:s}}})}signUpWithPhone(e,t,r={}){return le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers),i=yield de(this.fetch,`${this.url}/signup`,{phone:e,password:t,data:r.data,gotrue_meta_security:{hcaptcha_token:r.captchaToken}},{headers:s}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=Ie(i.expires_in)),{data:o,error:null}}catch(s){return{data:null,error:s}}})}signInWithPhone(e,t){return le(this,void 0,void 0,function*(){try{const r=Object.assign({},this.headers),s="?grant_type=password",i=yield de(this.fetch,`${this.url}/token${s}`,{phone:e,password:t},{headers:r}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=Ie(i.expires_in)),{data:o,error:null}}catch(r){return{data:null,error:r}}})}signInWithOpenIDConnect({id_token:e,nonce:t,client_id:r,issuer:s,provider:i}){return le(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),a="?grant_type=id_token",l=yield de(this.fetch,`${this.url}/token${a}`,{id_token:e,nonce:t,client_id:r,issuer:s,provider:i},{headers:o}),u=Object.assign({},l);return u.expires_in&&(u.expires_at=Ie(l.expires_in)),{data:u,error:null}}catch(o){return{data:null,error:o}}})}sendMagicLinkEmail(e,t={}){var r;return le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let i="";t.redirectTo&&(i+="?redirect_to="+encodeURIComponent(t.redirectTo));const o=(r=t.shouldCreateUser)!==null&&r!==void 0?r:!0;return{data:yield de(this.fetch,`${this.url}/otp${i}`,{email:e,create_user:o,gotrue_meta_security:{hcaptcha_token:t.captchaToken}},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}sendMobileOTP(e,t={}){var r;return le(this,void 0,void 0,function*(){try{const s=(r=t.shouldCreateUser)!==null&&r!==void 0?r:!0,i=Object.assign({},this.headers);return{data:yield de(this.fetch,`${this.url}/otp`,{phone:e,create_user:s,gotrue_meta_security:{hcaptcha_token:t.captchaToken}},{headers:i}),error:null}}catch(s){return{data:null,error:s}}})}signOut(e){return le(this,void 0,void 0,function*(){try{return yield de(this.fetch,`${this.url}/logout`,{},{headers:this._createRequestHeaders(e),noResolveJson:!0}),{error:null}}catch(t){return{error:t}}})}verifyMobileOTP(e,t,r={}){return le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers),i=yield de(this.fetch,`${this.url}/verify`,{phone:e,token:t,type:"sms",redirect_to:r.redirectTo},{headers:s}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=Ie(i.expires_in)),{data:o,error:null}}catch(s){return{data:null,error:s}}})}verifyOTP({email:e,phone:t,token:r,type:s="sms"},i={}){return le(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),a=yield de(this.fetch,`${this.url}/verify`,{email:e,phone:t,token:r,type:s,redirect_to:i.redirectTo},{headers:o}),l=Object.assign({},a);return l.expires_in&&(l.expires_at=Ie(a.expires_in)),{data:l,error:null}}catch(o){return{data:null,error:o}}})}inviteUserByEmail(e,t={}){return le(this,void 0,void 0,function*(){try{const r=Object.assign({},this.headers);let s="";return t.redirectTo&&(s+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield de(this.fetch,`${this.url}/invite${s}`,{email:e,data:t.data},{headers:r}),error:null}}catch(r){return{data:null,error:r}}})}resetPasswordForEmail(e,t={}){return le(this,void 0,void 0,function*(){try{const r=Object.assign({},this.headers);let s="";return t.redirectTo&&(s+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield de(this.fetch,`${this.url}/recover${s}`,{email:e,gotrue_meta_security:{hcaptcha_token:t.captchaToken}},{headers:r}),error:null}}catch(r){return{data:null,error:r}}})}refreshAccessToken(e){return le(this,void 0,void 0,function*(){try{const t=yield de(this.fetch,`${this.url}/token?grant_type=refresh_token`,{refresh_token:e},{headers:this.headers}),r=Object.assign({},t);return r.expires_in&&(r.expires_at=Ie(t.expires_in)),{data:r,error:null}}catch(t){return{data:null,error:t}}})}setAuthCookie(e,t){e.method!=="POST"&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:r,session:s}=e.body;if(!r)throw new Error("Auth event missing!");if(r==="SIGNED_IN"){if(!s)throw new Error("Auth session missing!");Ot(e,t,[{key:"access-token",value:s.access_token},{key:"refresh-token",value:s.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}r==="SIGNED_OUT"&&Ot(e,t,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))),t.status(200).json({})}deleteAuthCookie(e,t,{redirectTo:r="/"}){return Ot(e,t,["access-token","refresh-token"].map(s=>({name:`${this.cookieName()}-${s}`,value:"",maxAge:-1}))),t.redirect(307,r)}getAuthCookieString(e,t){e.method!=="POST"&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:r,session:s}=e.body;if(!r)throw new Error("Auth event missing!");if(r==="SIGNED_IN"){if(!s)throw new Error("Auth session missing!");return gr(e,t,[{key:"access-token",value:s.access_token},{key:"refresh-token",value:s.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}return r==="SIGNED_OUT"?gr(e,t,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))):t.getHeader("Set-Cookie")}generateLink(e,t,r={}){return le(this,void 0,void 0,function*(){try{return{data:yield de(this.fetch,`${this.url}/admin/generate_link`,{type:e,email:t,password:r.password,data:r.data,redirect_to:r.redirectTo},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}createUser(e){return le(this,void 0,void 0,function*(){try{const t=yield de(this.fetch,`${this.url}/admin/users`,e,{headers:this.headers});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}listUsers(){return le(this,void 0,void 0,function*(){try{return{data:(yield dr(this.fetch,`${this.url}/admin/users`,{headers:this.headers})).users,error:null}}catch(e){return{data:null,error:e}}})}getUserById(e){return le(this,void 0,void 0,function*(){try{return{data:yield dr(this.fetch,`${this.url}/admin/users/${e}`,{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}getUserByCookie(e,t){return le(this,void 0,void 0,function*(){try{if(!e.cookies)throw new Error("Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!");const r=e.cookies[`${this.cookieName()}-access-token`],s=e.cookies[`${this.cookieName()}-refresh-token`];if(!r)throw new Error("No cookie found!");const{user:i,error:o}=yield this.getUser(r);if(o){if(!s)throw new Error("No refresh_token cookie found!");if(!t)throw new Error("You need to pass the res object to automatically refresh the session!");const{data:a,error:l}=yield this.refreshAccessToken(s);if(l)throw l;if(a)return Ot(e,t,[{key:"access-token",value:a.access_token},{key:"refresh-token",value:a.refresh_token}].map(u=>{var h;return{name:`${this.cookieName()}-${u.key}`,value:u.value,domain:this.cookieOptions.domain,maxAge:(h=this.cookieOptions.lifetime)!==null&&h!==void 0?h:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}})),{token:a.access_token,user:a.user,data:a.user,error:null}}return{token:r,user:i,data:i,error:null}}catch(r){return{token:null,user:null,data:null,error:r}}})}updateUserById(e,t){return le(this,void 0,void 0,function*(){try{const r=yield Cn(this.fetch,`${this.url}/admin/users/${e}`,t,{headers:this.headers});return{user:r,data:r,error:null}}catch(r){return{user:null,data:null,error:r}}})}deleteUser(e){return le(this,void 0,void 0,function*(){try{const t=yield ko(this.fetch,`${this.url}/admin/users/${e}`,{},{headers:this.headers});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}getUser(e){return le(this,void 0,void 0,function*(){try{const t=yield dr(this.fetch,`${this.url}/user`,{headers:this._createRequestHeaders(e)});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}updateUser(e,t){return le(this,void 0,void 0,function*(){try{const r=yield Cn(this.fetch,`${this.url}/user`,t,{headers:this._createRequestHeaders(e)});return{user:r,data:r,error:null}}catch(r){return{user:null,data:null,error:r}}})}}function xo(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self!="undefined"&&(self.globalThis=self)}}var fe=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};xo();const Uo={url:vo,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:go};class Do{constructor(e){this.stateChangeEmitters=new Map,this.networkRetries=0;const t=Object.assign(Object.assign({},Uo),e);this.currentUser=null,this.currentSession=null,this.autoRefreshToken=t.autoRefreshToken,this.persistSession=t.persistSession,this.multiTab=t.multiTab,this.localStorage=t.localStorage||globalThis.localStorage,this.api=new No({url:t.url,headers:t.headers,cookieOptions:t.cookieOptions,fetch:t.fetch}),this._recoverSession(),this._recoverAndRefresh(),this._listenForMultiTabEvents(),this._handleVisibilityChange(),t.detectSessionInUrl&&Re()&&!!Ce("access_token")&&this.getSessionFromUrl({storeSession:!0}).then(({error:r})=>{r&&console.error("Error getting session from URL.",r)})}signUp({email:e,password:t,phone:r},s={}){return fe(this,void 0,void 0,function*(){try{this._removeSession();const{data:i,error:o}=r&&t?yield this.api.signUpWithPhone(r,t,{data:s.data,captchaToken:s.captchaToken}):yield this.api.signUpWithEmail(e,t,{redirectTo:s.redirectTo,data:s.data,captchaToken:s.captchaToken});if(o)throw o;if(!i)throw"An error occurred on sign up.";let a=null,l=null;return i.access_token&&(a=i,l=a.user,this._saveSession(a),this._notifyAllSubscribers("SIGNED_IN")),i.id&&(l=i),{user:l,session:a,error:null}}catch(i){return{user:null,session:null,error:i}}})}signIn({email:e,phone:t,password:r,refreshToken:s,provider:i,oidc:o},a={}){return fe(this,void 0,void 0,function*(){try{if(this._removeSession(),e&&!r){const{error:l}=yield this.api.sendMagicLinkEmail(e,{redirectTo:a.redirectTo,shouldCreateUser:a.shouldCreateUser,captchaToken:a.captchaToken});return{user:null,session:null,error:l}}if(e&&r)return this._handleEmailSignIn(e,r,{redirectTo:a.redirectTo});if(t&&!r){const{error:l}=yield this.api.sendMobileOTP(t,{shouldCreateUser:a.shouldCreateUser,captchaToken:a.captchaToken});return{user:null,session:null,error:l}}if(t&&r)return this._handlePhoneSignIn(t,r);if(s){const{error:l}=yield this._callRefreshToken(s);if(l)throw l;return{user:this.currentUser,session:this.currentSession,error:null}}if(i)return this._handleProviderSignIn(i,{redirectTo:a.redirectTo,scopes:a.scopes,queryParams:a.queryParams});if(o)return this._handleOpenIDConnectSignIn(o);throw new Error("You must provide either an email, phone number, a third-party provider or OpenID Connect.")}catch(l){return{user:null,session:null,error:l}}})}verifyOTP(e,t={}){return fe(this,void 0,void 0,function*(){try{this._removeSession();const{data:r,error:s}=yield this.api.verifyOTP(e,t);if(s)throw s;if(!r)throw"An error occurred on token verification.";let i=null,o=null;return r.access_token&&(i=r,o=i.user,this._saveSession(i),this._notifyAllSubscribers("SIGNED_IN")),r.id&&(o=r),{user:o,session:i,error:null}}catch(r){return{user:null,session:null,error:r}}})}user(){return this.currentUser}session(){return this.currentSession}refreshSession(){var e;return fe(this,void 0,void 0,function*(){try{if(!(!((e=this.currentSession)===null||e===void 0)&&e.access_token))throw new Error("Not logged in.");const{error:t}=yield this._callRefreshToken();if(t)throw t;return{data:this.currentSession,user:this.currentUser,error:null}}catch(t){return{data:null,user:null,error:t}}})}update(e){var t;return fe(this,void 0,void 0,function*(){try{if(!(!((t=this.currentSession)===null||t===void 0)&&t.access_token))throw new Error("Not logged in.");const{user:r,error:s}=yield this.api.updateUser(this.currentSession.access_token,e);if(s)throw s;if(!r)throw Error("Invalid user data.");const i=Object.assign(Object.assign({},this.currentSession),{user:r});return this._saveSession(i),this._notifyAllSubscribers("USER_UPDATED"),{data:r,user:r,error:null}}catch(r){return{data:null,user:null,error:r}}})}setSession(e){return fe(this,void 0,void 0,function*(){try{if(!e)throw new Error("No current session.");const{data:t,error:r}=yield this.api.refreshAccessToken(e);return r?{session:null,error:r}:(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"),{session:t,error:null})}catch(t){return{error:t,session:null}}})}setAuth(e){return this.currentSession=Object.assign(Object.assign({},this.currentSession),{access_token:e,token_type:"bearer",user:this.user()}),this._notifyAllSubscribers("TOKEN_REFRESHED"),this.currentSession}getSessionFromUrl(e){return fe(this,void 0,void 0,function*(){try{if(!Re())throw new Error("No browser detected.");const t=Ce("error_description");if(t)throw new Error(t);const r=Ce("provider_token"),s=Ce("access_token");if(!s)throw new Error("No access_token detected.");const i=Ce("expires_in");if(!i)throw new Error("No expires_in detected.");const o=Ce("refresh_token");if(!o)throw new Error("No refresh_token detected.");const a=Ce("token_type");if(!a)throw new Error("No token_type detected.");const u=Math.round(Date.now()/1e3)+parseInt(i),{user:h,error:c}=yield this.api.getUser(s);if(c)throw c;const f={provider_token:r,access_token:s,expires_in:parseInt(i),expires_at:u,refresh_token:o,token_type:a,user:h};if(e!=null&&e.storeSession){this._saveSession(f);const g=Ce("type");this._notifyAllSubscribers("SIGNED_IN"),g==="recovery"&&this._notifyAllSubscribers("PASSWORD_RECOVERY")}return window.location.hash="",{data:f,error:null}}catch(t){return{data:null,error:t}}})}signOut(){var e;return fe(this,void 0,void 0,function*(){const t=(e=this.currentSession)===null||e===void 0?void 0:e.access_token;if(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"),t){const{error:r}=yield this.api.signOut(t);if(r)return{error:r}}return{error:null}})}onAuthStateChange(e){try{const t=Po(),r={id:t,callback:e,unsubscribe:()=>{this.stateChangeEmitters.delete(t)}};return this.stateChangeEmitters.set(t,r),{data:r,error:null}}catch(t){return{data:null,error:t}}}_handleEmailSignIn(e,t,r={}){var s,i;return fe(this,void 0,void 0,function*(){try{const{data:o,error:a}=yield this.api.signInWithEmail(e,t,{redirectTo:r.redirectTo});return a||!o?{data:null,user:null,session:null,error:a}:((((s=o==null?void 0:o.user)===null||s===void 0?void 0:s.confirmed_at)||((i=o==null?void 0:o.user)===null||i===void 0?void 0:i.email_confirmed_at))&&(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN")),{data:o,user:o.user,session:o,error:null})}catch(o){return{data:null,user:null,session:null,error:o}}})}_handlePhoneSignIn(e,t){var r;return fe(this,void 0,void 0,function*(){try{const{data:s,error:i}=yield this.api.signInWithPhone(e,t);return i||!s?{data:null,user:null,session:null,error:i}:(!((r=s==null?void 0:s.user)===null||r===void 0)&&r.phone_confirmed_at&&(this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN")),{data:s,user:s.user,session:s,error:null})}catch(s){return{data:null,user:null,session:null,error:s}}})}_handleProviderSignIn(e,t={}){const r=this.api.getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});try{return Re()&&(window.location.href=r),{provider:e,url:r,data:null,session:null,user:null,error:null}}catch(s){return r?{provider:e,url:r,data:null,session:null,user:null,error:null}:{data:null,user:null,session:null,error:s}}}_handleOpenIDConnectSignIn({id_token:e,nonce:t,client_id:r,issuer:s,provider:i}){return fe(this,void 0,void 0,function*(){if(e&&t&&(r&&s||i))try{const{data:o,error:a}=yield this.api.signInWithOpenIDConnect({id_token:e,nonce:t,client_id:r,issuer:s,provider:i});return a||!o?{user:null,session:null,error:a}:(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN"),{user:o.user,session:o,error:null})}catch(o){return{user:null,session:null,error:o}}throw new Error("You must provide a OpenID Connect provider with your id token and nonce.")})}_recoverSession(){try{const e=Io(this.localStorage,pt);if(!e)return null;const{currentSession:t,expiresAt:r}=e,s=Math.round(Date.now()/1e3);r>=s+St&&(t==null?void 0:t.user)&&(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"))}catch(e){console.log("error",e)}}_recoverAndRefresh(){return fe(this,void 0,void 0,function*(){try{const e=yield Ao(this.localStorage,pt);if(!e)return null;const{currentSession:t,expiresAt:r}=e,s=Math.round(Date.now()/1e3);if(r<s+St)if(this.autoRefreshToken&&t.refresh_token){this.networkRetries++;const{error:i}=yield this._callRefreshToken(t.refresh_token);if(i){if(console.log(i.message),i.message===De.ERROR_MESSAGE&&this.networkRetries<De.MAX_RETRIES){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),this.refreshTokenTimer=setTimeout(()=>this._recoverAndRefresh(),Math.pow(De.RETRY_INTERVAL,this.networkRetries)*100);return}yield this._removeSession()}this.networkRetries=0}else this._removeSession();else t?(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN")):(console.log("Current session is missing data."),this._removeSession())}catch(e){return console.error(e),null}})}_callRefreshToken(e){var t;return e===void 0&&(e=(t=this.currentSession)===null||t===void 0?void 0:t.refresh_token),fe(this,void 0,void 0,function*(){try{if(!e)throw new Error("No current session.");const{data:r,error:s}=yield this.api.refreshAccessToken(e);if(s)throw s;if(!r)throw Error("Invalid session data.");return this._saveSession(r),this._notifyAllSubscribers("TOKEN_REFRESHED"),this._notifyAllSubscribers("SIGNED_IN"),{data:r,error:null}}catch(r){return{data:null,error:r}}})}_notifyAllSubscribers(e){this.stateChangeEmitters.forEach(t=>t.callback(e,this.currentSession))}_saveSession(e){this.currentSession=e,this.currentUser=e.user;const t=e.expires_at;if(t){const r=Math.round(Date.now()/1e3),s=t-r,i=s>St?St:.5;this._startAutoRefreshToken((s-i)*1e3)}this.persistSession&&e.expires_at&&this._persistSession(this.currentSession)}_persistSession(e){const t={currentSession:e,expiresAt:e.expires_at};Ro(this.localStorage,pt,t)}_removeSession(){return fe(this,void 0,void 0,function*(){this.currentSession=null,this.currentUser=null,this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),Co(this.localStorage,pt)})}_startAutoRefreshToken(e){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),!(e<=0||!this.autoRefreshToken)&&(this.refreshTokenTimer=setTimeout(()=>fe(this,void 0,void 0,function*(){this.networkRetries++;const{error:t}=yield this._callRefreshToken();t||(this.networkRetries=0),(t==null?void 0:t.message)===De.ERROR_MESSAGE&&this.networkRetries<De.MAX_RETRIES&&this._startAutoRefreshToken(Math.pow(De.RETRY_INTERVAL,this.networkRetries)*100)}),e),typeof this.refreshTokenTimer.unref=="function"&&this.refreshTokenTimer.unref())}_listenForMultiTabEvents(){if(!this.multiTab||!Re()||!(window!=null&&window.addEventListener))return!1;try{window==null||window.addEventListener("storage",e=>{var t;if(e.key===pt){const r=JSON.parse(String(e.newValue));!((t=r==null?void 0:r.currentSession)===null||t===void 0)&&t.access_token?(this._saveSession(r.currentSession),this._notifyAllSubscribers("SIGNED_IN")):(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"))}})}catch(e){console.error("_listenForMultiTabEvents",e)}}_handleVisibilityChange(){if(!this.multiTab||!Re()||!(window!=null&&window.addEventListener))return!1;try{window==null||window.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this._recoverAndRefresh()})}catch(e){console.error("_handleVisibilityChange",e)}}}class Mo extends Do{constructor(e){super(e)}}var Bo=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class $r{constructor(e){Object.assign(this,e);let t;e.fetch?t=e.fetch:typeof fetch=="undefined"?t=Mt:t=fetch,this.fetch=(...r)=>t(...r),this.shouldThrowOnError=e.shouldThrowOnError||!1,this.allowEmpty=e.allowEmpty||!1}throwOnError(e){return e==null&&(e=!0),this.shouldThrowOnError=e,this}then(e,t){typeof this.schema=="undefined"||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let r=this.fetch(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(s=>Bo(this,void 0,void 0,function*(){var i,o,a,l;let u=null,h=null,c=null,f=s.status,g=s.statusText;if(s.ok){const _=(i=this.headers.Prefer)===null||i===void 0?void 0:i.split(",").includes("return=minimal");if(this.method!=="HEAD"&&!_){const $=yield s.text();$&&(this.headers.Accept==="text/csv"?h=$:h=JSON.parse($))}const E=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),k=(a=s.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");E&&k&&k.length>1&&(c=parseInt(k[1]))}else{const _=yield s.text();try{u=JSON.parse(_)}catch{u={message:_}}if(u&&this.allowEmpty&&((l=u==null?void 0:u.details)===null||l===void 0?void 0:l.includes("Results contain 0 rows"))&&(u=null,f=200,g="OK"),u&&this.shouldThrowOnError)throw u}return{error:u,data:h,count:c,status:f,statusText:g,body:h}}));return this.shouldThrowOnError||(r=r.catch(s=>({error:{message:`FetchError: ${s.message}`,details:"",hint:"",code:s.code||""},data:null,body:null,count:null,status:400,statusText:"Bad Request"}))),r.then(e,t)}}class Lo extends $r{select(e="*"){let t=!1;const r=e.split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this}order(e,{ascending:t=!0,nullsFirst:r=!1,foreignTable:s}={}){const i=typeof s=="undefined"?"order":`${s}.order`,o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}.${r?"nullsfirst":"nullslast"}`),this}limit(e,{foreignTable:t}={}){const r=typeof t=="undefined"?"limit":`${t}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:r}={}){const s=typeof r=="undefined"?"offset":`${r}.offset`,i=typeof r=="undefined"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.headers.Accept="application/vnd.pgrst.object+json",this.allowEmpty=!0,this}csv(){return this.headers.Accept="text/csv",this}}class Xe extends Lo{constructor(){super(...arguments),this.cs=this.contains,this.cd=this.containedBy,this.sl=this.rangeLt,this.sr=this.rangeGt,this.nxl=this.rangeGte,this.nxr=this.rangeLte,this.adj=this.rangeAdjacent,this.ov=this.overlaps}not(e,t,r){return this.url.searchParams.append(`${e}`,`not.${t}.${r}`),this}or(e,{foreignTable:t}={}){const r=typeof t=="undefined"?"or":`${t}.or`;return this.url.searchParams.append(r,`(${e})`),this}eq(e,t){return this.url.searchParams.append(`${e}`,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(`${e}`,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(`${e}`,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(`${e}`,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(`${e}`,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(`${e}`,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(`${e}`,`like.${t}`),this}ilike(e,t){return this.url.searchParams.append(`${e}`,`ilike.${t}`),this}is(e,t){return this.url.searchParams.append(`${e}`,`is.${t}`),this}in(e,t){const r=t.map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(`${e}`,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(`${e}`,`cs.{${t.join(",")}}`):this.url.searchParams.append(`${e}`,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(`${e}`,`cd.{${t.join(",")}}`):this.url.searchParams.append(`${e}`,`cd.${JSON.stringify(t)}`),this}rangeLt(e,t){return this.url.searchParams.append(`${e}`,`sl.${t}`),this}rangeGt(e,t){return this.url.searchParams.append(`${e}`,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(`${e}`,`nxl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(`${e}`,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(`${e}`,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`ov.${t}`):this.url.searchParams.append(`${e}`,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s=null}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(`${e}`,`${i}fts${o}.${t}`),this}fts(e,t,{config:r}={}){const s=typeof r=="undefined"?"":`(${r})`;return this.url.searchParams.append(`${e}`,`fts${s}.${t}`),this}plfts(e,t,{config:r}={}){const s=typeof r=="undefined"?"":`(${r})`;return this.url.searchParams.append(`${e}`,`plfts${s}.${t}`),this}phfts(e,t,{config:r}={}){const s=typeof r=="undefined"?"":`(${r})`;return this.url.searchParams.append(`${e}`,`phfts${s}.${t}`),this}wfts(e,t,{config:r}={}){const s=typeof r=="undefined"?"":`(${r})`;return this.url.searchParams.append(`${e}`,`wfts${s}.${t}`),this}filter(e,t,r){return this.url.searchParams.append(`${e}`,`${t}.${r}`),this}match(e){return Object.keys(e).forEach(t=>{this.url.searchParams.append(`${t}`,`eq.${e[t]}`)}),this}}class rs extends $r{constructor(e,{headers:t={},schema:r,fetch:s,shouldThrowOnError:i}={}){super({fetch:s,shouldThrowOnError:i}),this.url=new URL(e),this.headers=Object.assign({},t),this.schema=r}select(e="*",{head:t=!1,count:r=null}={}){this.method="GET";let s=!1;const i=e.split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),r&&(this.headers.Prefer=`count=${r}`),t&&(this.method="HEAD"),new Xe(this)}insert(e,{upsert:t=!1,onConflict:r,returning:s="representation",count:i=null}={}){this.method="POST";const o=[`return=${s}`];if(t&&o.push("resolution=merge-duplicates"),t&&r!==void 0&&this.url.searchParams.set("on_conflict",r),this.body=e,i&&o.push(`count=${i}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),Array.isArray(e)){const a=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(a.length>0){const l=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new Xe(this)}upsert(e,{onConflict:t,returning:r="representation",count:s=null,ignoreDuplicates:i=!1}={}){this.method="POST";const o=[`resolution=${i?"ignore":"merge"}-duplicates`,`return=${r}`];return t!==void 0&&this.url.searchParams.set("on_conflict",t),this.body=e,s&&o.push(`count=${s}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new Xe(this)}update(e,{returning:t="representation",count:r=null}={}){this.method="PATCH";const s=[`return=${t}`];return this.body=e,r&&s.push(`count=${r}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Xe(this)}delete({returning:e="representation",count:t=null}={}){this.method="DELETE";const r=[`return=${e}`];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Xe(this)}}class zo extends $r{constructor(e,{headers:t={},schema:r,fetch:s,shouldThrowOnError:i}={}){super({fetch:s,shouldThrowOnError:i}),this.url=new URL(e),this.headers=Object.assign({},t),this.schema=r}rpc(e,{head:t=!1,count:r=null}={}){return t?(this.method="HEAD",e&&Object.entries(e).forEach(([s,i])=>{this.url.searchParams.append(s,i)})):(this.method="POST",this.body=e),r&&(this.headers.Prefer!==void 0?this.headers.Prefer+=`,count=${r}`:this.headers.Prefer=`count=${r}`),new Xe(this)}}const Fo="0.37.3",Go={"X-Client-Info":`postgrest-js/${Fo}`};class Ho{constructor(e,{headers:t={},schema:r,fetch:s,throwOnError:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},Go),t),this.schema=r,this.fetch=s,this.shouldThrowOnError=i}auth(e){return this.headers.Authorization=`Bearer ${e}`,this}from(e){const t=`${this.url}/${e}`;return new rs(t,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(e,t,{head:r=!1,count:s=null}={}){const i=`${this.url}/rpc/${e}`;return new zo(i,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError}).rpc(t,{head:r,count:s})}}var X;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(X||(X={}));const Nn=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=qo(o,n,e,s),i),{})},qo=(n,e,t,r)=>{const s=e.find(a=>a.name===n),i=s==null?void 0:s.type,o=t[n];return i&&!r.includes(i)?ns(i,o):wr(o)},ns=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Yo(e,t)}switch(n){case X.bool:return Wo(e);case X.float4:case X.float8:case X.int2:case X.int4:case X.int8:case X.numeric:case X.oid:return Jo(e);case X.json:case X.jsonb:return Vo(e);case X.timestamp:return Ko(e);case X.abstime:case X.date:case X.daterange:case X.int4range:case X.int8range:case X.money:case X.reltime:case X.text:case X.time:case X.timestamptz:case X.timetz:case X.tsrange:case X.tstzrange:return wr(e);default:return wr(e)}},wr=n=>n,Wo=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Jo=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Vo=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Yo=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>ns(e,a))}return n},Ko=n=>typeof n=="string"?n.replace(" ","T"):n,Xo="websocket",Qo="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",Zo=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],ea="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",ta=["I\xF1aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],ra="1.0.34",na={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},sa="https://github.com/theturtle32/WebSocket-Node",ia={node:">=4.0.0"},oa={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},aa={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},la={verbose:!1},ua={test:"tape test/unit/*.js",gulp:"gulp"},ca="index",ha={lib:"./lib"},da="lib/browser.js",fa="Apache-2.0";var pa={name:Xo,description:Qo,keywords:Zo,author:ea,contributors:ta,version:ra,repository:na,homepage:sa,engines:ia,dependencies:oa,devDependencies:aa,config:la,scripts:ua,main:ca,directories:ha,browser:da,license:fa},ma=pa.version,Me;if(typeof globalThis=="object")Me=globalThis;else try{Me=require("es5-ext/global")}catch{}finally{if(!Me&&typeof window!="undefined"&&(Me=window),!Me)throw new Error("Could not determine global this")}var _t=Me.WebSocket||Me.MozWebSocket,va=ma;function ss(n,e){var t;return e?t=new _t(n,e):t=new _t(n),t}_t&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(n){Object.defineProperty(ss,n,{get:function(){return _t[n]}})});var ga={w3cwebsocket:_t?ss:null,version:va};const _a="1.7.2",wa={"X-Client-Info":`realtime-js/${_a}`},ya="1.0.0",is=1e4,ba=1e3;var gt;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(gt||(gt={}));var Q;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Q||(Q={}));var ue;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(ue||(ue={}));var yr;(function(n){n.websocket="websocket"})(yr||(yr={}));var Be;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Be||(Be={}));class Rr{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class ka{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=r.decode(e.slice(o,o+s));o=o+s;const l=r.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}}class et{constructor(e,t,r={},s=is){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel instanceof br?this.channel.on(this.refEvent,e):this.channel.on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel.trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){!this.refEvent||(this.channel instanceof br?this.channel.off(this.refEvent):this.channel.off(this.refEvent,{}))}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}class br{constructor(e,t={},r){this.topic=e,this.params=t,this.socket=r,this.bindings=[],this.state=Q.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new et(this,ue.join,this.params,this.timeout),this.rejoinTimer=new Rr(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Q.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=Q.closed,this.socket.remove(this)}),this.onError(s=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this.isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.on(ue.reply,(s,i)=>{this.trigger(this.replyEventName(i),s)})}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(e=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(e),this.joinPush}onClose(e){this.on(ue.close,e)}onError(e){this.on(ue.error,t=>e(t))}on(e,t){this.bindings.push({event:e,callback:t})}off(e){this.bindings=this.bindings.filter(t=>t.event!==e)}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new et(this,e,t,r);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Q.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(ue.close,"leave",this.joinRef())};this.joinPush.destroy();let r=new et(this,ue.leave,{},e);return r.receive("ok",()=>t()).receive("timeout",()=>t()),r.send(),this.canPush()||r.trigger("ok",{}),r}onMessage(e,t,r){return t}isMember(e){return this.topic===e}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=Q.joining,this.joinPush.resend(e))}trigger(e,t,r){let{close:s,error:i,leave:o,join:a}=ue;if(r&&[s,i,o,a].indexOf(e)>=0&&r!==this.joinRef())return;let u=this.onMessage(e,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(h=>h.event==="*"?e===(t==null?void 0:t.type):h.event===e).map(h=>h.callback(u,r))}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===Q.closed}isErrored(){return this.state===Q.errored}isJoined(){return this.state===Q.joined}isJoining(){return this.state===Q.joining}isLeaving(){return this.state===Q.leaving}}class Ze{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel.on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel.joinRef(),this.state=Ze.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=Ze.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel.on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ze.syncDiff(this.state,s,i,o),a())})}static syncState(e,t,r,s){const i=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(i,(u,h)=>{o[u]||(l[u]=h)}),this.map(o,(u,h)=>{const c=i[u];if(c){const f=h.map(E=>E.presence_id),g=c.map(E=>E.presence_id),v=h.filter(E=>g.indexOf(E.presence_id)<0),_=c.filter(E=>f.indexOf(E.presence_id)<0);v.length>0&&(a[u]=v),_.length>0&&(l[u]=_)}else a[u]=h}),this.syncDiff(i,{joins:a,leaves:l},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{const u=e[a];if(e[a]=this.cloneDeep(l),u){const h=e[a].map(f=>f.presence_id),c=u.filter(f=>h.indexOf(f.presence_id)<0);e[a].unshift(...c)}r(a,u,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const h=l.map(c=>c.presence_id);u=u.filter(c=>h.indexOf(c.presence_id)<0),e[a]=u,s(a,u,l),u.length===0&&delete e[a]}),e}static list(e,t){return t||(t=(r,s)=>s),this.map(e,(r,s)=>t(r,s))}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_id=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}list(e){return Ze.list(this.state,e)}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel.joinRef()}}class Ct{constructor(e,t={},r){this.topic=e,this.params=t,this.socket=r,this.bindings=[],this.state=Q.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new et(this,ue.join,this.params,this.timeout),this.rejoinTimer=new Rr(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Q.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=Q.closed,this.socket.remove(this)}),this.onError(s=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this.isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.on(ue.reply,{},(s,i)=>{this.trigger(this.replyEventName(i),s)}),this.presence=new Ze(this)}list(){return this.presence.list()}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(e=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const t=this.bindings.reduce((r,s)=>{const{type:i}=s;return["phx_close","phx_error","phx_reply","presence_diff","presence_state"].includes(i)||(r[i]=s),r},{});return Object.keys(t).length&&this.updateJoinPayload({configs:t}),this.joinedOnce=!0,this.rejoin(e),this.joinPush}}onClose(e){this.on(ue.close,{},e)}onError(e){this.on(ue.error,{},t=>e(t))}on(e,t,r){this.bindings.push({type:e,filter:t!=null?t:{},callback:r!=null?r:()=>{}})}off(e,t){this.bindings=this.bindings.filter(r=>!(r.type===e&&Ct.isEqual(r.filter,t)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new et(this,e,t,r);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Q.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(ue.close,"leave",this.joinRef())};this.joinPush.destroy();const r=new et(this,ue.leave,{},e);return r.receive("ok",()=>t()).receive("timeout",()=>t()),r.send(),this.canPush()||r.trigger("ok",{}),r}onMessage(e,t,r){return t}isMember(e){return this.topic===e}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=Q.joining,this.joinPush.resend(e))}trigger(e,t,r){const{close:s,error:i,leave:o,join:a}=ue;if(r&&[s,i,o,a].indexOf(e)>=0&&r!==this.joinRef())return;const u=this.onMessage(e,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(h=>{var c,f;return(h==null?void 0:h.type)===e&&(((c=h==null?void 0:h.filter)===null||c===void 0?void 0:c.event)==="*"||((f=h==null?void 0:h.filter)===null||f===void 0?void 0:f.event)===(t==null?void 0:t.event))}).map(h=>h.callback(u,r))}send(e){const t=this.push(e.type,e);return new Promise((r,s)=>{t.receive("ok",()=>r("ok")),t.receive("timeout",()=>s("timeout"))})}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===Q.closed}isErrored(){return this.state===Q.errored}isJoined(){return this.state===Q.joined}isJoining(){return this.state===Q.joining}isLeaving(){return this.state===Q.leaving}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}}var Ea=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},Ta=globalThis&&globalThis.__rest||function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const Sa=()=>{};class Oa{constructor(e,t){this.accessToken=null,this.channels=[],this.endPoint="",this.headers=wa,this.params={},this.timeout=is,this.transport=ga.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.longpollerTimeout=2e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Sa,this.conn=null,this.sendBuffer=[],this.serializer=new ka,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.endPoint=`${e}/${yr.websocket}`,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.transport&&(this.transport=t.transport),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs),t!=null&&t.longpollerTimeout&&(this.longpollerTimeout=t.longpollerTimeout),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:r=>[1e3,2e3,5e3,1e4][r-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(r,s)=>s(JSON.stringify(r)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Rr(()=>Ea(this,void 0,void 0,function*(){yield this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this.endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this.onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e)))}disconnect(e,t){return new Promise((r,s)=>{try{this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t||""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset()),r({error:null,data:!0})}catch(i){r({error:i,data:!1})}})}log(e,t,r){this.logger(e,t,r)}onOpen(e){this.stateChangeCallbacks.open.push(e)}onClose(e){this.stateChangeCallbacks.close.push(e)}onError(e){this.stateChangeCallbacks.error.push(e)}onMessage(e){this.stateChangeCallbacks.message.push(e)}connectionState(){switch(this.conn&&this.conn.readyState){case gt.connecting:return Be.Connecting;case gt.open:return Be.Open;case gt.closing:return Be.Closing;default:return Be.Closed}}isConnected(){return this.connectionState()===Be.Open}remove(e){this.channels=this.channels.filter(t=>t.joinRef()!==e.joinRef())}channel(e,t={}){var r;const{selfBroadcast:s}=t,i=Ta(t,["selfBroadcast"]);s&&(i.self_broadcast=s);const o=!((r=this.params)===null||r===void 0)&&r.vsndate?new Ct(e,i,this):new br(e,i,this);return o instanceof Ct&&(o.presence.onJoin((a,l,u)=>{o.trigger("presence",{event:"JOIN",key:a,currentPresences:l,newPresences:u})}),o.presence.onLeave((a,l,u)=>{o.trigger("presence",{event:"LEAVE",key:a,currentPresences:l,leftPresences:u})}),o.presence.onSync(()=>{o.trigger("presence",{event:"SYNC"})})),this.channels.push(o),o}push(e){const{topic:t,event:r,payload:s,ref:i}=e;let o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:o}=t;(o&&o===this.pendingHeartbeatRef||s===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,i),this.channels.filter(a=>a.isMember(r)).forEach(a=>a.trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ya}))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({user_token:e}),t.joinedOnce&&t.isJoined()&&t.push(ue.access_token,{access_token:e})})}leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r.isJoined()||r.isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_onConnOpen(){this.log("transport",`connected to ${this.endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e.trigger(ue.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(!!this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(ba,"hearbeat timeout");return}this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class ja{constructor(e,t,r,s){const i={},o=s==="*"?`realtime:${r}`:`realtime:${r}:${s}`,a=t.Authorization.split(" ")[1];a&&(i.user_token=a),this.subscription=e.channel(o,i)}getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Nn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Nn(e.columns,e.old_record)),t}on(e,t){return this.subscription.on(e,r=>{let s={schema:r.schema,table:r.table,commit_timestamp:r.commit_timestamp,eventType:r.type,new:{},old:{},errors:r.errors};s=Object.assign(Object.assign({},s),this.getPayloadRecords(r)),t(s)}),this}subscribe(e=()=>{}){return this.subscription.onError(t=>e("SUBSCRIPTION_ERROR",t)),this.subscription.onClose(()=>e("CLOSED")),this.subscription.subscribe().receive("ok",()=>e("SUBSCRIBED")).receive("error",t=>e("SUBSCRIPTION_ERROR",t)).receive("timeout",()=>e("RETRYING_AFTER_TIMEOUT")),this.subscription}}class Pa extends rs{constructor(e,{headers:t={},schema:r,realtime:s,table:i,fetch:o,shouldThrowOnError:a}){super(e,{headers:t,schema:r,fetch:o,shouldThrowOnError:a}),this._subscription=null,this._realtime=s,this._headers=t,this._schema=r,this._table=i}on(e,t){return this._realtime.isConnected()||this._realtime.connect(),this._subscription||(this._subscription=new ja(this._realtime,this._headers,this._schema,this._table)),this._subscription.on(e,t)}}const $a="0.0.0",Ra={"X-Client-Info":`storage-js/${$a}`};var kt=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Aa=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Ia=(n,e)=>{if(typeof n.json!="function")return e(n);n.json().then(t=>e({message:Aa(t),status:(n==null?void 0:n.status)||500}))},Ca=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};function Bt(n,e,t,r,s,i){return kt(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(t,Ca(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?o(l):l.json()}).then(l=>o(l)).catch(l=>Ia(l,a))})})}function kr(n,e,t,r){return kt(this,void 0,void 0,function*(){return Bt(n,"GET",e,t,r)})}function Le(n,e,t,r,s){return kt(this,void 0,void 0,function*(){return Bt(n,"POST",e,r,s,t)})}function Na(n,e,t,r,s){return kt(this,void 0,void 0,function*(){return Bt(n,"PUT",e,r,s,t)})}function os(n,e,t,r,s){return kt(this,void 0,void 0,function*(){return Bt(n,"DELETE",e,r,s,t)})}const as=n=>{let e;return n?e=n:typeof fetch=="undefined"?e=Mt:e=fetch,(...t)=>e(...t)};var Ke=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class xa{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Ra),t),this.fetch=as(r)}listBuckets(){return Ke(this,void 0,void 0,function*(){try{return{data:yield kr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}getBucket(e){return Ke(this,void 0,void 0,function*(){try{return{data:yield kr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}createBucket(e,t={public:!1}){return Ke(this,void 0,void 0,function*(){try{return{data:(yield Le(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public},{headers:this.headers})).name,error:null}}catch(r){return{data:null,error:r}}})}updateBucket(e,t){return Ke(this,void 0,void 0,function*(){try{return{data:yield Na(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public},{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}emptyBucket(e){return Ke(this,void 0,void 0,function*(){try{return{data:yield Le(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}deleteBucket(e){return Ke(this,void 0,void 0,function*(){try{return{data:yield os(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}}var je=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Ua={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Da={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ma{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=as(s)}uploadOrUpdate(e,t,r,s){return je(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Da),s),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob!="undefined"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",r)):typeof FormData!="undefined"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl)):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType);const l=this._removeEmptyFolders(t),u=this._getFinalPath(l),h=yield this.fetch(`${this.url}/object/${u}`,{method:e,body:i,headers:a});if(h.ok)return{data:{Key:u},error:null};{const c=yield h.json();return{data:null,error:c}}}catch(i){return{data:null,error:i}}})}upload(e,t,r){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}update(e,t,r){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t){return je(this,void 0,void 0,function*(){try{return{data:yield Le(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}copy(e,t){return je(this,void 0,void 0,function*(){try{return{data:yield Le(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}createSignedUrl(e,t){return je(this,void 0,void 0,function*(){try{const r=this._getFinalPath(e);let s=yield Le(this.fetch,`${this.url}/object/sign/${r}`,{expiresIn:t},{headers:this.headers});const i=`${this.url}${s.signedURL}`;return s={signedURL:i},{data:s,error:null,signedURL:i}}catch(r){return{data:null,error:r,signedURL:null}}})}createSignedUrls(e,t){return je(this,void 0,void 0,function*(){try{return{data:(yield Le(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers})).map(s=>Object.assign(Object.assign({},s),{signedURL:s.signedURL?`${this.url}${s.signedURL}`:null})),error:null}}catch(r){return{data:null,error:r}}})}download(e){return je(this,void 0,void 0,function*(){try{const t=this._getFinalPath(e);return{data:yield(yield kr(this.fetch,`${this.url}/object/${t}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(t){return{data:null,error:t}}})}getPublicUrl(e){try{const t=this._getFinalPath(e),r=`${this.url}/object/public/${t}`;return{data:{publicURL:r},error:null,publicURL:r}}catch(t){return{data:null,error:t,publicURL:null}}}remove(e){return je(this,void 0,void 0,function*(){try{return{data:yield os(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}list(e,t,r){return je(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Ua),t),{prefix:e||""});return{data:yield Le(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){return{data:null,error:s}}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}}class Ba extends xa{constructor(e,t={},r){super(e,t,r)}from(e){return new Ma(this.url,this.headers,e,this.fetch)}}const La=n=>{let e;return n?e=n:typeof fetch=="undefined"?e=Mt:e=fetch,(...t)=>e(...t)};var za=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Fa{constructor(e,{headers:t={},customFetch:r}={}){this.url=e,this.headers=t,this.fetch=La(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t){return za(this,void 0,void 0,function*(){try{const{headers:r,body:s}=t!=null?t:{},i=yield this.fetch(`${this.url}/${e}`,{method:"POST",headers:Object.assign({},this.headers,r),body:s}),o=i.headers.get("x-relay-error");if(o&&o==="true")return{data:null,error:new Error(yield i.text())};let a;const{responseType:l}=t!=null?t:{};return!l||l==="json"?a=yield i.json():l==="arrayBuffer"?a=yield i.arrayBuffer():l==="blob"?a=yield i.blob():a=yield i.text(),{data:a,error:null}}catch(r){return{data:null,error:r}}})}}var jt=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Ga={schema:"public",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:ts};class Ha{constructor(e,t,r){if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const s=fo(e),i=Object.assign(Object.assign({},Ga),r);if(this.restUrl=`${s}/rest/v1`,this.realtimeUrl=`${s}/realtime/v1`.replace("http","ws"),this.authUrl=`${s}/auth/v1`,this.storageUrl=`${s}/storage/v1`,s.match(/(supabase\.co)|(supabase\.in)/)){const a=s.split(".");this.functionsUrl=`${a[0]}.functions.${a[1]}.${a[2]}`}else this.functionsUrl=`${s}/functions/v1`;this.schema=i.schema,this.multiTab=i.multiTab,this.fetch=i.fetch,this.headers=Object.assign(Object.assign({},ts),r==null?void 0:r.headers),this.shouldThrowOnError=i.shouldThrowOnError||!1,this.auth=this._initSupabaseAuthClient(i),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},i.realtime)),this._listenForAuthEvents(),this._listenForMultiTabEvents()}get functions(){return new Fa(this.functionsUrl,{headers:this._getAuthHeaders(),customFetch:this.fetch})}get storage(){return new Ba(this.storageUrl,this._getAuthHeaders(),this.fetch)}from(e){const t=`${this.restUrl}/${e}`;return new Pa(t,{headers:this._getAuthHeaders(),schema:this.schema,realtime:this.realtime,table:e,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(e,t,{head:r=!1,count:s=null}={}){return this._initPostgRESTClient().rpc(e,t,{head:r,count:s})}channel(e,t){var r,s;const i=(s=(r=this.auth.session())===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:this.supabaseKey;return this.realtime.isConnected()||this.realtime.connect(),this.realtime.channel(e,Object.assign(Object.assign({},t),{user_token:i}))}removeAllSubscriptions(){return jt(this,void 0,void 0,function*(){const e=this.getSubscriptions().slice(),t=e.map(s=>this.removeSubscription(s));return(yield Promise.all(t)).map(({error:s},i)=>({data:{subscription:e[i]},error:s}))})}removeChannel(e){return jt(this,void 0,void 0,function*(){const{error:t}=yield this._closeSubscription(e),r=this.getSubscriptions(),s=r.filter(i=>i.isJoined()).length;return r.length===0&&(yield this.realtime.disconnect()),{data:{openChannels:s},error:t}})}removeSubscription(e){return jt(this,void 0,void 0,function*(){const{error:t}=yield this._closeSubscription(e),r=this.getSubscriptions(),s=r.filter(i=>i.isJoined()).length;return r.length===0&&(yield this.realtime.disconnect()),{data:{openSubscriptions:s},error:t}})}_closeSubscription(e){return jt(this,void 0,void 0,function*(){let t=null;if(!e.isClosed()){const{error:r}=yield this._unsubscribeSubscription(e);t=r}return this.realtime.remove(e),{error:t}})}_unsubscribeSubscription(e){return new Promise(t=>{e.unsubscribe().receive("ok",()=>t({error:null})).receive("error",r=>t({error:r})).receive("timeout",()=>t({error:new Error("timed out")}))})}getSubscriptions(){return this.realtime.channels}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,localStorage:s,headers:i,fetch:o,cookieOptions:a,multiTab:l}){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Mo({url:this.authUrl,headers:Object.assign(Object.assign({},i),u),autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,localStorage:s,fetch:o,cookieOptions:a,multiTab:l})}_initRealtimeClient(e){return new Oa(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign(Object.assign({},e==null?void 0:e.params),{apikey:this.supabaseKey})}))}_initPostgRESTClient(){return new Ho(this.restUrl,{headers:this._getAuthHeaders(),schema:this.schema,fetch:this.fetch,throwOnError:this.shouldThrowOnError})}_getAuthHeaders(){var e,t;const r=Object.assign({},this.headers),s=(t=(e=this.auth.session())===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey;return r.apikey=this.supabaseKey,r.Authorization=r.Authorization||`Bearer ${s}`,r}_listenForMultiTabEvents(){if(!this.multiTab||!po()||!(window!=null&&window.addEventListener))return null;try{return window==null?void 0:window.addEventListener("storage",e=>{var t,r,s;if(e.key===ho){const i=JSON.parse(String(e.newValue)),o=(r=(t=i==null?void 0:i.currentSession)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:void 0,a=(s=this.auth.session())===null||s===void 0?void 0:s.access_token;o?!a&&o?this._handleTokenChanged("SIGNED_IN",o,"STORAGE"):a!==o&&this._handleTokenChanged("TOKEN_REFRESHED",o,"STORAGE"):this._handleTokenChanged("SIGNED_OUT",o,"STORAGE")}})}catch(e){return console.error("_listenForMultiTabEvents",e),null}}_listenForAuthEvents(){let{data:e}=this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,r==null?void 0:r.access_token,"CLIENT")});return e}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.realtime.setAuth(t),r=="STORAGE"&&this.auth.setAuth(t),this.changedAccessToken=t):(e==="SIGNED_OUT"||e==="USER_DELETED")&&(this.realtime.setAuth(this.supabaseKey),r=="STORAGE"&&this.auth.signOut())}}const qa=(n,e,t)=>new Ha(n,e,t),Wa="https://dbmtysppmiwwjwaeneex.supabase.co",Ja="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRibXR5c3BwbWl3d2p3YWVuZWV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDQ5NTI0NDUsImV4cCI6MTk2MDUyODQ0NX0.i_1JrAfv5fieeVaiJrVIQPL6V0_-H9sR-PKIuGDAIfI",Fe=qa(Wa,Ja),Va=async n=>{const e=await Fe.from("wordgame_wod-questions").select("question,id,category").in("id",n);if(e.error)throw console.log(e.error),new Error("getQuestionText failed");if(e.data)return e.data},zl=async({email:n,password:e})=>{const t=await Fe.auth.signIn({email:n,password:e});if(t.error)throw console.log(t.error),new Error("signIn failed");if(t.user)return!0;throw new Error("no user found")},Ya=async n=>{const e=await Fe.from("wordgame_games").select("question_ids").eq("id",n);if(e.error)throw console.log(e.error),new Error("getQuestions failed");if(e.data.length)try{const t=e.data[0].question_ids.split("|").map(s=>+s);return await Va(t)}catch(t){return t}throw new Error("no questions matching that game id")},Fl=async n=>{const e=await Fe.from("wordgame_games").select("wod_started").eq("id",n);if(e.error)throw console.log(e.error),new Error("getWodStarted failed");if(e.data.length)return e.data[0].wod_started;throw new Error("no games matching this id")},ls=async({table:n,column:e,value:t,gameId:r})=>{const s=await Fe.from(n).update({[e]:t}).eq("game_id",r);if(s.error)throw console.log(s.error),new Error("update failed");if(s.data)return s.data},Ka=async({table:n,data:e})=>{const t=await Fe.from(n).insert(e);if(t.error)throw console.log(t.error),new Error("insert failed");if(t.data)return t.data},Xa=async({table:n,data:e})=>{const t=await Fe.from(n).upsert(e);if(t.error)throw console.log(t.error),new Error("upsert failed");if(t.data)return t.data};function xn(n,e,t){const r=n.slice();r[8]=e[t].id,r[9]=e[t].question,r[10]=e[t].category,r[12]=e,r[13]=t;const s=r[10]==="standard";return r[11]=s,r}function Qa(n){let e,t,r,s,i;return{c(){e=y("p"),t=y("button"),r=O("How to Play")},l(o){e=b(o,"P",{});var a=T(e);t=b(a,"BUTTON",{});var l=T(t);r=j(l,"How to Play"),l.forEach(d),a.forEach(d)},m(o,a){P(o,e,a),m(e,t),m(t,r),s||(i=ce(t,"click",n[6]),s=!0)},p:q,d(o){o&&d(e),s=!1,i()}}}function Za(n){let e,t,r,s;function i(l,u){return l[2]?tl:el}let o=i(n),a=o(n);return{c(){e=y("p"),t=O("Tell us about yourself:"),r=C(),a.c(),s=ae()},l(l){e=b(l,"P",{});var u=T(e);t=j(u,"Tell us about yourself:"),u.forEach(d),r=N(l),a.l(l),s=ae()},m(l,u){P(l,e,u),m(e,t),P(l,r,u),a.m(l,u),P(l,s,u)},p(l,u){o===(o=i(l))&&a?a.p(l,u):(a.d(1),a=o(l),a&&(a.c(),a.m(s.parentNode,s)))},d(l){l&&d(e),l&&d(r),a.d(l),l&&d(s)}}}function el(n){let e,t,r,s,i,o,a=n[1],l=[];for(let u=0;u<a.length;u+=1)l[u]=Un(xn(n,a,u));return{c(){e=y("form");for(let u=0;u<l.length;u+=1)l[u].c();t=C(),r=y("button"),s=O("Submit"),this.h()},l(u){e=b(u,"FORM",{});var h=T(e);for(let f=0;f<l.length;f+=1)l[f].l(h);t=N(h),r=b(h,"BUTTON",{type:!0});var c=T(r);s=j(c,"Submit"),c.forEach(d),h.forEach(d),this.h()},h(){S(r,"type","submit")},m(u,h){P(u,e,h);for(let c=0;c<l.length;c+=1)l[c].m(e,null);m(e,t),m(e,r),m(r,s),i||(o=ce(e,"submit",ys(n[4])),i=!0)},p(u,h){if(h&2){a=u[1];let c;for(c=0;c<a.length;c+=1){const f=xn(u,a,c);l[c]?l[c].p(f,h):(l[c]=Un(f),l[c].c(),l[c].m(e,t))}for(;c<l.length;c+=1)l[c].d(1);l.length=a.length}},d(u){u&&d(e),nt(l,u),i=!1,o()}}}function tl(n){let e,t;return{c(){e=y("p"),t=O("Error")},l(r){e=b(r,"P",{});var s=T(e);t=j(s,"Error"),s.forEach(d)},m(r,s){P(r,e,s),m(e,t)},p:q,d(r){r&&d(e)}}}function Un(n){let e,t,r=n[9]+"",s,i,o,a,l,u,h,c;function f(){n[5].call(a,n[13])}return{c(){e=y("div"),t=y("label"),s=O(r),o=C(),a=y("input"),this.h()},l(g){e=b(g,"DIV",{});var v=T(e);t=b(v,"LABEL",{for:!0});var _=T(t);s=j(_,r),_.forEach(d),o=N(v),a=b(v,"INPUT",{id:!0,placeholder:!0}),v.forEach(d),this.h()},h(){S(t,"for",i="question-"+n[8]),a.required=l=n[11],S(a,"id",u="question-"+n[8]),S(a,"placeholder","")},m(g,v){P(g,e,v),m(e,t),m(t,s),m(e,o),m(e,a),$t(a,n[1][n[13]].answer),h||(c=ce(a,"input",f),h=!0)},p(g,v){n=g,v&2&&r!==(r=n[9]+"")&&oe(s,r),v&2&&i!==(i="question-"+n[8])&&S(t,"for",i),v&2&&l!==(l=n[11])&&(a.required=l),v&2&&u!==(u="question-"+n[8])&&S(a,"id",u),v&2&&a.value!==n[1][n[13]].answer&&$t(a,n[1][n[13]].answer)},d(g){g&&d(e),h=!1,c()}}}function rl(n){let e,t,r,s,i,o,a;function l(c,f){return c[0]?Qa:Za}let u=l(n),h=u(n);return{c(){e=y("h2"),t=O("Welcome, WOD!"),r=C(),s=y("p"),i=O("Let's play a word game!"),o=C(),h.c(),a=ae(),this.h()},l(c){e=b(c,"H2",{class:!0});var f=T(e);t=j(f,"Welcome, WOD!"),f.forEach(d),r=N(c),s=b(c,"P",{});var g=T(s);i=j(g,"Let's play a word game!"),g.forEach(d),o=N(c),h.l(c),a=ae(),this.h()},h(){S(e,"class","svelte-1uepkdw")},m(c,f){P(c,e,f),m(e,t),P(c,r,f),P(c,s,f),m(s,i),P(c,o,f),h.m(c,f),P(c,a,f)},p(c,[f]){u===(u=l(c))&&h?h.p(c,f):(h.d(1),h=u(c),h&&(h.c(),h.m(a.parentNode,a)))},i:q,o:q,d(c){c&&d(e),c&&d(r),c&&d(s),c&&d(o),h.d(c),c&&d(a)}}}function nl(n,e,t){let r,s;L(n,xt,c=>t(7,r=c)),L(n,ye,c=>t(3,s=c));let{wodReady:i}=e,o=[],a;const l=async()=>{console.log("submit");try{const c=o.map(f=>({game_id:r,question_id:f.id,answer:f.answer}));await Xa({table:"wordgame_wod-info",data:c}),t(0,i=!0),console.log({wodReady:i})}catch(c){console.log(c)}};yt(async()=>{console.log("mount");try{t(1,o=await Ya(r))}catch{t(2,a=!0)}});function u(c){o[c].answer=this.value,t(1,o)}const h=()=>{ve(ye,s="rules",s)};return n.$$set=c=>{"wodReady"in c&&t(0,i=c.wodReady)},n.$$.update=()=>{n.$$.dirty&1&&console.log({wodReady:i})},[i,o,a,s,l,u,h]}class sl extends Z{constructor(e){super(),ee(this,e,nl,rl,te,{wodReady:0})}}function il(n){let e,t;return{c(){e=y("p"),t=O(n[1])},l(r){e=b(r,"P",{});var s=T(e);t=j(s,n[1]),s.forEach(d)},m(r,s){P(r,e,s),m(e,t)},p(r,s){s&2&&oe(t,r[1])},d(r){r&&d(e)}}}function ol(n){let e,t;return{c(){e=y("p"),t=O("Submitting responses...")},l(r){e=b(r,"P",{});var s=T(e);t=j(s,"Submitting responses..."),s.forEach(d)},m(r,s){P(r,e,s),m(e,t)},p:q,d(r){r&&d(e)}}}function al(n){let e,t,r,s;function i(l,u){return l[0]===void 0?ol:il}let o=i(n),a=o(n);return{c(){e=y("h2"),t=O("Thanks for playing!"),r=C(),a.c(),s=ae()},l(l){e=b(l,"H2",{});var u=T(e);t=j(u,"Thanks for playing!"),u.forEach(d),r=N(l),a.l(l),s=ae()},m(l,u){P(l,e,u),m(e,t),P(l,r,u),a.m(l,u),P(l,s,u)},p(l,[u]){o===(o=i(l))&&a?a.p(l,u):(a.d(1),a=o(l),a&&(a.c(),a.m(s.parentNode,s)))},i:q,o:q,d(l){l&&d(e),l&&d(r),a.d(l),l&&d(s)}}}function ll(n,e,t){let r,s,i;L(n,xt,a=>t(2,s=a)),L(n,Te,a=>t(3,i=a));let o;return yt(async()=>{try{const l=[].concat(...i.user).filter(h=>h.valid).map(h=>({game_id:s,round:h.round,text:h.text,timestamp:h.timestamp,points:h.points,lemmas:h.lemmas}));(await Ka({table:"wordgame_wod-answers",data:l})).length?(t(0,o=!0),await ls({table:"wordgame_games",column:"wod_finished",value:!0,gameId:s})):t(0,o=!1)}catch{t(0,o=!1)}}),n.$$.update=()=>{n.$$.dirty&1&&t(1,r=o?"Game successfully submitted!":"There was an error submitting your game. Please contact admins.")},[o,r]}class ul extends Z{constructor(e){super(),ee(this,e,ll,al,te,{})}}const cl=async n=>{if("clipboard"in navigator)await navigator.clipboard.writeText(n);else{const e=document.createElement("input");e.type="text",e.disabled=!0,e.style.setProperty("position","fixed"),e.style.setProperty("z-index","-100"),e.style.setProperty("pointer-events","none"),e.style.setProperty("opacity","0"),e.value=n,document.body.appendChild(e),e.click(),e.select(),document.execCommand("copy"),document.body.removeChild(e)}},hl=(n,e)=>{async function t(){if(e)try{await cl(e),n.dispatchEvent(new CustomEvent("svelte-copy",{detail:e}))}catch(r){n.dispatchEvent(new CustomEvent("svelte-copy:error",{detail:r}))}}return n.addEventListener("click",t,!0),{update:r=>e=r,destroy:()=>n.removeEventListener("click",t,!0)}};function dl(n){let e,t,r,s,i,o,a,l,u,h,c,f,g;return{c(){e=y("p"),t=O("Use the copy button below, then "),r=y("a"),s=O("click here"),i=O(" to give us feedback!"),o=C(),a=y("textarea"),l=C(),u=y("button"),h=O("Copy to clipboard"),this.h()},l(v){e=b(v,"P",{class:!0});var _=T(e);t=j(_,"Use the copy button below, then "),r=b(_,"A",{href:!0,target:!0});var E=T(r);s=j(E,"click here"),E.forEach(d),i=j(_," to give us feedback!"),_.forEach(d),o=N(v),a=b(v,"TEXTAREA",{style:!0,class:!0}),T(a).forEach(d),l=N(v),u=b(v,"BUTTON",{});var k=T(u);h=j(k,"Copy to clipboard"),k.forEach(d),this.h()},h(){S(r,"href","https://forms.gle/P8npksT5XLE6tFWT8"),S(r,"target","_blank"),S(e,"class","svelte-bkfopd"),bs(a,"width","100%"),a.value=n[0],S(a,"class","svelte-bkfopd")},m(v,_){P(v,e,_),m(e,t),m(e,r),m(r,s),m(e,i),P(v,o,_),P(v,a,_),P(v,l,_),P(v,u,_),m(u,h),f||(g=ks(c=hl.call(null,u,n[0])),f=!0)},p(v,[_]){_&1&&(a.value=v[0]),c&&Es(c.update)&&_&1&&c.update.call(null,v[0])},i:q,o:q,d(v){v&&d(e),v&&d(o),v&&d(a),v&&d(l),v&&d(u),f=!1,g()}}}function fl(n,e,t){let r,s;return L(n,Te,i=>t(1,s=i)),n.$$.update=()=>{n.$$.dirty&2&&t(0,r=JSON.stringify([].concat(...s.user)))},[r,s]}class pl extends Z{constructor(e){super(),ee(this,e,fl,dl,te,{})}}function Dn(n){let e,t,r,s;const i=[vl,ml],o=[];function a(l,u){return l[3]?0:1}return e=a(n),t=o[e]=i[e](n),{c(){t.c(),r=ae()},l(l){t.l(l),r=ae()},m(l,u){o[e].m(l,u),P(l,r,u),s=!0},p(l,u){let h=e;e=a(l),e===h?o[e].p(l,u):(_e(),F(o[h],1,1,()=>{o[h]=null}),we(),t=o[e],t?t.p(l,u):(t=o[e]=i[e](l),t.c()),x(t,1),t.m(r.parentNode,r))},i(l){s||(x(t),s=!0)},o(l){F(t),s=!1},d(l){o[e].d(l),l&&d(r)}}}function ml(n){let e,t;return e=new uo({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},p:q,i(r){t||(x(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function vl(n){let e,t,r;function s(o){n[10](o)}let i={};return n[1]!==void 0&&(i.wodReady=n[1]),e=new sl({props:i}),Vn.push(()=>Ts(e,"wodReady",s)),{c(){re(e.$$.fragment)},l(o){ne(e.$$.fragment,o)},m(o,a){se(e,o,a),r=!0},p(o,a){const l={};!t&&a&2&&(t=!0,l.wodReady=o[1],Ss(()=>t=!1)),e.$set(l)},i(o){r||(x(e.$$.fragment,o),r=!0)},o(o){F(e.$$.fragment,o),r=!1},d(o){ie(e,o)}}}function Mn(n){let e,t;return e=new io({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},i(r){t||(x(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function Bn(n){let e,t,r,s;const i=[_l,gl],o=[];function a(l,u){return l[3]?0:1}return e=a(n),t=o[e]=i[e](n),{c(){t.c(),r=ae()},l(l){t.l(l),r=ae()},m(l,u){o[e].m(l,u),P(l,r,u),s=!0},p(l,u){let h=e;e=a(l),e!==h&&(_e(),F(o[h],1,1,()=>{o[h]=null}),we(),t=o[e],t||(t=o[e]=i[e](l),t.c()),x(t,1),t.m(r.parentNode,r))},i(l){s||(x(t),s=!0)},o(l){F(t),s=!1},d(l){o[e].d(l),l&&d(r)}}}function gl(n){let e,t;return e=new pl({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},i(r){t||(x(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function _l(n){let e,t;return e=new ul({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},i(r){t||(x(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function Ln(n){let e;function t(i,o){return i[0]?yl:wl}let r=t(n),s=r(n);return{c(){e=y("p"),s.c(),this.h()},l(i){e=b(i,"P",{class:!0});var o=T(e);s.l(o),o.forEach(d),this.h()},h(){S(e,"class","svelte-17qdobc")},m(i,o){P(i,e,o),s.m(e,null)},p(i,o){r===(r=t(i))&&s?s.p(i,o):(s.d(1),s=r(i),s&&(s.c(),s.m(e,null)))},d(i){i&&d(e),s.d()}}}function wl(n){let e,t;return{c(){e=y("span"),t=O("loading...")},l(r){e=b(r,"SPAN",{});var s=T(e);t=j(s,"loading..."),s.forEach(d)},m(r,s){P(r,e,s),m(e,t)},p:q,d(r){r&&d(e)}}}function yl(n){let e,t,r,s;return{c(){e=y("button"),t=O(n[2])},l(i){e=b(i,"BUTTON",{});var o=T(e);t=j(o,n[2]),o.forEach(d)},m(i,o){P(i,e,o),m(e,t),r||(s=ce(e,"click",n[7]),r=!0)},p(i,o){o&4&&oe(t,i[2])},d(i){i&&d(e),r=!1,s()}}}function zn(n){let e,t;return e=new Ji({}),e.$on("end",n[8]),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},p:q,i(r){t||(x(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function bl(n){let e,t,r,s,i,o,a=n[4]==="pre"&&Dn(n),l=n[4]!=="pre"&&Mn(),u=n[4]==="post"&&Bn(n),h=n[6]&&Ln(n),c=n[5]&&zn(n);return{c(){a&&a.c(),e=C(),l&&l.c(),t=C(),u&&u.c(),r=C(),h&&h.c(),s=C(),c&&c.c(),i=ae()},l(f){a&&a.l(f),e=N(f),l&&l.l(f),t=N(f),u&&u.l(f),r=N(f),h&&h.l(f),s=N(f),c&&c.l(f),i=ae()},m(f,g){a&&a.m(f,g),P(f,e,g),l&&l.m(f,g),P(f,t,g),u&&u.m(f,g),P(f,r,g),h&&h.m(f,g),P(f,s,g),c&&c.m(f,g),P(f,i,g),o=!0},p(f,[g]){f[4]==="pre"?a?(a.p(f,g),g&16&&x(a,1)):(a=Dn(f),a.c(),x(a,1),a.m(e.parentNode,e)):a&&(_e(),F(a,1,1,()=>{a=null}),we()),f[4]!=="pre"?l?g&16&&x(l,1):(l=Mn(),l.c(),x(l,1),l.m(t.parentNode,t)):l&&(_e(),F(l,1,1,()=>{l=null}),we()),f[4]==="post"?u?(u.p(f,g),g&16&&x(u,1)):(u=Bn(f),u.c(),x(u,1),u.m(r.parentNode,r)):u&&(_e(),F(u,1,1,()=>{u=null}),we()),f[6]?h?h.p(f,g):(h=Ln(f),h.c(),h.m(s.parentNode,s)):h&&(h.d(1),h=null),f[5]?c?(c.p(f,g),g&32&&x(c,1)):(c=zn(f),c.c(),x(c,1),c.m(i.parentNode,i)):c&&(_e(),F(c,1,1,()=>{c=null}),we())},i(f){o||(x(a),x(l),x(u),x(c),o=!0)},o(f){F(a),F(l),F(u),F(c),o=!1},d(f){a&&a.d(f),f&&d(e),l&&l.d(f),f&&d(t),u&&u.d(f),f&&d(r),h&&h.d(f),f&&d(s),c&&c.d(f),f&&d(i)}}}function kl(n,e,t){let r,s,i,o,a,l,u,h;L(n,ze,$=>t(3,o=$)),L(n,Sr,$=>t(4,a=$)),L(n,Ee,$=>t(11,l=$)),L(n,tt,$=>t(12,u=$)),L(n,xt,$=>t(13,h=$));let{loaded:c}=e,f=!1,g;const v={pre:"Begin game",mid:"Next round"},_=()=>{o&&ls({table:"wordgame_games",column:"wod_started",value:!0,gameId:h}),t(5,f=!0)},E=()=>{ve(tt,u=!0,u),ve(Ee,l+=1,l),t(5,f=!1)};function k($){g=$,t(1,g)}return n.$$set=$=>{"loaded"in $&&t(0,c=$.loaded)},n.$$.update=()=>{n.$$.dirty&16&&t(2,r=v[a]),n.$$.dirty&26&&t(9,s=o&&a==="pre"&&!g),n.$$.dirty&524&&t(6,i=r&&(!o||!s))},[c,g,r,o,a,f,i,_,E,s,k]}class El extends Z{constructor(e){super(),ee(this,e,kl,bl,te,{loaded:0})}}async function Tl(n){const e=`https://pudding.cool/projects/word-game-data/game-clues/${n}.csv?version=${Date.now()}`,r=(await Ut(e)).map(s=>dt(xe({},s),{round:+s.round}));return r.sort((s,i)=>$s(s.round,i.round)),r}async function Sl(n){const e=[];for(let t of n){const r=`https://pudding.cool/projects/word-game-data/clue-answers/${t}.csv?version=${Date.now()}`,i=(await Ut(r)).map(o=>dt(xe({},o),{points:+o.points}));e.push(i)}return e}async function Ol(n){return await(await fetch(n)).json()}function Fn(n){let e,t;return e=new ti({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},i(r){t||(x(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function Gn(n){let e,t,r;return t=new Hi({props:{clues:n[0],answers:n[1]}}),{c(){e=y("section"),re(t.$$.fragment),this.h()},l(s){e=b(s,"SECTION",{id:!0,class:!0});var i=T(e);ne(t.$$.fragment,i),i.forEach(d),this.h()},h(){S(e,"id","play"),S(e,"class","svelte-16azlq0")},m(s,i){P(s,e,i),se(t,e,null),r=!0},p(s,i){const o={};i&1&&(o.clues=s[0]),i&2&&(o.answers=s[1]),t.$set(o)},i(s){r||(x(t.$$.fragment,s),r=!0)},o(s){F(t.$$.fragment,s),r=!1},d(s){s&&d(e),ie(t)}}}function Hn(n){let e,t,r;return t=new El({props:{loaded:n[2]}}),{c(){e=y("section"),re(t.$$.fragment),this.h()},l(s){e=b(s,"SECTION",{id:!0,class:!0});var i=T(e);ne(t.$$.fragment,i),i.forEach(d),this.h()},h(){S(e,"id","modal"),S(e,"class","svelte-16azlq0")},m(s,i){P(s,e,i),se(t,e,null),r=!0},p(s,i){const o={};i&4&&(o.loaded=s[2]),t.$set(o)},i(s){r||(x(t.$$.fragment,s),r=!0)},o(s){F(t.$$.fragment,s),r=!1},d(s){s&&d(e),ie(t)}}}function jl(n){let e,t,r,s,i=n[5]&&Fn(),o=n[4]&&Gn(n),a=n[3]&&Hn(n);return{c(){i&&i.c(),e=C(),o&&o.c(),t=C(),a&&a.c(),r=ae()},l(l){i&&i.l(l),e=N(l),o&&o.l(l),t=N(l),a&&a.l(l),r=ae()},m(l,u){i&&i.m(l,u),P(l,e,u),o&&o.m(l,u),P(l,t,u),a&&a.m(l,u),P(l,r,u),s=!0},p(l,[u]){l[5]?i?u&32&&x(i,1):(i=Fn(),i.c(),x(i,1),i.m(e.parentNode,e)):i&&(_e(),F(i,1,1,()=>{i=null}),we()),l[4]?o?(o.p(l,u),u&16&&x(o,1)):(o=Gn(l),o.c(),x(o,1),o.m(t.parentNode,t)):o&&(_e(),F(o,1,1,()=>{o=null}),we()),l[3]?a?(a.p(l,u),u&8&&x(a,1)):(a=Hn(l),a.c(),x(a,1),a.m(r.parentNode,r)):a&&(_e(),F(a,1,1,()=>{a=null}),we())},i(l){s||(x(i),x(o),x(a),s=!0)},o(l){F(i),F(o),F(a),s=!1},d(l){i&&i.d(l),l&&d(e),o&&o.d(l),l&&d(t),a&&a.d(l),l&&d(r)}}}function Pl(n,e,t){let r,s,i,o,a,l,u;L(n,It,v=>t(5,i=v)),L(n,xt,v=>t(8,o=v)),L(n,ze,v=>t(9,a=v)),L(n,Sr,v=>t(6,l=v)),L(n,tt,v=>t(7,u=v));let h,c,f;const g=async()=>{if(a)return o;const _=`https://pudding.cool/projects/word-game-data/games.json?version=${Date.now()}`,{updated:E,games:k}=await Ol(_);console.log("updated:",E);const{id:$}=k.find(U=>U.live);return $};return yt(async()=>{ve(It,i=await g(),i);const v=await Tl(i);t(0,h=v.map(_=>_.clue)),t(1,c=await Sl(v.map(_=>_.clueId))),t(2,f=!0)}),n.$$.update=()=>{n.$$.dirty&192&&t(4,r=l==="mid"&&u),n.$$.dirty&192&&t(3,s=!u||["pre","post"].includes(l))},[h,c,f,s,r,i,l,u]}class $l extends Z{constructor(e){super(),ee(this,e,Pl,jl,te,{})}}function Rl(n){let e,t,r,s,i,o,a,l,u,h,c,f,g,v,_,E,k,$,U,W,M,R,z,D,J,Y,I,H,B,p,w,A,K,V,G,ge,he,Se,Ge,He,$e,st,Lt,zt,Ft,qe,it,Gt,Ht,qt,ot,Wt,Jt,be,at,Vt,Yt,lt,Kt,Xt,ut,Qt,Zt,ct,er,tr,ht,We,rr,nr,Ar;return{c(){e=y("section"),t=y("div"),r=y("h3"),s=O("How to Play"),i=C(),o=y("ul"),a=y("li"),l=y("strong"),u=O("Goal:"),h=O(" score more points than the Word Opponent of the Day (WOD)."),c=C(),f=y("li"),g=y("strong"),v=O("Duration:"),_=O(" Four one-minute rounds."),E=C(),k=y("li"),$=y("strong"),U=O("Gameplay:"),W=O(` Enter as many words as possible that satisfy a clue.
        `),M=y("ul"),R=y("li"),z=y("strong"),D=O("Sample clue"),J=O(": "),Y=y("em"),I=O("words that start with "),H=y("strong"),B=O("A"),p=O(`
            . Answers: `),w=y("em"),A=O("apple"),K=O(", "),V=y("em"),G=O("awesome"),ge=O(", "),he=y("em"),Se=O("activate"),Ge=O(", etc."),He=C(),$e=y("li"),st=y("strong"),Lt=O("Blocking!"),zt=O(` Whoever gets a word first gets points. If the WOD entered the
            word before you, you get no points. If you enter a word before the WOD, she gets no points.`),Ft=C(),qe=y("li"),it=y("strong"),Gt=O("The more obscure the better!"),Ht=O(` You get more points for less commonly used
            words.`),qt=C(),ot=y("h3"),Wt=O("Rules"),Jt=C(),be=y("ul"),at=y("li"),Vt=O("4+ letter words"),Yt=C(),lt=y("li"),Kt=O("No proper nouns"),Xt=C(),ut=y("li"),Qt=O("No hyphenated words"),Zt=C(),ct=y("li"),er=O("No variations (e.g. plurals) of a played word"),tr=C(),ht=y("p"),We=y("button"),rr=O("CLOSE"),this.h()},l(Ne){e=b(Ne,"SECTION",{class:!0});var Je=T(e);t=b(Je,"DIV",{class:!0});var Oe=T(t);r=b(Oe,"H3",{});var Ir=T(r);s=j(Ir,"How to Play"),Ir.forEach(d),i=N(Oe),o=b(Oe,"UL",{});var Ve=T(o);a=b(Ve,"LI",{});var sr=T(a);l=b(sr,"STRONG",{});var Cr=T(l);u=j(Cr,"Goal:"),Cr.forEach(d),h=j(sr," score more points than the Word Opponent of the Day (WOD)."),sr.forEach(d),c=N(Ve),f=b(Ve,"LI",{});var ir=T(f);g=b(ir,"STRONG",{});var Nr=T(g);v=j(Nr,"Duration:"),Nr.forEach(d),_=j(ir," Four one-minute rounds."),ir.forEach(d),E=N(Ve),k=b(Ve,"LI",{});var Et=T(k);$=b(Et,"STRONG",{});var xr=T($);U=j(xr,"Gameplay:"),xr.forEach(d),W=j(Et,` Enter as many words as possible that satisfy a clue.
        `),M=b(Et,"UL",{});var Ye=T(M);R=b(Ye,"LI",{});var ke=T(R);z=b(ke,"STRONG",{});var Ur=T(z);D=j(Ur,"Sample clue"),Ur.forEach(d),J=j(ke,": "),Y=b(ke,"EM",{});var or=T(Y);I=j(or,"words that start with "),H=b(or,"STRONG",{});var Dr=T(H);B=j(Dr,"A"),Dr.forEach(d),or.forEach(d),p=j(ke,`
            . Answers: `),w=b(ke,"EM",{});var Mr=T(w);A=j(Mr,"apple"),Mr.forEach(d),K=j(ke,", "),V=b(ke,"EM",{});var Br=T(V);G=j(Br,"awesome"),Br.forEach(d),ge=j(ke,", "),he=b(ke,"EM",{});var Lr=T(he);Se=j(Lr,"activate"),Lr.forEach(d),Ge=j(ke,", etc."),ke.forEach(d),He=N(Ye),$e=b(Ye,"LI",{});var ar=T($e);st=b(ar,"STRONG",{});var zr=T(st);Lt=j(zr,"Blocking!"),zr.forEach(d),zt=j(ar,` Whoever gets a word first gets points. If the WOD entered the
            word before you, you get no points. If you enter a word before the WOD, she gets no points.`),ar.forEach(d),Ft=N(Ye),qe=b(Ye,"LI",{});var lr=T(qe);it=b(lr,"STRONG",{});var Fr=T(it);Gt=j(Fr,"The more obscure the better!"),Fr.forEach(d),Ht=j(lr,` You get more points for less commonly used
            words.`),lr.forEach(d),Ye.forEach(d),Et.forEach(d),Ve.forEach(d),qt=N(Oe),ot=b(Oe,"H3",{});var Gr=T(ot);Wt=j(Gr,"Rules"),Gr.forEach(d),Jt=N(Oe),be=b(Oe,"UL",{});var Ae=T(be);at=b(Ae,"LI",{});var Hr=T(at);Vt=j(Hr,"4+ letter words"),Hr.forEach(d),Yt=N(Ae),lt=b(Ae,"LI",{});var qr=T(lt);Kt=j(qr,"No proper nouns"),qr.forEach(d),Xt=N(Ae),ut=b(Ae,"LI",{});var Wr=T(ut);Qt=j(Wr,"No hyphenated words"),Wr.forEach(d),Zt=N(Ae),ct=b(Ae,"LI",{});var Jr=T(ct);er=j(Jr,"No variations (e.g. plurals) of a played word"),Jr.forEach(d),Ae.forEach(d),tr=N(Oe),ht=b(Oe,"P",{});var Vr=T(ht);We=b(Vr,"BUTTON",{});var Yr=T(We);rr=j(Yr,"CLOSE"),Yr.forEach(d),Vr.forEach(d),Oe.forEach(d),Je.forEach(d),this.h()},h(){S(t,"class","svelte-5rby5g"),S(e,"class","svelte-5rby5g"),me(e,"visible",n[0]==="rules")},m(Ne,Je){P(Ne,e,Je),m(e,t),m(t,r),m(r,s),m(t,i),m(t,o),m(o,a),m(a,l),m(l,u),m(a,h),m(o,c),m(o,f),m(f,g),m(g,v),m(f,_),m(o,E),m(o,k),m(k,$),m($,U),m(k,W),m(k,M),m(M,R),m(R,z),m(z,D),m(R,J),m(R,Y),m(Y,I),m(Y,H),m(H,B),m(R,p),m(R,w),m(w,A),m(R,K),m(R,V),m(V,G),m(R,ge),m(R,he),m(he,Se),m(R,Ge),m(M,He),m(M,$e),m($e,st),m(st,Lt),m($e,zt),m(M,Ft),m(M,qe),m(qe,it),m(it,Gt),m(qe,Ht),m(t,qt),m(t,ot),m(ot,Wt),m(t,Jt),m(t,be),m(be,at),m(at,Vt),m(be,Yt),m(be,lt),m(lt,Kt),m(be,Xt),m(be,ut),m(ut,Qt),m(be,Zt),m(be,ct),m(ct,er),m(t,tr),m(t,ht),m(ht,We),m(We,rr),nr||(Ar=[ce(We,"click",n[1]),ce(e,"click",n[1])],nr=!0)},p(Ne,[Je]){Je&1&&me(e,"visible",Ne[0]==="rules")},i:q,o:q,d(Ne){Ne&&d(e),nr=!1,wt(Ar)}}}function Al(n,e,t){let r;return L(n,ye,i=>t(0,r=i)),[r,()=>{ve(ye,r=void 0,r)}]}class Il extends Z{constructor(e){super(),ee(this,e,Al,Rl,te,{})}}function Cl(n){let e,t,r,s,i,o,a,l,u,h,c,f,g,v;return{c(){e=y("section"),t=y("div"),r=y("h3"),s=O("About"),i=C(),o=y("p"),a=C(),l=y("p"),u=C(),h=y("p"),c=y("button"),f=O("CLOSE"),this.h()},l(_){e=b(_,"SECTION",{class:!0});var E=T(e);t=b(E,"DIV",{class:!0});var k=T(t);r=b(k,"H3",{});var $=T(r);s=j($,"About"),$.forEach(d),i=N(k),o=b(k,"P",{});var U=T(o);U.forEach(d),a=N(k),l=b(k,"P",{});var W=T(l);W.forEach(d),u=N(k),h=b(k,"P",{});var M=T(h);c=b(M,"BUTTON",{});var R=T(c);f=j(R,"CLOSE"),R.forEach(d),M.forEach(d),k.forEach(d),E.forEach(d),this.h()},h(){S(t,"class","svelte-5rby5g"),S(e,"class","svelte-5rby5g"),me(e,"visible",n[0]==="about")},m(_,E){P(_,e,E),m(e,t),m(t,r),m(r,s),m(t,i),m(t,o),o.innerHTML=n[1],m(t,a),m(t,l),l.innerHTML=n[2],m(t,u),m(t,h),m(h,c),m(c,f),g||(v=[ce(c,"click",n[3]),ce(e,"click",n[3])],g=!0)},p(_,[E]){E&1&&me(e,"visible",_[0]==="about")},i:q,o:q,d(_){_&&d(e),g=!1,wt(v)}}}function Nl(n,e,t){let r;L(n,ye,a=>t(0,r=a));const{byline:s,source:i}=Os("copy");return[r,s,i,()=>{ve(ye,r=void 0,r)}]}class xl extends Z{constructor(e){super(),ee(this,e,Nl,Cl,te,{})}}function Ul(n){let e,t,r,s,i,o,a,l;return e=new Qs({}),r=new $l({}),i=new Il({}),a=new xl({}),{c(){re(e.$$.fragment),t=C(),re(r.$$.fragment),s=C(),re(i.$$.fragment),o=C(),re(a.$$.fragment)},l(u){ne(e.$$.fragment,u),t=N(u),ne(r.$$.fragment,u),s=N(u),ne(i.$$.fragment,u),o=N(u),ne(a.$$.fragment,u)},m(u,h){se(e,u,h),P(u,t,h),se(r,u,h),P(u,s,h),se(i,u,h),P(u,o,h),se(a,u,h),l=!0},p:q,i(u){l||(x(e.$$.fragment,u),x(r.$$.fragment,u),x(i.$$.fragment,u),x(a.$$.fragment,u),l=!0)},o(u){F(e.$$.fragment,u),F(r.$$.fragment,u),F(i.$$.fragment,u),F(a.$$.fragment,u),l=!1},d(u){ie(e,u),u&&d(t),ie(r,u),u&&d(s),ie(i,u),u&&d(o),ie(a,u)}}}class Gl extends Z{constructor(e){super(),ee(this,e,null,Ul,te,{})}}export{Gl as A,Ll as M,ze as a,Fl as g,zl as s,xt as w};

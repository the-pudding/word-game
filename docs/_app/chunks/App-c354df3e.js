var cs=Object.defineProperty,hs=Object.defineProperties;var fs=Object.getOwnPropertyDescriptors;var Xr=Object.getOwnPropertySymbols;var ds=Object.prototype.hasOwnProperty,ps=Object.prototype.propertyIsEnumerable;var Qr=(n,e,t)=>e in n?cs(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ne=(n,e)=>{for(var t in e||(e={}))ds.call(e,t)&&Qr(n,t,e[t]);if(Xr)for(var t of Xr(e))ps.call(e,t)&&Qr(n,t,e[t]);return n},ut=(n,e)=>hs(n,fs(e));import{S as Z,i as ee,s as te,e as w,c as y,b as S,g as $,d,l as ae,N as ms,M as v,E as q,O as et,t as O,k as N,a as T,h as j,m as U,P as ce,G as _t,Q as x,R as ve,v as gt,C as Zr,T as vs,U as _s,V as Jn,j as oe,W as gs,X as me,q as M,n as _e,o as G,p as ge,w as re,x as ne,y as se,B as ie,Y as ws,Z as ys,_ as Er,$ as Wn,a0 as Vn,a1 as Ot,a2 as Yn,a3 as bs,f as ks,a4 as Es,H as Ts,a5 as Ss,a6 as Os}from"./index-5fe9b45c.js";import{d as At,w as $e}from"./index-0e2bbb5e.js";function en(n,e,t){const r=n.slice();return r[5]=e[t],r}function tn(n){let e,t;return{c(){e=w("link"),this.h()},l(r){e=y(r,"LINK",{rel:!0,href:!0,as:!0,type:!0,crossorigin:!0}),this.h()},h(){S(e,"rel","preload"),S(e,"href",t=n[5]),S(e,"as","font"),S(e,"type","font/woff2"),S(e,"crossorigin","")},m(r,s){$(r,e,s)},p(r,s){s&16&&t!==(t=r[5])&&S(e,"href",t)},d(r){r&&d(e)}}}function js(n){let e,t,r,s,i,o,a,l,u,h,c,p,_,m,g,k,E,R,L,W,B,A,F,D,J,K;document.title=e=n[0];let I=n[4],z=[];for(let P=0;P<I.length;P+=1)z[P]=tn(en(n,I,P));return{c(){t=w("meta"),r=w("meta"),s=w("meta"),i=w("meta"),o=w("meta"),a=w("meta"),l=w("meta"),u=w("meta"),h=w("meta"),c=w("meta"),_=w("meta"),m=w("meta"),g=w("meta"),k=w("meta"),E=w("meta"),R=w("meta"),L=w("meta"),W=w("meta"),B=w("meta"),F=w("meta"),D=w("link");for(let P=0;P<z.length;P+=1)z[P].c();K=ae(),this.h()},l(P){const f=ms('[data-svelte="svelte-1ad9fm2"]',document.head);t=y(f,"META",{name:!0,content:!0}),r=y(f,"META",{name:!0,content:!0}),s=y(f,"META",{name:!0,content:!0}),i=y(f,"META",{property:!0,content:!0}),o=y(f,"META",{property:!0,content:!0}),a=y(f,"META",{property:!0,content:!0}),l=y(f,"META",{property:!0,content:!0}),u=y(f,"META",{property:!0,content:!0}),h=y(f,"META",{property:!0,content:!0}),c=y(f,"META",{property:!0,content:!0}),_=y(f,"META",{property:!0,content:!0}),m=y(f,"META",{property:!0,content:!0}),g=y(f,"META",{property:!0,content:!0}),k=y(f,"META",{name:!0,content:!0}),E=y(f,"META",{name:!0,content:!0}),R=y(f,"META",{name:!0,content:!0}),L=y(f,"META",{name:!0,content:!0}),W=y(f,"META",{name:!0,content:!0}),B=y(f,"META",{name:!0,content:!0}),F=y(f,"META",{name:!0,content:!0}),D=y(f,"LINK",{rel:!0,href:!0});for(let b=0;b<z.length;b+=1)z[b].l(f);K=ae(),f.forEach(d),this.h()},h(){S(t,"name","description"),S(t,"content",n[1]),S(r,"name","author"),S(r,"content","The Pudding"),S(s,"name","news_keywords"),S(s,"content",n[3]),S(i,"property","og:title"),S(i,"content",n[0]),S(o,"property","og:site_name"),S(o,"content","The Pudding"),S(a,"property","og:url"),S(a,"content",n[2]),S(l,"property","og:description"),S(l,"content",n[1]),S(u,"property","og:type"),S(u,"content","article"),S(h,"property","og:locale"),S(h,"content","en_US"),S(c,"property","og:image"),S(c,"content",p=n[2]+"/assets/social-facebook.jpg"),S(_,"property","og:image:type"),S(_,"content","image/jpeg"),S(m,"property","og:image:width"),S(m,"content","1200"),S(g,"property","og:image:height"),S(g,"content","600"),S(k,"name","twitter:card"),S(k,"content","summary_large_image"),S(E,"name","twitter:site"),S(E,"content","https://pudding.cool"),S(R,"name","twitter:creator"),S(R,"content","@puddingviz"),S(L,"name","twitter:title"),S(L,"content",n[0]),S(W,"name","twitter:description"),S(W,"content",n[1]),S(B,"name","twitter:image:src"),S(B,"content",A=n[2]+"/assets/social-twitter.jpg"),S(F,"name","robots"),S(F,"content","max-image-preview:large"),S(D,"rel","canonical"),S(D,"href",J=n[2]+"/")},m(P,f){v(document.head,t),v(document.head,r),v(document.head,s),v(document.head,i),v(document.head,o),v(document.head,a),v(document.head,l),v(document.head,u),v(document.head,h),v(document.head,c),v(document.head,_),v(document.head,m),v(document.head,g),v(document.head,k),v(document.head,E),v(document.head,R),v(document.head,L),v(document.head,W),v(document.head,B),v(document.head,F),v(document.head,D);for(let b=0;b<z.length;b+=1)z[b].m(document.head,null);v(document.head,K)},p(P,[f]){if(f&1&&e!==(e=P[0])&&(document.title=e),f&2&&S(t,"content",P[1]),f&8&&S(s,"content",P[3]),f&1&&S(i,"content",P[0]),f&4&&S(a,"content",P[2]),f&2&&S(l,"content",P[1]),f&4&&p!==(p=P[2]+"/assets/social-facebook.jpg")&&S(c,"content",p),f&1&&S(L,"content",P[0]),f&2&&S(W,"content",P[1]),f&4&&A!==(A=P[2]+"/assets/social-twitter.jpg")&&S(B,"content",A),f&4&&J!==(J=P[2]+"/")&&S(D,"href",J),f&16){I=P[4];let b;for(b=0;b<I.length;b+=1){const C=en(P,I,b);z[b]?z[b].p(C,f):(z[b]=tn(C),z[b].c(),z[b].m(K.parentNode,K))}for(;b<z.length;b+=1)z[b].d(1);z.length=I.length}},i:q,o:q,d(P){d(t),d(r),d(s),d(i),d(o),d(a),d(l),d(u),d(h),d(c),d(_),d(m),d(g),d(k),d(E),d(R),d(L),d(W),d(B),d(F),d(D),et(z,P),d(K)}}}function $s(n,e,t){let{title:r="Title TK"}=e,{description:s="Description TK"}=e,{url:i="https://pudding.cool"}=e,{keywords:o=""}=e,{preloadFont:a=[]}=e;return n.$$set=l=>{"title"in l&&t(0,r=l.title),"description"in l&&t(1,s=l.description),"url"in l&&t(2,i=l.url),"keywords"in l&&t(3,o=l.keywords),"preloadFont"in l&&t(4,a=l.preloadFont)},[r,s,i,o,a]}class Ll extends Z{constructor(e){super(),ee(this,e,$s,js,te,{title:0,description:1,url:2,keywords:3,preloadFont:4})}}function Ps(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function Rs(n,e,t){n=+n,e=+e,t=(s=arguments.length)<2?(e=n,n=0,1):s<3?1:+t;for(var r=-1,s=Math.max(0,Math.ceil((e-n)/t))|0,i=new Array(s);++r<s;)i[r]=n+r*t;return i}var As=Is(Math.random);function Is(n){return function(t,r=0,s=t.length){let i=s-(r=+r);for(;i;){const o=n()*i--|0,a=t[i+r];t[i+r]=t[o+r],t[o+r]=a}return t}}function dr(n,e){let t=0;if(e===void 0)for(let r of n)(r=+r)&&(t+=r);else{let r=-1;for(let s of n)(s=+e(s,++r,n))&&(t+=s)}return t}var rn={},lr={},ur=34,ct=10,cr=13;function Kn(n){return new Function("d","return {"+n.map(function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'}).join(",")+"}")}function Cs(n,e){var t=Kn(n);return function(r,s){return e(t(r),s,n)}}function nn(n){var e=Object.create(null),t=[];return n.forEach(function(r){for(var s in r)s in e||t.push(e[s]=s)}),t}function pe(n,e){var t=n+"",r=t.length;return r<e?new Array(e-r+1).join(0)+t:t}function Ns(n){return n<0?"-"+pe(-n,6):n>9999?"+"+pe(n,6):pe(n,4)}function Us(n){var e=n.getUTCHours(),t=n.getUTCMinutes(),r=n.getUTCSeconds(),s=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":Ns(n.getUTCFullYear())+"-"+pe(n.getUTCMonth()+1,2)+"-"+pe(n.getUTCDate(),2)+(s?"T"+pe(e,2)+":"+pe(t,2)+":"+pe(r,2)+"."+pe(s,3)+"Z":r?"T"+pe(e,2)+":"+pe(t,2)+":"+pe(r,2)+"Z":t||e?"T"+pe(e,2)+":"+pe(t,2)+"Z":"")}function Ds(n){var e=new RegExp('["'+n+`
\r]`),t=n.charCodeAt(0);function r(c,p){var _,m,g=s(c,function(k,E){if(_)return _(k,E-1);m=k,_=p?Cs(k,p):Kn(k)});return g.columns=m||[],g}function s(c,p){var _=[],m=c.length,g=0,k=0,E,R=m<=0,L=!1;c.charCodeAt(m-1)===ct&&--m,c.charCodeAt(m-1)===cr&&--m;function W(){if(R)return lr;if(L)return L=!1,rn;var A,F=g,D;if(c.charCodeAt(F)===ur){for(;g++<m&&c.charCodeAt(g)!==ur||c.charCodeAt(++g)===ur;);return(A=g)>=m?R=!0:(D=c.charCodeAt(g++))===ct?L=!0:D===cr&&(L=!0,c.charCodeAt(g)===ct&&++g),c.slice(F+1,A-1).replace(/""/g,'"')}for(;g<m;){if((D=c.charCodeAt(A=g++))===ct)L=!0;else if(D===cr)L=!0,c.charCodeAt(g)===ct&&++g;else if(D!==t)continue;return c.slice(F,A)}return R=!0,c.slice(F,m)}for(;(E=W())!==lr;){for(var B=[];E!==rn&&E!==lr;)B.push(E),E=W();p&&(B=p(B,k++))==null||_.push(B)}return _}function i(c,p){return c.map(function(_){return p.map(function(m){return h(_[m])}).join(n)})}function o(c,p){return p==null&&(p=nn(c)),[p.map(h).join(n)].concat(i(c,p)).join(`
`)}function a(c,p){return p==null&&(p=nn(c)),i(c,p).join(`
`)}function l(c){return c.map(u).join(`
`)}function u(c){return c.map(h).join(n)}function h(c){return c==null?"":c instanceof Date?Us(c):e.test(c+="")?'"'+c.replace(/"/g,'""')+'"':c}return{parse:r,parseRows:s,format:o,formatBody:a,formatRows:l,formatRow:u,formatValue:h}}var Ms=Ds(","),Bs=Ms.parse;function Ls(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function jt(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,r=n.slice(0,t);return[r.length>1?r[0]+r.slice(2):r,+n.slice(t+1)]}function xs(n){return n=jt(Math.abs(n)),n?n[1]:NaN}function Fs(n,e){return function(t,r){for(var s=t.length,i=[],o=0,a=n[0],l=0;s>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),i.push(t.substring(s-=a,s+a)),!((l+=a+1)>r));)a=n[o=(o+1)%n.length];return i.reverse().join(e)}}function Gs(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var Hs=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pr(n){if(!(e=Hs.exec(n)))throw new Error("invalid format: "+n);var e;return new Tr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}pr.prototype=Tr.prototype;function Tr(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}Tr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function qs(n){e:for(var e=n.length,t=1,r=-1,s;t<e;++t)switch(n[t]){case".":r=s=t;break;case"0":r===0&&(r=t),s=t;break;default:if(!+n[t])break e;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(s+1):n}var Xn;function zs(n,e){var t=jt(n,e);if(!t)return n+"";var r=t[0],s=t[1],i=s-(Xn=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+jt(n,Math.max(0,e+i-1))[0]}function sn(n,e){var t=jt(n,e);if(!t)return n+"";var r=t[0],s=t[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}var on={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:Ls,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>sn(n*100,e),r:sn,s:zs,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function an(n){return n}var ln=Array.prototype.map,un=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Js(n){var e=n.grouping===void 0||n.thousands===void 0?an:Fs(ln.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",s=n.decimal===void 0?".":n.decimal+"",i=n.numerals===void 0?an:Gs(ln.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"\u2212":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function u(c){c=pr(c);var p=c.fill,_=c.align,m=c.sign,g=c.symbol,k=c.zero,E=c.width,R=c.comma,L=c.precision,W=c.trim,B=c.type;B==="n"?(R=!0,B="g"):on[B]||(L===void 0&&(L=12),W=!0,B="g"),(k||p==="0"&&_==="=")&&(k=!0,p="0",_="=");var A=g==="$"?t:g==="#"&&/[boxX]/.test(B)?"0"+B.toLowerCase():"",F=g==="$"?r:/[%p]/.test(B)?o:"",D=on[B],J=/[defgprs%]/.test(B);L=L===void 0?6:/[gprs]/.test(B)?Math.max(1,Math.min(21,L)):Math.max(0,Math.min(20,L));function K(I){var z=A,P=F,f,b,C;if(B==="c")P=D(I)+P,I="";else{I=+I;var Y=I<0||1/I<0;if(I=isNaN(I)?l:D(Math.abs(I),L),W&&(I=qs(I)),Y&&+I==0&&m!=="+"&&(Y=!1),z=(Y?m==="("?m:a:m==="-"||m==="("?"":m)+z,P=(B==="s"?un[8+Xn/3]:"")+P+(Y&&m==="("?")":""),J){for(f=-1,b=I.length;++f<b;)if(C=I.charCodeAt(f),48>C||C>57){P=(C===46?s+I.slice(f+1):I.slice(f))+P,I=I.slice(0,f);break}}}R&&!k&&(I=e(I,1/0));var V=z.length+I.length+P.length,H=V<E?new Array(E-V+1).join(p):"";switch(R&&k&&(I=e(H+I,H.length?E-P.length:1/0),H=""),_){case"<":I=z+I+P+H;break;case"=":I=z+H+I+P;break;case"^":I=H.slice(0,V=H.length>>1)+z+I+P+H.slice(V);break;default:I=H+z+I+P;break}return i(I)}return K.toString=function(){return c+""},K}function h(c,p){var _=u((c=pr(c),c.type="f",c)),m=Math.max(-8,Math.min(8,Math.floor(xs(p)/3)))*3,g=Math.pow(10,-m),k=un[8+m/3];return function(E){return _(g*E)+k}}return{format:u,formatPrefix:h}}var hr,Qn;Ws({thousands:",",grouping:[3],currency:["$",""]});function Ws(n){return hr=Js(n),Qn=hr.format,hr}function ft(n,e,t){this.k=n,this.x=e,this.y=t}ft.prototype={constructor:ft,scale:function(n){return n===1?this:new ft(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new ft(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new ft(1,0,0);const $t=4,cn=()=>Rs($t).map(()=>[]),hn=n=>dr(n.filter(e=>e.valid),e=>e.points),Pt=$e(),Qe=$e(!1),Ee=$e(-1),Sr=At([Ee,Qe],([n,e],t)=>{n>=$t-1&&!e?t("post"):t(!e&&n===-1?"pre":"mid")}),Te=$e({user:cn(),opponent:cn()}),mr=$e([]),Vs=At(Te,(n,e)=>{const t=n.user.map(hn),r=n.opponent.map(hn);e({user:t,opponent:r})}),Or=At(Vs,(n,e)=>{const t=dr(n.user),r=dr(n.opponent);e({user:t,opponent:r})}),Ys=n=>[].concat(...n),fn=n=>{const e=n.filter(t=>t.valid).map(t=>t.lemmas.split("|"));return Ys(e)},jr=At([Te,Ee],([n,e],t)=>{if(e<0)return;const r=fn(n.user[e]),s=fn(n.opponent[e]),i=[...r,...s];t(i)}),we=$e(void 0),xe=$e(void 0),It=$e(void 0);function Ks(n){let e,t,r,s,i,o,a,l,u,h,c;return{c(){e=w("nav"),t=w("button"),r=O("Hamburger"),s=N(),i=w("button"),o=O("Rules"),a=N(),l=w("button"),u=O("About"),this.h()},l(p){e=y(p,"NAV",{class:!0});var _=T(e);t=y(_,"BUTTON",{});var m=T(t);r=j(m,"Hamburger"),m.forEach(d),s=U(_),i=y(_,"BUTTON",{});var g=T(i);o=j(g,"Rules"),g.forEach(d),a=U(_),l=y(_,"BUTTON",{});var k=T(l);u=j(k,"About"),k.forEach(d),_.forEach(d),this.h()},h(){S(e,"class","svelte-bz9c25")},m(p,_){$(p,e,_),v(e,t),v(t,r),v(e,s),v(e,i),v(i,o),v(e,a),v(e,l),v(l,u),h||(c=[ce(t,"click",n[1]),ce(i,"click",n[2]),ce(l,"click",n[3])],h=!0)},p:q,i:q,o:q,d(p){p&&d(e),h=!1,_t(c)}}}function Xs(n,e,t){let r;return x(n,we,a=>t(0,r=a)),[r,()=>{ve(we,r="hamburger",r)},()=>{ve(we,r="rules",r)},()=>{ve(we,r="about",r)}]}class Qs extends Z{constructor(e){super(),ee(this,e,Xs,Ks,te,{})}}let Ue,dt;const Ze=$e(0),Zn=n=>{dt||(dt=n);const e=Math.round(n-dt);dt=n,Ze.update(t=>t+e),Ue=window.requestAnimationFrame(Zn)},pt={start(){Ue||(dt=null,Ue=window.requestAnimationFrame(Zn))},stop(){Ue&&(window.cancelAnimationFrame(Ue),Ue=null)},toggle(){Ue?pt.stop():pt.start()},set(n){typeof n=="number"&&Ze.set(n)},reset(){Ze.set(0)}},St=({lemmas:n,corpus:e})=>!!n.split("|").filter(r=>!!e.find(s=>s===r)).length;async function Ct(n){const t=await(await fetch(n)).text();return Bs(t)}async function Zs(n){const e=`https://pudding.cool/projects/word-game-data/wod-answers/${n}.csv?version=${Date.now()}`;return(await Ct(e)).map(s=>ut(Ne({},s),{round:+s.round,timestamp:+s.timestamp,points:+s.points}))}function ei(n,e,t){let r,s,i,o,a;x(n,Pt,p=>t(2,r=p)),x(n,Ee,p=>t(3,s=p)),x(n,Te,p=>t(4,i=p)),x(n,Ze,p=>t(0,o=p)),x(n,jr,p=>t(5,a=p));let l=[];const u=p=>St({lemmas:p,corpus:a}),h=({lemmas:p})=>{const _=!u(p);return{valid:_,reason:_?void 0:0}},c=()=>{const p=l.findIndex(_=>_.round===s&&o>=_.timestamp);if(p>-1){const[_]=l.splice(p,1),m=Ne(Ne({},_),h(_));ve(Te,i.opponent[s]=[...i.opponent[s],m],i)}};return gt(async()=>{l=await Zs(r)}),n.$$.update=()=>{n.$$.dirty&1&&c()},[o]}class ti extends Z{constructor(e){super(),ee(this,e,ei,null,te,{})}}function dn(n){return Object.prototype.toString.call(n)==="[object Date]"}function vr(n,e){if(n===e||n!==n)return()=>n;const t=typeof n;if(t!==typeof e||Array.isArray(n)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(n)){const r=e.map((s,i)=>vr(n[i],s));return s=>r.map(i=>i(s))}if(t==="object"){if(!n||!e)throw new Error("Object cannot be null");if(dn(n)&&dn(e)){n=n.getTime(),e=e.getTime();const i=e-n;return o=>new Date(n+o*i)}const r=Object.keys(e),s={};return r.forEach(i=>{s[i]=vr(n[i],e[i])}),i=>{const o={};return r.forEach(a=>{o[a]=s[a](i)}),o}}if(t==="number"){const r=e-n;return s=>n+s*r}throw new Error(`Cannot interpolate ${t} values`)}function es(n,e={}){const t=$e(n);let r,s=n;function i(o,a){if(n==null)return t.set(n=o),Promise.resolve();s=o;let l=r,u=!1,{delay:h=0,duration:c=400,easing:p=Jn,interpolate:_=vr}=Zr(Zr({},e),a);if(c===0)return l&&(l.abort(),l=null),t.set(n=s),Promise.resolve();const m=vs()+h;let g;return r=_s(k=>{if(k<m)return!0;u||(g=_(n,o),typeof c=="function"&&(c=c(n,o)),u=!0),l&&(l.abort(),l=null);const E=k-m;return E>c?(t.set(n=o),!1):(t.set(n=g(p(E/c))),!0)}),r.promise}return{set:i,update:(o,a)=>i(o(s,n),a),subscribe:t.subscribe}}function ri(n,{delay:e=0,duration:t=400,easing:r=Jn}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:i=>`opacity: ${i*s}`}}function pn(n){let e,t,r,s;return{c(){e=w("span"),t=O(n[2]),this.h()},l(i){e=y(i,"SPAN",{class:!0});var o=T(e);t=j(o,n[2]),o.forEach(d),this.h()},h(){S(e,"class","svelte-xlb350")},m(i,o){$(i,e,o),v(e,t),s=!0},p(i,o){(!s||o&4)&&oe(t,i[2])},i(i){s||(r&&r.end(1),s=!0)},o(i){r=gs(e,ri,{}),s=!1},d(i){i&&d(e),i&&r&&r.end()}}}function ni(n){let e,t,r,s,i=n[1]&&pn(n);return{c(){e=w("li"),t=O(n[3]),r=N(),i&&i.c(),this.h()},l(o){e=y(o,"LI",{class:!0});var a=T(e);t=j(a,n[3]),r=U(a),i&&i.l(a),a.forEach(d),this.h()},h(){S(e,"class","svelte-xlb350"),me(e,"invalid",n[0])},m(o,a){$(o,e,a),v(e,t),v(e,r),i&&i.m(e,null),s=!0},p(o,[a]){(!s||a&8)&&oe(t,o[3]),o[1]?i?(i.p(o,a),a&2&&M(i,1)):(i=pn(o),i.c(),M(i,1),i.m(e,null)):i&&(_e(),G(i,1,1,()=>{i=null}),ge()),a&1&&me(e,"invalid",o[0])},i(o){s||(M(i),s=!0)},o(o){G(i),s=!1},d(o){o&&d(e),i&&i.d()}}}function si(n,e,t){let r,s,i,o,{opponent:a}=e,{valid:l}=e,{text:u}=e,{revealOpponent:h}=e,{points:c}=e;const p=es(0,{duration:1e3});let _=!0;return p.set(1).then(()=>{t(9,_=!1)}),n.$$set=m=>{"opponent"in m&&t(4,a=m.opponent),"valid"in m&&t(5,l=m.valid),"text"in m&&t(6,u=m.text),"revealOpponent"in m&&t(7,h=m.revealOpponent),"points"in m&&t(8,c=m.points)},n.$$.update=()=>{n.$$.dirty&240&&t(3,r=a&&l&&!h?u.split("").map(()=>"\u2589").join(""):u),n.$$.dirty&32&&t(0,s=!l),n.$$.dirty&257&&t(2,i=s||!c?"":`+${c}`),n.$$.dirty&656&&t(1,o=_&&(!a||!h))},[s,o,i,r,a,l,u,h,c,_]}class ii extends Z{constructor(e){super(),ee(this,e,si,ni,te,{opponent:4,valid:5,text:6,revealOpponent:7,points:8})}}function mn(n,e,t){const r=n.slice();return r[2]=e[t].valid,r[3]=e[t].text,r[4]=e[t].revealOpponent,r[5]=e[t].points,r}function vn(n,e){let t,r,s;return r=new ii({props:{opponent:e[1],valid:e[2],text:e[3],revealOpponent:e[4],points:e[5]}}),{key:n,first:null,c(){t=ae(),re(r.$$.fragment),this.h()},l(i){t=ae(),ne(r.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){$(i,t,o),se(r,i,o),s=!0},p(i,o){e=i;const a={};o&2&&(a.opponent=e[1]),o&1&&(a.valid=e[2]),o&1&&(a.text=e[3]),o&1&&(a.revealOpponent=e[4]),o&1&&(a.points=e[5]),r.$set(a)},i(i){s||(M(r.$$.fragment,i),s=!0)},o(i){G(r.$$.fragment,i),s=!1},d(i){i&&d(t),ie(r,i)}}}function oi(n){let e,t=[],r=new Map,s,i=n[0];const o=a=>a[3];for(let a=0;a<i.length;a+=1){let l=mn(n,i,a),u=o(l);r.set(u,t[a]=vn(u,l))}return{c(){e=w("ul");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=y(a,"UL",{class:!0});var l=T(e);for(let u=0;u<t.length;u+=1)t[u].l(l);l.forEach(d),this.h()},h(){S(e,"class","svelte-12ad0m2")},m(a,l){$(a,e,l);for(let u=0;u<t.length;u+=1)t[u].m(e,null);s=!0},p(a,[l]){l&3&&(i=a[0],_e(),t=ws(t,l,o,1,a,i,r,e,ys,vn,null,mn),ge())},i(a){if(!s){for(let l=0;l<i.length;l+=1)M(t[l]);s=!0}},o(a){for(let l=0;l<t.length;l+=1)G(t[l]);s=!1},d(a){a&&d(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function ai(n,e,t){let{guesses:r}=e,{opponent:s=!1}=e;return n.$$set=i=>{"guesses"in i&&t(0,r=i.guesses),"opponent"in i&&t(1,s=i.opponent)},[r,s]}class ts extends Z{constructor(e){super(),ee(this,e,ai,oi,te,{guesses:0,opponent:1})}}function _n(n){let e,t;return e=new ts({props:{guesses:n[0],opponent:!0}}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},p(r,s){const i={};s&1&&(i.guesses=r[0]),e.$set(i)},i(r){t||(M(e.$$.fragment,r),t=!0)},o(r){G(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function li(n){let e,t,r,s;t=new ts({props:{guesses:n[1]}});let i=!n[2]&&_n(n);return{c(){e=w("div"),re(t.$$.fragment),r=N(),i&&i.c(),this.h()},l(o){e=y(o,"DIV",{class:!0});var a=T(e);ne(t.$$.fragment,a),r=U(a),i&&i.l(a),a.forEach(d),this.h()},h(){S(e,"class","svelte-7qsaem")},m(o,a){$(o,e,a),se(t,e,null),v(e,r),i&&i.m(e,null),s=!0},p(o,[a]){const l={};a&2&&(l.guesses=o[1]),t.$set(l),o[2]?i&&(_e(),G(i,1,1,()=>{i=null}),ge()):i?(i.p(o,a),a&4&&M(i,1)):(i=_n(o),i.c(),M(i,1),i.m(e,null))},i(o){s||(M(t.$$.fragment,o),M(i),s=!0)},o(o){G(t.$$.fragment,o),G(i),s=!1},d(o){o&&d(e),ie(t),i&&i.d()}}}const ui=0;function ci(n,e,t){let r,s,i,o,a;x(n,Ee,u=>t(3,i=u)),x(n,Te,u=>t(4,o=u)),x(n,xe,u=>t(2,a=u));const l=u=>u.reason===void 0||u.reason===ui;return n.$$.update=()=>{n.$$.dirty&24&&t(1,r=o.user[i].filter(l)),n.$$.dirty&24&&t(0,s=o.opponent[i].filter(l))},[s,r,a,i,o]}class hi extends Z{constructor(e){super(),ee(this,e,ci,li,te,{})}}var fi=[{row:0,value:"q"},{row:0,value:"w"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"a"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:2,value:"Shift"},{row:2,value:"z"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"m"},{row:2,value:"Backspace"},{row:3,value:"Page1"},{row:3,value:","},{row:3,value:"Space"},{row:3,value:"."},{row:3,value:"Enter"},{row:0,value:"1",page:1},{row:0,value:"2",page:1},{row:0,value:"3",page:1},{row:0,value:"4",page:1},{row:0,value:"5",page:1},{row:0,value:"6",page:1},{row:0,value:"7",page:1},{row:0,value:"8",page:1},{row:0,value:"9",page:1},{row:0,value:"0",page:1},{row:1,value:"!",page:1},{row:1,value:"@",page:1},{row:1,value:"#",page:1},{row:1,value:"$",page:1},{row:1,value:"%",page:1},{row:1,value:"^",page:1},{row:1,value:"&",page:1},{row:1,value:"*",page:1},{row:1,value:"(",page:1},{row:1,value:")",page:1},{row:2,value:"-",page:1},{row:2,value:"_",page:1},{row:2,value:"=",page:1},{row:2,value:"+",page:1},{row:2,value:";",page:1},{row:2,value:":",page:1},{row:2,value:"'",page:1},{row:2,value:'"',page:1},{row:2,value:"<",page:1},{row:2,value:">",page:1},{row:3,value:"Page0",page:1},{row:3,value:"/",page:1},{row:3,value:"?",page:1},{row:3,value:"[",page:1},{row:3,value:"]",page:1},{row:3,value:"{",page:1},{row:3,value:"}",page:1},{row:3,value:"|",page:1},{row:3,value:"\\",page:1},{row:3,value:"~",page:1}],di=[{row:0,value:"q"},{row:0,value:"w"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"a"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:2,value:"z"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"m"},{row:2,value:"Backspace"}],pi=[{row:0,value:"q"},{row:0,value:"w"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"a"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:2,value:"Enter"},{row:2,value:"z"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"m"},{row:2,value:"Backspace"}],mi=[{row:0,value:"a"},{row:0,value:"z"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"q"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:1,value:"m"},{row:2,value:"Shift"},{row:2,value:"w"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"Backspace"},{row:3,value:"Page1"},{row:3,value:","},{row:3,value:"Space"},{row:3,value:"."},{row:3,value:"Enter"},{row:0,value:"1",page:1},{row:0,value:"2",page:1},{row:0,value:"3",page:1},{row:0,value:"4",page:1},{row:0,value:"5",page:1},{row:0,value:"6",page:1},{row:0,value:"7",page:1},{row:0,value:"8",page:1},{row:0,value:"9",page:1},{row:0,value:"0",page:1},{row:1,value:"!",page:1},{row:1,value:"@",page:1},{row:1,value:"#",page:1},{row:1,value:"$",page:1},{row:1,value:"%",page:1},{row:1,value:"^",page:1},{row:1,value:"&",page:1},{row:1,value:"*",page:1},{row:1,value:"(",page:1},{row:1,value:")",page:1},{row:2,value:"-",page:1},{row:2,value:"_",page:1},{row:2,value:"=",page:1},{row:2,value:"+",page:1},{row:2,value:";",page:1},{row:2,value:":",page:1},{row:2,value:"'",page:1},{row:2,value:'"',page:1},{row:2,value:"<",page:1},{row:2,value:">",page:1},{row:3,value:"Page0",page:1},{row:3,value:"/",page:1},{row:3,value:"?",page:1},{row:3,value:"[",page:1},{row:3,value:"]",page:1},{row:3,value:"{",page:1},{row:3,value:"}",page:1},{row:3,value:"|",page:1},{row:3,value:"\\",page:1},{row:3,value:"~",page:1}],vi=[{row:0,value:"a"},{row:0,value:"z"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"q"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:1,value:"m"},{row:2,value:"w"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"Backspace"}],_i=[{row:0,value:"a"},{row:0,value:"z"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"q"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:1,value:"m"},{row:2,value:"Enter"},{row:2,value:"w"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"Backspace"}],gi='<svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-delete"><path d="M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"></path><line x1="18" y1="9" x2="12" y2="15"></line><line x1="12" y1="9" x2="18" y2="15"></line></svg>',wi='<svg width="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-corner-down-left"><polyline points="9 10 4 15 9 20"></polyline><path d="M20 4v7a4 4 0 0 1-4 4H4"></path></svg>';function gn(n,e,t){const r=n.slice();return r[27]=e[t],r[29]=t,r}function wn(n,e,t){const r=n.slice();return r[30]=e[t],r}function yn(n,e,t){const r=n.slice();return r[33]=e[t].value,r[34]=e[t].display,r}function yi(n){let e=n[34]+"",t;return{c(){t=O(e)},l(r){t=j(r,e)},m(r,s){$(r,t,s)},p(r,s){s[0]&8&&e!==(e=r[34]+"")&&oe(t,e)},d(r){r&&d(t)}}}function bi(n){let e,t=n[34]+"",r;return{c(){e=new Wn(!1),r=ae(),this.h()},l(s){e=Vn(s,!1),r=ae(),this.h()},h(){e.a=r},m(s,i){e.m(t,s,i),$(s,r,i)},p(s,i){i[0]&8&&t!==(t=s[34]+"")&&e.p(t)},d(s){s&&d(r),s&&e.d()}}}function bn(n){let e,t,r,s,i;function o(_,m){return m[0]&8&&(t=null),t==null&&(t=!!_[34].includes("<svg")),t?bi:yi}let a=o(n,[-1,-1]),l=a(n);function u(..._){return n[19](n[33],..._)}function h(..._){return n[20](n[33],..._)}function c(){return n[21](n[33])}function p(){return n[22](n[33])}return{c(){e=w("button"),l.c(),this.h()},l(_){e=y(_,"BUTTON",{class:!0});var m=T(e);l.l(m),m.forEach(d),this.h()},h(){S(e,"class",r="key key--"+n[33]+" "+(n[0][n[33]]||"")+" svelte-zdf3cm"),me(e,"single",n[33].length===1),me(e,"active",n[33]===n[2])},m(_,m){$(_,e,m),l.m(e,null),s||(i=[ce(e,"touchstart",u),ce(e,"mousedown",h),ce(e,"touchend",c,{passive:!0}),ce(e,"mouseup",p)],s=!0)},p(_,m){n=_,a===(a=o(n,m))&&l?l.p(n,m):(l.d(1),l=a(n),l&&(l.c(),l.m(e,null))),m[0]&9&&r!==(r="key key--"+n[33]+" "+(n[0][n[33]]||"")+" svelte-zdf3cm")&&S(e,"class",r),m[0]&9&&me(e,"single",n[33].length===1),m[0]&13&&me(e,"active",n[33]===n[2])},d(_){_&&d(e),l.d(),s=!1,_t(i)}}}function kn(n){let e,t=n[30],r=[];for(let s=0;s<t.length;s+=1)r[s]=bn(yn(n,t,s));return{c(){e=w("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=y(s,"DIV",{class:!0});var i=T(e);for(let o=0;o<r.length;o+=1)r[o].l(i);i.forEach(d),this.h()},h(){S(e,"class","row row--"+n[29]+" svelte-zdf3cm")},m(s,i){$(s,e,i);for(let o=0;o<r.length;o+=1)r[o].m(e,null)},p(s,i){if(i[0]&61){t=s[30];let o;for(o=0;o<t.length;o+=1){const a=yn(s,t,o);r[o]?r[o].p(a,i):(r[o]=bn(a),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=t.length}},d(s){s&&d(e),et(r,s)}}}function En(n){let e,t,r=n[27],s=[];for(let i=0;i<r.length;i+=1)s[i]=kn(wn(n,r,i));return{c(){e=w("div");for(let i=0;i<s.length;i+=1)s[i].c();t=N(),this.h()},l(i){e=y(i,"DIV",{class:!0});var o=T(e);for(let a=0;a<s.length;a+=1)s[a].l(o);t=U(o),o.forEach(d),this.h()},h(){S(e,"class","page svelte-zdf3cm"),me(e,"visible",n[29]===n[1])},m(i,o){$(i,e,o);for(let a=0;a<s.length;a+=1)s[a].m(e,null);v(e,t)},p(i,o){if(o[0]&61){r=i[27];let a;for(a=0;a<r.length;a+=1){const l=wn(i,r,a);s[a]?s[a].p(l,o):(s[a]=kn(l),s[a].c(),s[a].m(e,t))}for(;a<s.length;a+=1)s[a].d(1);s.length=r.length}o[0]&2&&me(e,"visible",i[29]===i[1])},d(i){i&&d(e),et(s,i)}}}function ki(n){let e,t=n[3],r=[];for(let s=0;s<t.length;s+=1)r[s]=En(gn(n,t,s));return{c(){e=w("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=y(s,"DIV",{class:!0});var i=T(e);for(let o=0;o<r.length;o+=1)r[o].l(i);i.forEach(d),this.h()},h(){S(e,"class","svelte-keyboard")},m(s,i){$(s,e,i);for(let o=0;o<r.length;o+=1)r[o].m(e,null)},p(s,i){if(i[0]&63){t=s[3];let o;for(o=0;o<t.length;o+=1){const a=gn(s,t,o);r[o]?r[o].p(a,i):(r[o]=En(a),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=t.length}},i:q,o:q,d(s){s&&d(e),et(r,s)}}}const Ei="abcdefghijklmnopqrstuvwxyz";function Ti(n,e,t){let r,s,i,o,a,l,u,h,c,{custom:p}=e,{localizationLayout:_="qwerty"}=e,{layout:m="standard"}=e,{noSwap:g=[]}=e,{keyClass:k={}}=e,E=0,R=!1,L;const W={qwerty:{standard:fi,crossword:di,wordle:pi},azerty:{standard:mi,crossword:vi,wordle:_i}},B=Er(),A={Page0:"abc",Page1:"?123",Space:" ",Shift:"abc",Enter:wi,Backspace:gi},F=f=>[...new Set(f)],D=(f,b)=>{if(f.preventDefault(),t(2,L=b),b.includes("Page"))t(1,E=+b.substr(-1));else if(b==="Shift")t(10,R=!R);else{let C=b;R&&Ei.includes(b)&&(C=b.toUpperCase()),B("keydown",C)}return f.stopPropagation(),!1},J=f=>{setTimeout(()=>{f===L&&t(2,L=void 0)},50)},K=(f,b)=>D(b,f),I=(f,b)=>D(b,f),z=f=>J(f),P=f=>J(f);return n.$$set=f=>{"custom"in f&&t(6,p=f.custom),"localizationLayout"in f&&t(7,_=f.localizationLayout),"layout"in f&&t(8,m=f.layout),"noSwap"in f&&t(9,g=f.noSwap),"keyClass"in f&&t(0,k=f.keyClass)},n.$$.update=()=>{n.$$.dirty[0]&448&&t(18,r=p||W[_][m]||standard),n.$$.dirty[0]&263680&&t(17,s=r.map(f=>{let b=f.display;const C=A[f.value];return C&&!g.includes(f.value)&&!f.noSwap&&(b=C),b||(b=R?f.value.toUpperCase():f.value),f.value==="Shift"&&(b=R?C:C.toUpperCase()),ut(Ne({},f),{display:b})})),n.$$.dirty[0]&131072&&t(15,i=s.filter(f=>!f.page)),n.$$.dirty[0]&131072&&t(13,o=s.filter(f=>f.page)),n.$$.dirty[0]&32768&&t(14,a=F(i.map(f=>f.row))),n.$$.dirty[0]&16384&&a.sort((f,b)=>f-b),n.$$.dirty[0]&8192&&t(16,l=F(o.map(f=>f.row))),n.$$.dirty[0]&65536&&l.sort((f,b)=>f-b),n.$$.dirty[0]&49152&&t(12,u=a.map(f=>i.filter(b=>b.row===f))),n.$$.dirty[0]&24576&&t(11,h=a.map(f=>o.filter(b=>b.row===f))),n.$$.dirty[0]&6144&&t(3,c=[u,h])},[k,E,L,c,D,J,p,_,m,g,R,h,u,o,a,i,l,s,r,K,I,z,P]}class Si extends Z{constructor(e){super(),ee(this,e,Ti,ki,te,{custom:6,localizationLayout:7,layout:8,noSwap:9,keyClass:0},null,[-1,-1])}}function Oi(n){let e,t,r,s,i,o,a,l,u,h,c,p,_,m,g;return i=new Si({props:{layout:"wordle"}}),i.$on("keydown",n[2]),{c(){e=w("div"),t=w("p"),r=O(n[1]),s=N(),re(i.$$.fragment),o=N(),a=w("div"),l=w("form"),u=w("input"),h=N(),c=w("button"),p=O("Submit"),this.h()},l(k){e=y(k,"DIV",{class:!0});var E=T(e);t=y(E,"P",{});var R=T(t);r=j(R,n[1]),R.forEach(d),s=U(E),ne(i.$$.fragment,E),E.forEach(d),o=U(k),a=y(k,"DIV",{class:!0});var L=T(a);l=y(L,"FORM",{});var W=T(l);u=y(W,"INPUT",{maxlength:!0,class:!0}),h=U(W),c=y(W,"BUTTON",{type:!0,class:!0});var B=T(c);p=j(B,"Submit"),B.forEach(d),W.forEach(d),L.forEach(d),this.h()},h(){S(e,"class","keyboard svelte-1jya41k"),S(u,"maxlength","15"),S(u,"class","svelte-1jya41k"),S(c,"type","submit"),S(c,"class","svelte-1jya41k"),S(a,"class","no-keyboard svelte-1jya41k")},m(k,E){$(k,e,E),v(e,t),v(t,r),v(e,s),se(i,e,null),$(k,o,E),$(k,a,E),v(a,l),v(l,u),Ot(u,n[1]),n[5](u),v(l,h),v(l,c),v(c,p),_=!0,m||(g=[ce(u,"input",n[4]),ce(l,"submit",n[3])],m=!0)},p(k,[E]){(!_||E&2)&&oe(r,k[1]),E&2&&u.value!==k[1]&&Ot(u,k[1])},i(k){_||(M(i.$$.fragment,k),_=!0)},o(k){G(i.$$.fragment,k),_=!1},d(k){k&&d(e),ie(i),k&&d(o),k&&d(a),n[5](null),m=!1,_t(g)}}}function ji(n,e,t){const r=Er();let s,i="";const o=()=>{i&&r("submit",i),t(1,i="")},a=c=>{c.detail==="Enter"?o():c.detail==="Backspace"?t(1,i=i.substring(0,i.length-1)):t(1,i=`${i}${c.detail}`)},l=c=>{c.preventDefault(),t(1,i=i.trim().toLowerCase()),o()};gt(()=>{s.focus()});function u(){i=this.value,t(1,i)}function h(c){Yn[c?"unshift":"push"](()=>{s=c,t(0,s)})}return[s,i,a,l,u,h]}class $i extends Z{constructor(e){super(),ee(this,e,ji,Oi,te,{})}}function Pi(n){let e,t;return{c(){e=w("p"),t=O(n[0]),this.h()},l(r){e=y(r,"P",{class:!0});var s=T(e);t=j(s,n[0]),s.forEach(d),this.h()},h(){S(e,"class","svelte-jyzswz")},m(r,s){$(r,e,s),v(e,t)},p(r,[s]){s&1&&oe(t,r[0])},i:q,o:q,d(r){r&&d(e)}}}const Tn=1e3;function Ri(n,e,t){let r,s,i;x(n,Qe,l=>t(1,s=l)),x(n,Ze,l=>t(2,i=l));const o=15*Tn,a=l=>{l?pt.start():(pt.stop(),pt.reset())};return n.$$.update=()=>{n.$$.dirty&4&&t(0,r=Math.floor((o-i)/Tn)),n.$$.dirty&1&&r<=0&&ve(Qe,s=!1,s),n.$$.dirty&2&&a(s)},[r,s,i]}class Ai extends Z{constructor(e){super(),ee(this,e,Ri,Pi,te,{})}}function Ii(n){let e,t,r,s,i;return{c(){e=w("div"),t=w("p"),r=O("Type as many words as you can that..."),s=N(),i=w("p"),this.h()},l(o){e=y(o,"DIV",{class:!0});var a=T(e);t=y(a,"P",{class:!0});var l=T(t);r=j(l,"Type as many words as you can that..."),l.forEach(d),s=U(a),i=y(a,"P",{class:!0});var u=T(i);u.forEach(d),a.forEach(d),this.h()},h(){S(t,"class","instructions svelte-12uh45b"),S(i,"class","clue svelte-12uh45b"),S(e,"class","svelte-12uh45b")},m(o,a){$(o,e,a),v(e,t),v(t,r),v(e,s),v(e,i),i.innerHTML=n[0]},p(o,[a]){a&1&&(i.innerHTML=o[0])},i:q,o:q,d(o){o&&d(e)}}}function Ci(n,e,t){let{clue:r}=e;return n.$$set=s=>{"clue"in s&&t(0,r=s.clue)},[r]}class Ni extends Z{constructor(e){super(),ee(this,e,Ci,Ii,te,{clue:0})}}function Sn(n){let e,t,r,s,i,o=n[0].opponent+"",a;return{c(){e=w("p"),t=w("span"),r=O("Michelle"),s=N(),i=w("span"),a=O(o),this.h()},l(l){e=y(l,"P",{class:!0});var u=T(e);t=y(u,"SPAN",{class:!0});var h=T(t);r=j(h,"Michelle"),h.forEach(d),s=U(u),i=y(u,"SPAN",{class:!0});var c=T(i);a=j(c,o),c.forEach(d),u.forEach(d),this.h()},h(){S(t,"class","name svelte-1xmjoob"),S(i,"class","score svelte-1xmjoob"),S(e,"class","svelte-1xmjoob")},m(l,u){$(l,e,u),v(e,t),v(t,r),v(e,s),v(e,i),v(i,a)},p(l,u){u&1&&o!==(o=l[0].opponent+"")&&oe(a,o)},d(l){l&&d(e)}}}function Ui(n){let e,t,r,s,i,o,a=n[0].user+"",l,u,h=!n[1]&&Sn(n);return{c(){e=w("div"),t=w("p"),r=w("span"),s=O("You"),i=N(),o=w("span"),l=O(a),u=N(),h&&h.c(),this.h()},l(c){e=y(c,"DIV",{class:!0});var p=T(e);t=y(p,"P",{class:!0});var _=T(t);r=y(_,"SPAN",{class:!0});var m=T(r);s=j(m,"You"),m.forEach(d),i=U(_),o=y(_,"SPAN",{class:!0});var g=T(o);l=j(g,a),g.forEach(d),_.forEach(d),u=U(p),h&&h.l(p),p.forEach(d),this.h()},h(){S(r,"class","name svelte-1xmjoob"),S(o,"class","score svelte-1xmjoob"),S(t,"class","svelte-1xmjoob"),S(e,"class","svelte-1xmjoob")},m(c,p){$(c,e,p),v(e,t),v(t,r),v(r,s),v(t,i),v(t,o),v(o,l),v(e,u),h&&h.m(e,null)},p(c,[p]){p&1&&a!==(a=c[0].user+"")&&oe(l,a),c[1]?h&&(h.d(1),h=null):h?h.p(c,p):(h=Sn(c),h.c(),h.m(e,null))},i:q,o:q,d(c){c&&d(e),h&&h.d()}}}function Di(n,e,t){let r,s;return x(n,Or,i=>t(0,r=i)),x(n,xe,i=>t(1,s=i)),[r,s]}class Mi extends Z{constructor(e){super(),ee(this,e,Di,Ui,te,{})}}function On(n){let e,t,r=n[0].text+"",s,i,o=n[2][n[0].reason]+"",a;return{c(){e=w("p"),t=w("strong"),s=O(r),i=N(),a=O(o),this.h()},l(l){e=y(l,"P",{class:!0});var u=T(e);t=y(u,"STRONG",{});var h=T(t);s=j(h,r),h.forEach(d),i=U(u),a=j(u,o),u.forEach(d),this.h()},h(){S(e,"class","svelte-2dcxu0")},m(l,u){$(l,e,u),v(e,t),v(t,s),v(e,i),v(e,a)},p(l,u){u&1&&r!==(r=l[0].text+"")&&oe(s,r),u&1&&o!==(o=l[2][l[0].reason]+"")&&oe(a,o)},d(l){l&&d(e)}}}function Bi(n){let e,t=n[1]&&On(n);return{c(){e=w("div"),t&&t.c(),this.h()},l(r){e=y(r,"DIV",{class:!0});var s=T(e);t&&t.l(s),s.forEach(d),this.h()},h(){S(e,"class","svelte-2dcxu0")},m(r,s){$(r,e,s),t&&t.m(e,null)},p(r,[s]){r[1]?t?t.p(r,s):(t=On(r),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},i:q,o:q,d(r){r&&d(e),t&&t.d()}}}const Li=2500;function xi(n,e,t){let r,s,i;x(n,Ee,c=>t(4,s=c)),x(n,Te,c=>t(5,i=c));let o,a=!1,l=0;const u=["(or a variation) was played by opponent","is too short","contains non-letters","is not in the word list","was already entered"],h=()=>{t(3,l=i.user[s].length),clearTimeout(o),r.valid?t(1,a=!1):(t(1,a=!0),o=setTimeout(()=>t(1,a=!1),Li))};return n.$$.update=()=>{n.$$.dirty&48&&t(0,r=i.user[s][i.user[s].length-1]),n.$$.dirty&48&&(i.user[s].length||t(3,l=0)),n.$$.dirty&57&&r&&i.user[s].length!==l&&h()},[r,a,u,l,s,i]}class Fi extends Z{constructor(e){super(),ee(this,e,xi,Bi,te,{})}}function Gi(n){let e,t,r,s,i,o,a,l,u,h,c,p,_,m;return t=new Ni({props:{clue:n[0]}}),s=new Ai({}),a=new hi({}),u=new Mi({}),c=new Fi({}),_=new $i({}),_.$on("submit",n[1]),{c(){e=w("div"),re(t.$$.fragment),r=N(),re(s.$$.fragment),i=N(),o=w("div"),re(a.$$.fragment),l=N(),re(u.$$.fragment),h=N(),re(c.$$.fragment),p=N(),re(_.$$.fragment),this.h()},l(g){e=y(g,"DIV",{class:!0});var k=T(e);ne(t.$$.fragment,k),r=U(k),ne(s.$$.fragment,k),i=U(k),o=y(k,"DIV",{class:!0});var E=T(o);ne(a.$$.fragment,E),l=U(E),ne(u.$$.fragment,E),h=U(E),ne(c.$$.fragment,E),p=U(E),ne(_.$$.fragment,E),E.forEach(d),k.forEach(d),this.h()},h(){S(o,"class","board svelte-1uowmjb"),S(e,"class","play svelte-1uowmjb")},m(g,k){$(g,e,k),se(t,e,null),v(e,r),se(s,e,null),v(e,i),v(e,o),se(a,o,null),v(o,l),se(u,o,null),v(o,h),se(c,o,null),v(o,p),se(_,o,null),m=!0},p(g,[k]){const E={};k&1&&(E.clue=g[0]),t.$set(E)},i(g){m||(M(t.$$.fragment,g),M(s.$$.fragment,g),M(a.$$.fragment,g),M(u.$$.fragment,g),M(c.$$.fragment,g),M(_.$$.fragment,g),m=!0)},o(g){G(t.$$.fragment,g),G(s.$$.fragment,g),G(a.$$.fragment,g),G(u.$$.fragment,g),G(c.$$.fragment,g),G(_.$$.fragment,g),m=!1},d(g){g&&d(e),ie(t),ie(s),ie(a),ie(u),ie(c),ie(_)}}}function Hi(n,e,t){let r,s,i,o,a,l,u,h;x(n,Ee,A=>t(5,o=A)),x(n,Te,A=>t(7,a=A)),x(n,Ze,A=>t(8,l=A)),x(n,jr,A=>t(9,u=A)),x(n,mr,A=>t(10,h=A));let{clues:c}=e,{answers:p}=e;const _=A=>{const F=s.find(D=>D.word===A);return F?F.lemmas:""},m=A=>!i.includes(A),g=({text:A,lemmas:F})=>St({lemmas:F,corpus:u}),k=({text:A,lemmas:F})=>{const D=a.user[o].map(J=>J.lemmas);return St({lemmas:F,corpus:D})},E=A=>new RegExp(/([^a-z])/,"g").test(A),R=({text:A,lemmas:F})=>{let D=!0,J;return A.length<4?(D=!1,J=1):E(A)?(D=!1,J=2):m(A)?(D=!1,J=3):k({text:A,lemmas:F})?(D=!1,J=4):g({text:A,lemmas:F})&&(D=!1,J=0),{valid:D,reason:J}},L=({text:A,timestamp:F})=>{const{points:D}=s.find(J=>J.word===A);return+D},W=A=>{a.opponent[o].forEach(F=>{const D=F.lemmas.split("|");St({lemmas:A,corpus:D})&&(F.revealOpponent=!0)})},B=async({detail:A})=>{const F=A,D=_(F),{valid:J,reason:K}=R({text:F,lemmas:D}),I=l,z=J?L({text:F,timestamp:I}):void 0,P={text:F,lemmas:D,points:z,timestamp:I,round:o,valid:J,reason:K};ve(Te,a.user[o]=[...a.user[o],P],a),W(D)};return n.$$set=A=>{"clues"in A&&t(2,c=A.clues),"answers"in A&&t(3,p=A.answers)},n.$$.update=()=>{n.$$.dirty&36&&t(0,r=c[o]),n.$$.dirty&40&&t(4,s=p[o]),n.$$.dirty&16&&ve(mr,h=s,h),n.$$.dirty&16&&(i=s.map(A=>A.word))},[r,B,c,p,s,o]}class qi extends Z{constructor(e){super(),ee(this,e,Hi,Gi,te,{clues:2,answers:3})}}function zi(n){let e,t;return{c(){e=w("p"),t=O(n[0]),this.h()},l(r){e=y(r,"P",{class:!0});var s=T(e);t=j(s,n[0]),s.forEach(d),this.h()},h(){S(e,"class","svelte-1sj1s4l")},m(r,s){$(r,e,s),v(e,t)},p(r,[s]){s&1&&oe(t,r[0])},i:q,o:q,d(r){r&&d(e)}}}const jn=3;function Ji(n,e,t){let r,s;const i=Er(),o=-1,a=jn*1e3,l=es(jn,{duration:a});return x(n,l,u=>t(2,s=u)),l.set(o).then(()=>{i("end")}),n.$$.update=()=>{n.$$.dirty&4&&t(0,r=s<0?"Begin!":Math.floor(s)+1)},[r,l,s]}class Wi extends Z{constructor(e){super(),ee(this,e,Ji,zi,te,{})}}function $n(n){let e,t,r=n[2].opponent+"",s;return{c(){e=w("p"),t=O("Michelle: "),s=O(r)},l(i){e=y(i,"P",{});var o=T(e);t=j(o,"Michelle: "),s=j(o,r),o.forEach(d)},m(i,o){$(i,e,o),v(e,t),v(e,s)},p(i,o){o&4&&r!==(r=i[2].opponent+"")&&oe(s,r)},d(i){i&&d(e)}}}function Vi(n){let e,t,r=n[0]+1+"",s,i,o,a,l,u=n[1]?"Your score":"You",h,c,p=n[2].user+"",_,m,g,k=!n[1]&&$n(n);return{c(){e=w("p"),t=O("Round "),s=O(r),i=O(" of "),o=O($t),a=N(),l=w("p"),h=O(u),c=O(": "),_=O(p),m=N(),k&&k.c(),g=ae()},l(E){e=y(E,"P",{});var R=T(e);t=j(R,"Round "),s=j(R,r),i=j(R," of "),o=j(R,$t),R.forEach(d),a=U(E),l=y(E,"P",{});var L=T(l);h=j(L,u),c=j(L,": "),_=j(L,p),L.forEach(d),m=U(E),k&&k.l(E),g=ae()},m(E,R){$(E,e,R),v(e,t),v(e,s),v(e,i),v(e,o),$(E,a,R),$(E,l,R),v(l,h),v(l,c),v(l,_),$(E,m,R),k&&k.m(E,R),$(E,g,R)},p(E,[R]){R&1&&r!==(r=E[0]+1+"")&&oe(s,r),R&2&&u!==(u=E[1]?"Your score":"You")&&oe(h,u),R&4&&p!==(p=E[2].user+"")&&oe(_,p),E[1]?k&&(k.d(1),k=null):k?k.p(E,R):(k=$n(E),k.c(),k.m(g.parentNode,g))},i:q,o:q,d(E){E&&d(e),E&&d(a),E&&d(l),E&&d(m),k&&k.d(E),E&&d(g)}}}function Yi(n,e,t){let r,s,i;return x(n,Ee,o=>t(0,r=o)),x(n,xe,o=>t(1,s=o)),x(n,Or,o=>t(2,i=o)),[r,s,i]}class Ki extends Z{constructor(e){super(),ee(this,e,Yi,Vi,te,{})}}function Pn(n,e,t){const r=n.slice();return r[10]=e[t].text,r[11]=e[t].points,r}function Rn(n){let e,t,r,s,i,o,a,l,u,h,c,p,_=n[2].slice(0,7),m=[];for(let g=0;g<_.length;g+=1)m[g]=An(Pn(n,_,g));return{c(){e=w("p"),t=O("Here are some words that Michelle got that you didn't:"),r=N(),s=w("table"),i=w("thead"),o=w("th"),a=O("Word"),l=N(),u=w("th"),h=O("Points"),c=N(),p=w("tbody");for(let g=0;g<m.length;g+=1)m[g].c();this.h()},l(g){e=y(g,"P",{});var k=T(e);t=j(k,"Here are some words that Michelle got that you didn't:"),k.forEach(d),r=U(g),s=y(g,"TABLE",{class:!0});var E=T(s);i=y(E,"THEAD",{});var R=T(i);o=y(R,"TH",{});var L=T(o);a=j(L,"Word"),L.forEach(d),l=U(R),u=y(R,"TH",{});var W=T(u);h=j(W,"Points"),W.forEach(d),R.forEach(d),c=U(E),p=y(E,"TBODY",{});var B=T(p);for(let A=0;A<m.length;A+=1)m[A].l(B);B.forEach(d),E.forEach(d),this.h()},h(){S(s,"class","svelte-1nqgcdy")},m(g,k){$(g,e,k),v(e,t),$(g,r,k),$(g,s,k),v(s,i),v(i,o),v(o,a),v(i,l),v(i,u),v(u,h),v(s,c),v(s,p);for(let E=0;E<m.length;E+=1)m[E].m(p,null)},p(g,k){if(k&4){_=g[2].slice(0,7);let E;for(E=0;E<_.length;E+=1){const R=Pn(g,_,E);m[E]?m[E].p(R,k):(m[E]=An(R),m[E].c(),m[E].m(p,null))}for(;E<m.length;E+=1)m[E].d(1);m.length=_.length}},d(g){g&&d(e),g&&d(r),g&&d(s),et(m,g)}}}function An(n){let e,t,r=n[10]+"",s,i,o,a=n[11]+"",l;return{c(){e=w("tr"),t=w("td"),s=O(r),i=N(),o=w("td"),l=O(a)},l(u){e=y(u,"TR",{});var h=T(e);t=y(h,"TD",{});var c=T(t);s=j(c,r),c.forEach(d),i=U(h),o=y(h,"TD",{});var p=T(o);l=j(p,a),p.forEach(d),h.forEach(d)},m(u,h){$(u,e,h),v(e,t),v(t,s),v(e,i),v(e,o),v(o,l)},p(u,h){h&4&&r!==(r=u[10]+"")&&oe(s,r),h&4&&a!==(a=u[11]+"")&&oe(l,a)},d(u){u&&d(e)}}}function Xi(n){let e,t,r,s,i,o,a,l,u,h,c,p,_,m=n[2].length&&Rn(n);return{c(){e=w("p"),t=O("There were "),r=w("strong"),s=O(n[3]),i=O(" possible words that satisfied the clue."),o=N(),m&&m.c(),a=N(),l=w("p"),u=O("Here are some common words that "),h=O(n[0]),c=O(": "),p=new Wn(!1),_=O("."),this.h()},l(g){e=y(g,"P",{});var k=T(e);t=j(k,"There were "),r=y(k,"STRONG",{});var E=T(r);s=j(E,n[3]),E.forEach(d),i=j(k," possible words that satisfied the clue."),k.forEach(d),o=U(g),m&&m.l(g),a=U(g),l=y(g,"P",{});var R=T(l);u=j(R,"Here are some common words that "),h=j(R,n[0]),c=j(R,": "),p=Vn(R,!1),_=j(R,"."),R.forEach(d),this.h()},h(){p.a=_},m(g,k){$(g,e,k),v(e,t),v(e,r),v(r,s),v(e,i),$(g,o,k),m&&m.m(g,k),$(g,a,k),$(g,l,k),v(l,u),v(l,h),v(l,c),p.m(n[1],l),v(l,_)},p(g,[k]){k&8&&oe(s,g[3]),g[2].length?m?m.p(g,k):(m=Rn(g),m.c(),m.m(a.parentNode,a)):m&&(m.d(1),m=null),k&1&&oe(h,g[0]),k&2&&p.p(g[1])},i:q,o:q,d(g){g&&d(e),g&&d(o),m&&m.d(g),g&&d(a),g&&d(l)}}}function Qi(n,e,t){let r,s,i,o,a,l,u,h,c,p;return x(n,xe,_=>t(5,l=_)),x(n,jr,_=>t(6,u=_)),x(n,mr,_=>t(7,h=_)),x(n,Ee,_=>t(8,c=_)),x(n,Te,_=>t(9,p=_)),n.$$.update=()=>{n.$$.dirty&128&&t(3,r=Qn(",")(h.length)),n.$$.dirty&768&&t(2,s=p.opponent[c].filter(_=>_.valid&&!_.guessedByUserLate)),n.$$.dirty&192&&t(4,i=h.filter(_=>+_.points==1).filter(_=>!u.includes(m=>m.text))),n.$$.dirty&16&&t(1,o=As(i).slice(0,5).map(_=>`<span>${_.word}</span>`).join(", ")),n.$$.dirty&32&&t(0,a=l?"you didn't get":"neither of you got")},[a,o,s,r,i,l,u,h,c,p]}class Zi extends Z{constructor(e){super(),ee(this,e,Qi,Xi,te,{})}}function In(n){let e,t;return{c(){e=w("h2"),t=O(n[1]),this.h()},l(r){e=y(r,"H2",{class:!0});var s=T(e);t=j(s,n[1]),s.forEach(d),this.h()},h(){S(e,"class","svelte-4gydqf")},m(r,s){$(r,e,s),v(e,t)},p(r,s){s&2&&oe(t,r[1])},d(r){r&&d(e)}}}function Cn(n){let e;function t(i,o){return i[2]?ro:i[3]?to:eo}let r=t(n),s=r(n);return{c(){s.c(),e=ae()},l(i){s.l(i),e=ae()},m(i,o){s.m(i,o),$(i,e,o)},p(i,o){r!==(r=t(i))&&(s.d(1),s=r(i),s&&(s.c(),s.m(e.parentNode,e)))},d(i){s.d(i),i&&d(e)}}}function eo(n){let e,t;return{c(){e=w("p"),t=O("Tie!")},l(r){e=y(r,"P",{});var s=T(e);t=j(s,"Tie!"),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},d(r){r&&d(e)}}}function to(n){let e,t;return{c(){e=w("p"),t=O("You lose!")},l(r){e=y(r,"P",{});var s=T(e);t=j(s,"You lose!"),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},d(r){r&&d(e)}}}function ro(n){let e,t;return{c(){e=w("p"),t=O("You win!")},l(r){e=y(r,"P",{});var s=T(e);t=j(s,"You win!"),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},d(r){r&&d(e)}}}function no(n){let e,t,r,s,i,o,a,l=!n[4]&&In(n);r=new Ki({}),i=new Zi({});let u=n[0]==="post"&&!n[4]&&Cn(n);return{c(){e=w("div"),l&&l.c(),t=N(),re(r.$$.fragment),s=N(),re(i.$$.fragment),o=N(),u&&u.c(),this.h()},l(h){e=y(h,"DIV",{class:!0});var c=T(e);l&&l.l(c),t=U(c),ne(r.$$.fragment,c),s=U(c),ne(i.$$.fragment,c),o=U(c),u&&u.l(c),c.forEach(d),this.h()},h(){S(e,"class","svelte-4gydqf")},m(h,c){$(h,e,c),l&&l.m(e,null),v(e,t),se(r,e,null),v(e,s),se(i,e,null),v(e,o),u&&u.m(e,null),a=!0},p(h,[c]){h[4]?l&&(l.d(1),l=null):l?l.p(h,c):(l=In(h),l.c(),l.m(e,t)),h[0]==="post"&&!h[4]?u?u.p(h,c):(u=Cn(h),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(h){a||(M(r.$$.fragment,h),M(i.$$.fragment,h),a=!0)},o(h){G(r.$$.fragment,h),G(i.$$.fragment,h),a=!1},d(h){h&&d(e),l&&l.d(),ie(r),ie(i),u&&u.d()}}}function so(n,e,t){let r,s,i,o,a,l,u,h;x(n,Sr,m=>t(0,a=m)),x(n,Ee,m=>t(7,l=m)),x(n,Or,m=>t(5,u=m)),x(n,xe,m=>t(4,h=m));const c={ahead:["Live look at her: \u{1F92A}.","She says this is almost as good as a day with boba.","She's really channeling her inner Jessie O'Connor.","Nice try. Follow me on Twitter @mich_mcghee."],behind:["Live look at Michelle: \u{1F62D}.","Michelle says this is almost as bad as a day without boba.","Michelle will try to channel her inner Jessie O'Connor this next round.","Ugh. Rematch?"]},p=()=>{const m=i?"Tie!":r?"You win!":"You lose!",g=r||i?c.behind[l]:c.ahead[l];return`${m} A message from Michelle: ${g}`},_=()=>{const m=i?"It's all tied up.":r?"You're in the lead!":"Michelle's in the lead.",g=r||i?c.behind[l]:c.ahead[l];return`${m} ${g}`};return n.$$.update=()=>{n.$$.dirty&32&&t(2,r=u.user>u.opponent),n.$$.dirty&32&&t(3,s=u.user<u.opponent),n.$$.dirty&32&&(i=u.user===u.opponent),n.$$.dirty&1&&t(1,o=a==="post"?p():_())},[a,o,r,s,h,u]}class io extends Z{constructor(e){super(),ee(this,e,so,no,te,{})}}async function oo(n){const e=`https://pudding.cool/projects/word-game-data/wod-info/${n}.csv?version=${Date.now()}`;return await Ct(e)}function ao(n){let e,t,r,s,i,o,a,l,u,h,c,p,_,m,g,k,E,R,L,W,B,A,F,D,J,K,I,z;return{c(){e=w("h2"),t=O("Welcome to the Word Game"),r=N(),s=w("p"),i=O("One person a day gets the chance to play against the world in a game of words."),o=N(),a=w("p"),l=O("Today that person is "),u=w("strong"),h=O(n[1]),c=O(" from "),p=O(n[2]),_=O(". Can you beat them?"),m=N(),g=w("p"),k=O("Do you want to be the "),E=w("strong"),R=O("Word Opponent of the Day?"),L=O(" Sign up here to be in the running."),W=N(),B=w("button"),A=O("BIG SIGNUP BUTTON"),F=N(),D=w("p"),J=w("button"),K=O("How to Play"),this.h()},l(P){e=y(P,"H2",{class:!0});var f=T(e);t=j(f,"Welcome to the Word Game"),f.forEach(d),r=U(P),s=y(P,"P",{});var b=T(s);i=j(b,"One person a day gets the chance to play against the world in a game of words."),b.forEach(d),o=U(P),a=y(P,"P",{class:!0});var C=T(a);l=j(C,"Today that person is "),u=y(C,"STRONG",{});var Y=T(u);h=j(Y,n[1]),c=j(Y," from "),p=j(Y,n[2]),Y.forEach(d),_=j(C,". Can you beat them?"),C.forEach(d),m=U(P),g=y(P,"P",{});var V=T(g);k=j(V,"Do you want to be the "),E=y(V,"STRONG",{});var H=T(E);R=j(H,"Word Opponent of the Day?"),H.forEach(d),L=j(V," Sign up here to be in the running."),V.forEach(d),W=U(P),B=y(P,"BUTTON",{});var ye=T(B);A=j(ye,"BIG SIGNUP BUTTON"),ye.forEach(d),F=U(P),D=y(P,"P",{});var de=T(D);J=y(de,"BUTTON",{});var Se=T(J);K=j(Se,"How to Play"),Se.forEach(d),de.forEach(d),this.h()},h(){S(e,"class","svelte-5kylwb"),S(a,"class","custom svelte-5kylwb"),me(a,"visible",n[0])},m(P,f){$(P,e,f),v(e,t),$(P,r,f),$(P,s,f),v(s,i),$(P,o,f),$(P,a,f),v(a,l),v(a,u),v(u,h),v(u,c),v(u,p),v(a,_),$(P,m,f),$(P,g,f),v(g,k),v(g,E),v(E,R),v(g,L),$(P,W,f),$(P,B,f),v(B,A),$(P,F,f),$(P,D,f),v(D,J),v(J,K),I||(z=ce(J,"click",n[4]),I=!0)},p(P,[f]){f&2&&oe(h,P[1]),f&4&&oe(p,P[2]),f&1&&me(a,"visible",P[0])},i:q,o:q,d(P){P&&d(e),P&&d(r),P&&d(s),P&&d(o),P&&d(a),P&&d(m),P&&d(g),P&&d(W),P&&d(B),P&&d(F),P&&d(D),I=!1,z()}}}function lo(n,e,t){let r,s;x(n,Pt,u=>t(0,r=u)),x(n,we,u=>t(3,s=u));let i,o;const a=async()=>{const u=await oo(r),h="what is your name?",c="where do you live?";t(1,i=u.find(p=>p.question===h).answer),t(2,o=u.find(p=>p.question===c).answer)},l=()=>{ve(we,s="rules",s)};return n.$$.update=()=>{n.$$.dirty&1&&r&&a()},[r,i,o,s,l]}class uo extends Z{constructor(e){super(),ee(this,e,lo,ao,te,{})}}const co="1.35.3",rs={"X-Client-Info":`supabase-js/${co}`},ho="supabase.auth.token";function fo(n){return n.replace(/\/$/,"")}const po=()=>typeof window!="undefined",mo="1.22.15",vo="http://localhost:9999",_o={"X-Client-Info":`gotrue-js/${mo}`},kt=10,De={ERROR_MESSAGE:"Request Failed",MAX_RETRIES:10,RETRY_INTERVAL:2},ht="supabase.auth.token",go={name:"sb",lifetime:60*60*8,domain:"",path:"/",sameSite:"lax"};var wt=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const wo=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),yo=(n,e)=>{if(!(n!=null&&n.status))return e({message:De.ERROR_MESSAGE});if(typeof n.json!="function")return e(n);n.json().then(t=>e({message:wo(t),status:(n==null?void 0:n.status)||500}))},bo=(n,e,t)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||(r.headers=Object.assign({"Content-Type":"text/plain;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(t)),r};function Nt(n,e,t,r,s){return wt(this,void 0,void 0,function*(){return new Promise((i,o)=>{n(t,bo(e,r,s)).then(a=>{if(!a.ok)throw a;return r!=null&&r.noResolveJson?i:a.json()}).then(a=>i(a)).catch(a=>yo(a,o))})})}function fr(n,e,t){return wt(this,void 0,void 0,function*(){return Nt(n,"GET",e,t)})}function he(n,e,t,r){return wt(this,void 0,void 0,function*(){return Nt(n,"POST",e,r,t)})}function Nn(n,e,t,r){return wt(this,void 0,void 0,function*(){return Nt(n,"PUT",e,r,t)})}function ko(n,e,t,r){return wt(this,void 0,void 0,function*(){return Nt(n,"DELETE",e,r,t)})}function Eo(n,e,t){const r=t||{},s=encodeURIComponent,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;if(typeof s!="function")throw new TypeError("option encode is invalid");if(!i.test(n))throw new TypeError("argument name is invalid");const o=s(e);if(o&&!i.test(o))throw new TypeError("argument val is invalid");let a=n+"="+o;if(r.maxAge!=null){const l=r.maxAge-0;if(isNaN(l)||!isFinite(l))throw new TypeError("option maxAge is invalid");a+="; Max-Age="+Math.floor(l)}if(r.domain){if(!i.test(r.domain))throw new TypeError("option domain is invalid");a+="; Domain="+r.domain}if(r.path){if(!i.test(r.path))throw new TypeError("option path is invalid");a+="; Path="+r.path}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");a+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(a+="; HttpOnly"),r.secure&&(a+="; Secure"),r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a}function To(n){if(!n||!n.headers||!n.headers.host)throw new Error('The "host" request header is not available');const e=n.headers.host.indexOf(":")>-1&&n.headers.host.split(":")[0]||n.headers.host;return!(["localhost","127.0.0.1"].indexOf(e)>-1||e.endsWith(".local"))}function So(n,e){var t,r,s;return Eo(n.name,n.value,{maxAge:n.maxAge,expires:new Date(Date.now()+n.maxAge*1e3),httpOnly:!0,secure:e,path:(t=n.path)!==null&&t!==void 0?t:"/",domain:(r=n.domain)!==null&&r!==void 0?r:"",sameSite:(s=n.sameSite)!==null&&s!==void 0?s:"lax"})}function _r(n,e,t){const r=t.map(i=>So(i,To(n))),s=e.getHeader("Set-Cookie");return s&&(s instanceof Array?Array.prototype.push.apply(r,s):typeof s=="string"&&r.push(s)),r}function Et(n,e,t){e.setHeader("Set-Cookie",_r(n,e,t))}var Oo=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function jo(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var gr={exports:{}};(function(n,e){var t=typeof self!="undefined"?self:Oo,r=function(){function i(){this.fetch=!1,this.DOMException=t.DOMException}return i.prototype=t,new i}();(function(i){(function(o){var a={searchParams:"URLSearchParams"in i,iterable:"Symbol"in i&&"iterator"in Symbol,blob:"FileReader"in i&&"Blob"in i&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in i,arrayBuffer:"ArrayBuffer"in i};function l(f){return f&&DataView.prototype.isPrototypeOf(f)}if(a.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(f){return f&&u.indexOf(Object.prototype.toString.call(f))>-1};function c(f){if(typeof f!="string"&&(f=String(f)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(f))throw new TypeError("Invalid character in header field name");return f.toLowerCase()}function p(f){return typeof f!="string"&&(f=String(f)),f}function _(f){var b={next:function(){var C=f.shift();return{done:C===void 0,value:C}}};return a.iterable&&(b[Symbol.iterator]=function(){return b}),b}function m(f){this.map={},f instanceof m?f.forEach(function(b,C){this.append(C,b)},this):Array.isArray(f)?f.forEach(function(b){this.append(b[0],b[1])},this):f&&Object.getOwnPropertyNames(f).forEach(function(b){this.append(b,f[b])},this)}m.prototype.append=function(f,b){f=c(f),b=p(b);var C=this.map[f];this.map[f]=C?C+", "+b:b},m.prototype.delete=function(f){delete this.map[c(f)]},m.prototype.get=function(f){return f=c(f),this.has(f)?this.map[f]:null},m.prototype.has=function(f){return this.map.hasOwnProperty(c(f))},m.prototype.set=function(f,b){this.map[c(f)]=p(b)},m.prototype.forEach=function(f,b){for(var C in this.map)this.map.hasOwnProperty(C)&&f.call(b,this.map[C],C,this)},m.prototype.keys=function(){var f=[];return this.forEach(function(b,C){f.push(C)}),_(f)},m.prototype.values=function(){var f=[];return this.forEach(function(b){f.push(b)}),_(f)},m.prototype.entries=function(){var f=[];return this.forEach(function(b,C){f.push([C,b])}),_(f)},a.iterable&&(m.prototype[Symbol.iterator]=m.prototype.entries);function g(f){if(f.bodyUsed)return Promise.reject(new TypeError("Already read"));f.bodyUsed=!0}function k(f){return new Promise(function(b,C){f.onload=function(){b(f.result)},f.onerror=function(){C(f.error)}})}function E(f){var b=new FileReader,C=k(b);return b.readAsArrayBuffer(f),C}function R(f){var b=new FileReader,C=k(b);return b.readAsText(f),C}function L(f){for(var b=new Uint8Array(f),C=new Array(b.length),Y=0;Y<b.length;Y++)C[Y]=String.fromCharCode(b[Y]);return C.join("")}function W(f){if(f.slice)return f.slice(0);var b=new Uint8Array(f.byteLength);return b.set(new Uint8Array(f)),b.buffer}function B(){return this.bodyUsed=!1,this._initBody=function(f){this._bodyInit=f,f?typeof f=="string"?this._bodyText=f:a.blob&&Blob.prototype.isPrototypeOf(f)?this._bodyBlob=f:a.formData&&FormData.prototype.isPrototypeOf(f)?this._bodyFormData=f:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)?this._bodyText=f.toString():a.arrayBuffer&&a.blob&&l(f)?(this._bodyArrayBuffer=W(f.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(f)||h(f))?this._bodyArrayBuffer=W(f):this._bodyText=f=Object.prototype.toString.call(f):this._bodyText="",this.headers.get("content-type")||(typeof f=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var f=g(this);if(f)return f;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(E)}),this.text=function(){var f=g(this);if(f)return f;if(this._bodyBlob)return R(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(L(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(J)}),this.json=function(){return this.text().then(JSON.parse)},this}var A=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function F(f){var b=f.toUpperCase();return A.indexOf(b)>-1?b:f}function D(f,b){b=b||{};var C=b.body;if(f instanceof D){if(f.bodyUsed)throw new TypeError("Already read");this.url=f.url,this.credentials=f.credentials,b.headers||(this.headers=new m(f.headers)),this.method=f.method,this.mode=f.mode,this.signal=f.signal,!C&&f._bodyInit!=null&&(C=f._bodyInit,f.bodyUsed=!0)}else this.url=String(f);if(this.credentials=b.credentials||this.credentials||"same-origin",(b.headers||!this.headers)&&(this.headers=new m(b.headers)),this.method=F(b.method||this.method||"GET"),this.mode=b.mode||this.mode||null,this.signal=b.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&C)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(C)}D.prototype.clone=function(){return new D(this,{body:this._bodyInit})};function J(f){var b=new FormData;return f.trim().split("&").forEach(function(C){if(C){var Y=C.split("="),V=Y.shift().replace(/\+/g," "),H=Y.join("=").replace(/\+/g," ");b.append(decodeURIComponent(V),decodeURIComponent(H))}}),b}function K(f){var b=new m,C=f.replace(/\r?\n[\t ]+/g," ");return C.split(/\r?\n/).forEach(function(Y){var V=Y.split(":"),H=V.shift().trim();if(H){var ye=V.join(":").trim();b.append(H,ye)}}),b}B.call(D.prototype);function I(f,b){b||(b={}),this.type="default",this.status=b.status===void 0?200:b.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in b?b.statusText:"OK",this.headers=new m(b.headers),this.url=b.url||"",this._initBody(f)}B.call(I.prototype),I.prototype.clone=function(){return new I(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})},I.error=function(){var f=new I(null,{status:0,statusText:""});return f.type="error",f};var z=[301,302,303,307,308];I.redirect=function(f,b){if(z.indexOf(b)===-1)throw new RangeError("Invalid status code");return new I(null,{status:b,headers:{location:f}})},o.DOMException=i.DOMException;try{new o.DOMException}catch{o.DOMException=function(b,C){this.message=b,this.name=C;var Y=Error(b);this.stack=Y.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function P(f,b){return new Promise(function(C,Y){var V=new D(f,b);if(V.signal&&V.signal.aborted)return Y(new o.DOMException("Aborted","AbortError"));var H=new XMLHttpRequest;function ye(){H.abort()}H.onload=function(){var de={status:H.status,statusText:H.statusText,headers:K(H.getAllResponseHeaders()||"")};de.url="responseURL"in H?H.responseURL:de.headers.get("X-Request-URL");var Se="response"in H?H.response:H.responseText;C(new I(Se,de))},H.onerror=function(){Y(new TypeError("Network request failed"))},H.ontimeout=function(){Y(new TypeError("Network request failed"))},H.onabort=function(){Y(new o.DOMException("Aborted","AbortError"))},H.open(V.method,V.url,!0),V.credentials==="include"?H.withCredentials=!0:V.credentials==="omit"&&(H.withCredentials=!1),"responseType"in H&&a.blob&&(H.responseType="blob"),V.headers.forEach(function(de,Se){H.setRequestHeader(Se,de)}),V.signal&&(V.signal.addEventListener("abort",ye),H.onreadystatechange=function(){H.readyState===4&&V.signal.removeEventListener("abort",ye)}),H.send(typeof V._bodyInit=="undefined"?null:V._bodyInit)})}return P.polyfill=!0,i.fetch||(i.fetch=P,i.Headers=m,i.Request=D,i.Response=I),o.Headers=m,o.Request=D,o.Response=I,o.fetch=P,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,n.exports=e})(gr,gr.exports);var Ut=jo(gr.exports),$r=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};function Ae(n){return Math.round(Date.now()/1e3)+n}function $o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Pe=()=>typeof window!="undefined";function Ie(n,e){var t;e||(e=((t=window==null?void 0:window.location)===null||t===void 0?void 0:t.href)||""),n=n.replace(/[\[\]]/g,"\\$&");const r=new RegExp("[?&#]"+n+"(=([^&#]*)|&|#|$)"),s=r.exec(e);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}const Po=n=>{let e;return n?e=n:typeof fetch=="undefined"?e=Ut:e=fetch,(...t)=>e(...t)},Ro=(n,e,t)=>$r(void 0,void 0,void 0,function*(){Pe()&&(yield n==null?void 0:n.setItem(e,JSON.stringify(t)))}),Ao=(n,e)=>$r(void 0,void 0,void 0,function*(){const t=Pe()&&(yield n==null?void 0:n.getItem(e));if(!t)return null;try{return JSON.parse(t)}catch{return t}}),Io=(n,e)=>{const t=Pe()&&(n==null?void 0:n.getItem(e));if(!t||typeof t!="string")return null;try{return JSON.parse(t)}catch{return t}},Co=(n,e)=>$r(void 0,void 0,void 0,function*(){Pe()&&(yield n==null?void 0:n.removeItem(e))});var le=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class No{constructor({url:e="",headers:t={},cookieOptions:r,fetch:s}){this.url=e,this.headers=t,this.cookieOptions=Object.assign(Object.assign({},go),r),this.fetch=Po(s)}_createRequestHeaders(e){const t=Object.assign({},this.headers);return t.Authorization=`Bearer ${e}`,t}cookieName(){var e;return(e=this.cookieOptions.name)!==null&&e!==void 0?e:""}getUrlForProvider(e,t){const r=[`provider=${encodeURIComponent(e)}`];return t!=null&&t.redirectTo&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),`${this.url}/authorize?${r.join("&")}`}signUpWithEmail(e,t,r={}){return le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let i="";r.redirectTo&&(i="?redirect_to="+encodeURIComponent(r.redirectTo));const o=yield he(this.fetch,`${this.url}/signup${i}`,{email:e,password:t,data:r.data,gotrue_meta_security:{hcaptcha_token:r.captchaToken}},{headers:s}),a=Object.assign({},o);return a.expires_in&&(a.expires_at=Ae(o.expires_in)),{data:a,error:null}}catch(s){return{data:null,error:s}}})}signInWithEmail(e,t,r={}){return le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let i="?grant_type=password";r.redirectTo&&(i+="&redirect_to="+encodeURIComponent(r.redirectTo));const o=yield he(this.fetch,`${this.url}/token${i}`,{email:e,password:t},{headers:s}),a=Object.assign({},o);return a.expires_in&&(a.expires_at=Ae(o.expires_in)),{data:a,error:null}}catch(s){return{data:null,error:s}}})}signUpWithPhone(e,t,r={}){return le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers),i=yield he(this.fetch,`${this.url}/signup`,{phone:e,password:t,data:r.data,gotrue_meta_security:{hcaptcha_token:r.captchaToken}},{headers:s}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=Ae(i.expires_in)),{data:o,error:null}}catch(s){return{data:null,error:s}}})}signInWithPhone(e,t){return le(this,void 0,void 0,function*(){try{const r=Object.assign({},this.headers),s="?grant_type=password",i=yield he(this.fetch,`${this.url}/token${s}`,{phone:e,password:t},{headers:r}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=Ae(i.expires_in)),{data:o,error:null}}catch(r){return{data:null,error:r}}})}signInWithOpenIDConnect({id_token:e,nonce:t,client_id:r,issuer:s,provider:i}){return le(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),a="?grant_type=id_token",l=yield he(this.fetch,`${this.url}/token${a}`,{id_token:e,nonce:t,client_id:r,issuer:s,provider:i},{headers:o}),u=Object.assign({},l);return u.expires_in&&(u.expires_at=Ae(l.expires_in)),{data:u,error:null}}catch(o){return{data:null,error:o}}})}sendMagicLinkEmail(e,t={}){var r;return le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let i="";t.redirectTo&&(i+="?redirect_to="+encodeURIComponent(t.redirectTo));const o=(r=t.shouldCreateUser)!==null&&r!==void 0?r:!0;return{data:yield he(this.fetch,`${this.url}/otp${i}`,{email:e,create_user:o,gotrue_meta_security:{hcaptcha_token:t.captchaToken}},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}sendMobileOTP(e,t={}){var r;return le(this,void 0,void 0,function*(){try{const s=(r=t.shouldCreateUser)!==null&&r!==void 0?r:!0,i=Object.assign({},this.headers);return{data:yield he(this.fetch,`${this.url}/otp`,{phone:e,create_user:s,gotrue_meta_security:{hcaptcha_token:t.captchaToken}},{headers:i}),error:null}}catch(s){return{data:null,error:s}}})}signOut(e){return le(this,void 0,void 0,function*(){try{return yield he(this.fetch,`${this.url}/logout`,{},{headers:this._createRequestHeaders(e),noResolveJson:!0}),{error:null}}catch(t){return{error:t}}})}verifyMobileOTP(e,t,r={}){return le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers),i=yield he(this.fetch,`${this.url}/verify`,{phone:e,token:t,type:"sms",redirect_to:r.redirectTo},{headers:s}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=Ae(i.expires_in)),{data:o,error:null}}catch(s){return{data:null,error:s}}})}verifyOTP({email:e,phone:t,token:r,type:s="sms"},i={}){return le(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),a=yield he(this.fetch,`${this.url}/verify`,{email:e,phone:t,token:r,type:s,redirect_to:i.redirectTo},{headers:o}),l=Object.assign({},a);return l.expires_in&&(l.expires_at=Ae(a.expires_in)),{data:l,error:null}}catch(o){return{data:null,error:o}}})}inviteUserByEmail(e,t={}){return le(this,void 0,void 0,function*(){try{const r=Object.assign({},this.headers);let s="";return t.redirectTo&&(s+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield he(this.fetch,`${this.url}/invite${s}`,{email:e,data:t.data},{headers:r}),error:null}}catch(r){return{data:null,error:r}}})}resetPasswordForEmail(e,t={}){return le(this,void 0,void 0,function*(){try{const r=Object.assign({},this.headers);let s="";return t.redirectTo&&(s+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield he(this.fetch,`${this.url}/recover${s}`,{email:e,gotrue_meta_security:{hcaptcha_token:t.captchaToken}},{headers:r}),error:null}}catch(r){return{data:null,error:r}}})}refreshAccessToken(e){return le(this,void 0,void 0,function*(){try{const t=yield he(this.fetch,`${this.url}/token?grant_type=refresh_token`,{refresh_token:e},{headers:this.headers}),r=Object.assign({},t);return r.expires_in&&(r.expires_at=Ae(t.expires_in)),{data:r,error:null}}catch(t){return{data:null,error:t}}})}setAuthCookie(e,t){e.method!=="POST"&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:r,session:s}=e.body;if(!r)throw new Error("Auth event missing!");if(r==="SIGNED_IN"){if(!s)throw new Error("Auth session missing!");Et(e,t,[{key:"access-token",value:s.access_token},{key:"refresh-token",value:s.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}r==="SIGNED_OUT"&&Et(e,t,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))),t.status(200).json({})}deleteAuthCookie(e,t,{redirectTo:r="/"}){return Et(e,t,["access-token","refresh-token"].map(s=>({name:`${this.cookieName()}-${s}`,value:"",maxAge:-1}))),t.redirect(307,r)}getAuthCookieString(e,t){e.method!=="POST"&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:r,session:s}=e.body;if(!r)throw new Error("Auth event missing!");if(r==="SIGNED_IN"){if(!s)throw new Error("Auth session missing!");return _r(e,t,[{key:"access-token",value:s.access_token},{key:"refresh-token",value:s.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}return r==="SIGNED_OUT"?_r(e,t,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))):t.getHeader("Set-Cookie")}generateLink(e,t,r={}){return le(this,void 0,void 0,function*(){try{return{data:yield he(this.fetch,`${this.url}/admin/generate_link`,{type:e,email:t,password:r.password,data:r.data,redirect_to:r.redirectTo},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}createUser(e){return le(this,void 0,void 0,function*(){try{const t=yield he(this.fetch,`${this.url}/admin/users`,e,{headers:this.headers});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}listUsers(){return le(this,void 0,void 0,function*(){try{return{data:(yield fr(this.fetch,`${this.url}/admin/users`,{headers:this.headers})).users,error:null}}catch(e){return{data:null,error:e}}})}getUserById(e){return le(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/admin/users/${e}`,{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}getUserByCookie(e,t){return le(this,void 0,void 0,function*(){try{if(!e.cookies)throw new Error("Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!");const r=e.cookies[`${this.cookieName()}-access-token`],s=e.cookies[`${this.cookieName()}-refresh-token`];if(!r)throw new Error("No cookie found!");const{user:i,error:o}=yield this.getUser(r);if(o){if(!s)throw new Error("No refresh_token cookie found!");if(!t)throw new Error("You need to pass the res object to automatically refresh the session!");const{data:a,error:l}=yield this.refreshAccessToken(s);if(l)throw l;if(a)return Et(e,t,[{key:"access-token",value:a.access_token},{key:"refresh-token",value:a.refresh_token}].map(u=>{var h;return{name:`${this.cookieName()}-${u.key}`,value:u.value,domain:this.cookieOptions.domain,maxAge:(h=this.cookieOptions.lifetime)!==null&&h!==void 0?h:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}})),{token:a.access_token,user:a.user,data:a.user,error:null}}return{token:r,user:i,data:i,error:null}}catch(r){return{token:null,user:null,data:null,error:r}}})}updateUserById(e,t){return le(this,void 0,void 0,function*(){try{const r=yield Nn(this.fetch,`${this.url}/admin/users/${e}`,t,{headers:this.headers});return{user:r,data:r,error:null}}catch(r){return{user:null,data:null,error:r}}})}deleteUser(e){return le(this,void 0,void 0,function*(){try{const t=yield ko(this.fetch,`${this.url}/admin/users/${e}`,{},{headers:this.headers});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}getUser(e){return le(this,void 0,void 0,function*(){try{const t=yield fr(this.fetch,`${this.url}/user`,{headers:this._createRequestHeaders(e)});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}updateUser(e,t){return le(this,void 0,void 0,function*(){try{const r=yield Nn(this.fetch,`${this.url}/user`,t,{headers:this._createRequestHeaders(e)});return{user:r,data:r,error:null}}catch(r){return{user:null,data:null,error:r}}})}}function Uo(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self!="undefined"&&(self.globalThis=self)}}var fe=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};Uo();const Do={url:vo,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:_o};class Mo{constructor(e){this.stateChangeEmitters=new Map,this.networkRetries=0;const t=Object.assign(Object.assign({},Do),e);this.currentUser=null,this.currentSession=null,this.autoRefreshToken=t.autoRefreshToken,this.persistSession=t.persistSession,this.multiTab=t.multiTab,this.localStorage=t.localStorage||globalThis.localStorage,this.api=new No({url:t.url,headers:t.headers,cookieOptions:t.cookieOptions,fetch:t.fetch}),this._recoverSession(),this._recoverAndRefresh(),this._listenForMultiTabEvents(),this._handleVisibilityChange(),t.detectSessionInUrl&&Pe()&&!!Ie("access_token")&&this.getSessionFromUrl({storeSession:!0}).then(({error:r})=>{r&&console.error("Error getting session from URL.",r)})}signUp({email:e,password:t,phone:r},s={}){return fe(this,void 0,void 0,function*(){try{this._removeSession();const{data:i,error:o}=r&&t?yield this.api.signUpWithPhone(r,t,{data:s.data,captchaToken:s.captchaToken}):yield this.api.signUpWithEmail(e,t,{redirectTo:s.redirectTo,data:s.data,captchaToken:s.captchaToken});if(o)throw o;if(!i)throw"An error occurred on sign up.";let a=null,l=null;return i.access_token&&(a=i,l=a.user,this._saveSession(a),this._notifyAllSubscribers("SIGNED_IN")),i.id&&(l=i),{user:l,session:a,error:null}}catch(i){return{user:null,session:null,error:i}}})}signIn({email:e,phone:t,password:r,refreshToken:s,provider:i,oidc:o},a={}){return fe(this,void 0,void 0,function*(){try{if(this._removeSession(),e&&!r){const{error:l}=yield this.api.sendMagicLinkEmail(e,{redirectTo:a.redirectTo,shouldCreateUser:a.shouldCreateUser,captchaToken:a.captchaToken});return{user:null,session:null,error:l}}if(e&&r)return this._handleEmailSignIn(e,r,{redirectTo:a.redirectTo});if(t&&!r){const{error:l}=yield this.api.sendMobileOTP(t,{shouldCreateUser:a.shouldCreateUser,captchaToken:a.captchaToken});return{user:null,session:null,error:l}}if(t&&r)return this._handlePhoneSignIn(t,r);if(s){const{error:l}=yield this._callRefreshToken(s);if(l)throw l;return{user:this.currentUser,session:this.currentSession,error:null}}if(i)return this._handleProviderSignIn(i,{redirectTo:a.redirectTo,scopes:a.scopes});if(o)return this._handleOpenIDConnectSignIn(o);throw new Error("You must provide either an email, phone number, a third-party provider or OpenID Connect.")}catch(l){return{user:null,session:null,error:l}}})}verifyOTP(e,t={}){return fe(this,void 0,void 0,function*(){try{this._removeSession();const{data:r,error:s}=yield this.api.verifyOTP(e,t);if(s)throw s;if(!r)throw"An error occurred on token verification.";let i=null,o=null;return r.access_token&&(i=r,o=i.user,this._saveSession(i),this._notifyAllSubscribers("SIGNED_IN")),r.id&&(o=r),{user:o,session:i,error:null}}catch(r){return{user:null,session:null,error:r}}})}user(){return this.currentUser}session(){return this.currentSession}refreshSession(){var e;return fe(this,void 0,void 0,function*(){try{if(!(!((e=this.currentSession)===null||e===void 0)&&e.access_token))throw new Error("Not logged in.");const{error:t}=yield this._callRefreshToken();if(t)throw t;return{data:this.currentSession,user:this.currentUser,error:null}}catch(t){return{data:null,user:null,error:t}}})}update(e){var t;return fe(this,void 0,void 0,function*(){try{if(!(!((t=this.currentSession)===null||t===void 0)&&t.access_token))throw new Error("Not logged in.");const{user:r,error:s}=yield this.api.updateUser(this.currentSession.access_token,e);if(s)throw s;if(!r)throw Error("Invalid user data.");const i=Object.assign(Object.assign({},this.currentSession),{user:r});return this._saveSession(i),this._notifyAllSubscribers("USER_UPDATED"),{data:r,user:r,error:null}}catch(r){return{data:null,user:null,error:r}}})}setSession(e){return fe(this,void 0,void 0,function*(){try{if(!e)throw new Error("No current session.");const{data:t,error:r}=yield this.api.refreshAccessToken(e);return r?{session:null,error:r}:(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"),{session:t,error:null})}catch(t){return{error:t,session:null}}})}setAuth(e){return this.currentSession=Object.assign(Object.assign({},this.currentSession),{access_token:e,token_type:"bearer",user:this.user()}),this._notifyAllSubscribers("TOKEN_REFRESHED"),this.currentSession}getSessionFromUrl(e){return fe(this,void 0,void 0,function*(){try{if(!Pe())throw new Error("No browser detected.");const t=Ie("error_description");if(t)throw new Error(t);const r=Ie("provider_token"),s=Ie("access_token");if(!s)throw new Error("No access_token detected.");const i=Ie("expires_in");if(!i)throw new Error("No expires_in detected.");const o=Ie("refresh_token");if(!o)throw new Error("No refresh_token detected.");const a=Ie("token_type");if(!a)throw new Error("No token_type detected.");const u=Math.round(Date.now()/1e3)+parseInt(i),{user:h,error:c}=yield this.api.getUser(s);if(c)throw c;const p={provider_token:r,access_token:s,expires_in:parseInt(i),expires_at:u,refresh_token:o,token_type:a,user:h};if(e!=null&&e.storeSession){this._saveSession(p);const _=Ie("type");this._notifyAllSubscribers("SIGNED_IN"),_==="recovery"&&this._notifyAllSubscribers("PASSWORD_RECOVERY")}return window.location.hash="",{data:p,error:null}}catch(t){return{data:null,error:t}}})}signOut(){var e;return fe(this,void 0,void 0,function*(){const t=(e=this.currentSession)===null||e===void 0?void 0:e.access_token;if(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"),t){const{error:r}=yield this.api.signOut(t);if(r)return{error:r}}return{error:null}})}onAuthStateChange(e){try{const t=$o(),r={id:t,callback:e,unsubscribe:()=>{this.stateChangeEmitters.delete(t)}};return this.stateChangeEmitters.set(t,r),{data:r,error:null}}catch(t){return{data:null,error:t}}}_handleEmailSignIn(e,t,r={}){var s,i;return fe(this,void 0,void 0,function*(){try{const{data:o,error:a}=yield this.api.signInWithEmail(e,t,{redirectTo:r.redirectTo});return a||!o?{data:null,user:null,session:null,error:a}:((((s=o==null?void 0:o.user)===null||s===void 0?void 0:s.confirmed_at)||((i=o==null?void 0:o.user)===null||i===void 0?void 0:i.email_confirmed_at))&&(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN")),{data:o,user:o.user,session:o,error:null})}catch(o){return{data:null,user:null,session:null,error:o}}})}_handlePhoneSignIn(e,t){var r;return fe(this,void 0,void 0,function*(){try{const{data:s,error:i}=yield this.api.signInWithPhone(e,t);return i||!s?{data:null,user:null,session:null,error:i}:(!((r=s==null?void 0:s.user)===null||r===void 0)&&r.phone_confirmed_at&&(this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN")),{data:s,user:s.user,session:s,error:null})}catch(s){return{data:null,user:null,session:null,error:s}}})}_handleProviderSignIn(e,t={}){const r=this.api.getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes});try{return Pe()&&(window.location.href=r),{provider:e,url:r,data:null,session:null,user:null,error:null}}catch(s){return r?{provider:e,url:r,data:null,session:null,user:null,error:null}:{data:null,user:null,session:null,error:s}}}_handleOpenIDConnectSignIn({id_token:e,nonce:t,client_id:r,issuer:s,provider:i}){return fe(this,void 0,void 0,function*(){if(e&&t&&(r&&s||i))try{const{data:o,error:a}=yield this.api.signInWithOpenIDConnect({id_token:e,nonce:t,client_id:r,issuer:s,provider:i});return a||!o?{user:null,session:null,error:a}:(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN"),{user:o.user,session:o,error:null})}catch(o){return{user:null,session:null,error:o}}throw new Error("You must provide a OpenID Connect provider with your id token and nonce.")})}_recoverSession(){try{const e=Io(this.localStorage,ht);if(!e)return null;const{currentSession:t,expiresAt:r}=e,s=Math.round(Date.now()/1e3);r>=s+kt&&(t==null?void 0:t.user)&&(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"))}catch(e){console.log("error",e)}}_recoverAndRefresh(){return fe(this,void 0,void 0,function*(){try{const e=yield Ao(this.localStorage,ht);if(!e)return null;const{currentSession:t,expiresAt:r}=e,s=Math.round(Date.now()/1e3);if(r<s+kt)if(this.autoRefreshToken&&t.refresh_token){this.networkRetries++;const{error:i}=yield this._callRefreshToken(t.refresh_token);if(i){if(console.log(i.message),i.message===De.ERROR_MESSAGE&&this.networkRetries<De.MAX_RETRIES){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),this.refreshTokenTimer=setTimeout(()=>this._recoverAndRefresh(),Math.pow(De.RETRY_INTERVAL,this.networkRetries)*100);return}yield this._removeSession()}this.networkRetries=0}else this._removeSession();else t?(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN")):(console.log("Current session is missing data."),this._removeSession())}catch(e){return console.error(e),null}})}_callRefreshToken(e){var t;return e===void 0&&(e=(t=this.currentSession)===null||t===void 0?void 0:t.refresh_token),fe(this,void 0,void 0,function*(){try{if(!e)throw new Error("No current session.");const{data:r,error:s}=yield this.api.refreshAccessToken(e);if(s)throw s;if(!r)throw Error("Invalid session data.");return this._saveSession(r),this._notifyAllSubscribers("TOKEN_REFRESHED"),this._notifyAllSubscribers("SIGNED_IN"),{data:r,error:null}}catch(r){return{data:null,error:r}}})}_notifyAllSubscribers(e){this.stateChangeEmitters.forEach(t=>t.callback(e,this.currentSession))}_saveSession(e){this.currentSession=e,this.currentUser=e.user;const t=e.expires_at;if(t){const r=Math.round(Date.now()/1e3),s=t-r,i=s>kt?kt:.5;this._startAutoRefreshToken((s-i)*1e3)}this.persistSession&&e.expires_at&&this._persistSession(this.currentSession)}_persistSession(e){const t={currentSession:e,expiresAt:e.expires_at};Ro(this.localStorage,ht,t)}_removeSession(){return fe(this,void 0,void 0,function*(){this.currentSession=null,this.currentUser=null,this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),Co(this.localStorage,ht)})}_startAutoRefreshToken(e){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),!(e<=0||!this.autoRefreshToken)&&(this.refreshTokenTimer=setTimeout(()=>fe(this,void 0,void 0,function*(){this.networkRetries++;const{error:t}=yield this._callRefreshToken();t||(this.networkRetries=0),(t==null?void 0:t.message)===De.ERROR_MESSAGE&&this.networkRetries<De.MAX_RETRIES&&this._startAutoRefreshToken(Math.pow(De.RETRY_INTERVAL,this.networkRetries)*100)}),e),typeof this.refreshTokenTimer.unref=="function"&&this.refreshTokenTimer.unref())}_listenForMultiTabEvents(){if(!this.multiTab||!Pe()||!(window!=null&&window.addEventListener))return!1;try{window==null||window.addEventListener("storage",e=>{var t;if(e.key===ht){const r=JSON.parse(String(e.newValue));!((t=r==null?void 0:r.currentSession)===null||t===void 0)&&t.access_token?(this._saveSession(r.currentSession),this._notifyAllSubscribers("SIGNED_IN")):(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"))}})}catch(e){console.error("_listenForMultiTabEvents",e)}}_handleVisibilityChange(){if(!this.multiTab||!Pe()||!(window!=null&&window.addEventListener))return!1;try{window==null||window.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this._recoverAndRefresh()})}catch(e){console.error("_handleVisibilityChange",e)}}}class Bo extends Mo{constructor(e){super(e)}}var Lo=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Pr{constructor(e){Object.assign(this,e);let t;e.fetch?t=e.fetch:typeof fetch=="undefined"?t=Ut:t=fetch,this.fetch=(...r)=>t(...r),this.shouldThrowOnError=e.shouldThrowOnError||!1}throwOnError(e){return e==null&&(e=!0),this.shouldThrowOnError=e,this}then(e,t){typeof this.schema=="undefined"||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let r=this.fetch(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(s=>Lo(this,void 0,void 0,function*(){var i,o,a;let l=null,u=null,h=null;if(s.ok){const p=(i=this.headers.Prefer)===null||i===void 0?void 0:i.split(",").includes("return=minimal");if(this.method!=="HEAD"&&!p){const g=yield s.text();g&&(this.headers.Accept==="text/csv"?u=g:u=JSON.parse(g))}const _=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),m=(a=s.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");_&&m&&m.length>1&&(h=parseInt(m[1]))}else{const p=yield s.text();try{l=JSON.parse(p)}catch{l={message:p}}if(l&&this.shouldThrowOnError)throw l}return{error:l,data:u,count:h,status:s.status,statusText:s.statusText,body:u}}));return this.shouldThrowOnError||(r=r.catch(s=>({error:{message:`FetchError: ${s.message}`,details:"",hint:"",code:s.code||""},data:null,body:null,count:null,status:400,statusText:"Bad Request"}))),r.then(e,t)}}class Rr extends Pr{select(e="*"){let t=!1;const r=e.split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this}order(e,{ascending:t=!0,nullsFirst:r=!1,foreignTable:s}={}){const i=typeof s=="undefined"?"order":`${s}.order`,o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}.${r?"nullsfirst":"nullslast"}`),this}limit(e,{foreignTable:t}={}){const r=typeof t=="undefined"?"limit":`${t}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:r}={}){const s=typeof r=="undefined"?"offset":`${r}.offset`,i=typeof r=="undefined"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){this.headers.Accept="application/vnd.pgrst.object+json";const e=new Rr(this);return e.then=(t,r)=>this.then(s=>{var i,o;return!((o=(i=s.error)===null||i===void 0?void 0:i.details)===null||o===void 0)&&o.includes("Results contain 0 rows")?t({error:null,data:null,count:s.count,status:200,statusText:"OK",body:null}):t(s)},r),e}csv(){return this.headers.Accept="text/csv",this}}class Ye extends Rr{constructor(){super(...arguments),this.cs=this.contains,this.cd=this.containedBy,this.sl=this.rangeLt,this.sr=this.rangeGt,this.nxl=this.rangeGte,this.nxr=this.rangeLte,this.adj=this.rangeAdjacent,this.ov=this.overlaps}not(e,t,r){return this.url.searchParams.append(`${e}`,`not.${t}.${r}`),this}or(e,{foreignTable:t}={}){const r=typeof t=="undefined"?"or":`${t}.or`;return this.url.searchParams.append(r,`(${e})`),this}eq(e,t){return this.url.searchParams.append(`${e}`,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(`${e}`,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(`${e}`,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(`${e}`,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(`${e}`,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(`${e}`,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(`${e}`,`like.${t}`),this}ilike(e,t){return this.url.searchParams.append(`${e}`,`ilike.${t}`),this}is(e,t){return this.url.searchParams.append(`${e}`,`is.${t}`),this}in(e,t){const r=t.map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(`${e}`,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(`${e}`,`cs.{${t.join(",")}}`):this.url.searchParams.append(`${e}`,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(`${e}`,`cd.{${t.join(",")}}`):this.url.searchParams.append(`${e}`,`cd.${JSON.stringify(t)}`),this}rangeLt(e,t){return this.url.searchParams.append(`${e}`,`sl.${t}`),this}rangeGt(e,t){return this.url.searchParams.append(`${e}`,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(`${e}`,`nxl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(`${e}`,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(`${e}`,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`ov.${t}`):this.url.searchParams.append(`${e}`,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s=null}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(`${e}`,`${i}fts${o}.${t}`),this}fts(e,t,{config:r}={}){const s=typeof r=="undefined"?"":`(${r})`;return this.url.searchParams.append(`${e}`,`fts${s}.${t}`),this}plfts(e,t,{config:r}={}){const s=typeof r=="undefined"?"":`(${r})`;return this.url.searchParams.append(`${e}`,`plfts${s}.${t}`),this}phfts(e,t,{config:r}={}){const s=typeof r=="undefined"?"":`(${r})`;return this.url.searchParams.append(`${e}`,`phfts${s}.${t}`),this}wfts(e,t,{config:r}={}){const s=typeof r=="undefined"?"":`(${r})`;return this.url.searchParams.append(`${e}`,`wfts${s}.${t}`),this}filter(e,t,r){return this.url.searchParams.append(`${e}`,`${t}.${r}`),this}match(e){return Object.keys(e).forEach(t=>{this.url.searchParams.append(`${t}`,`eq.${e[t]}`)}),this}}class ns extends Pr{constructor(e,{headers:t={},schema:r,fetch:s,shouldThrowOnError:i}={}){super({fetch:s,shouldThrowOnError:i}),this.url=new URL(e),this.headers=Object.assign({},t),this.schema=r}select(e="*",{head:t=!1,count:r=null}={}){this.method="GET";let s=!1;const i=e.split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),r&&(this.headers.Prefer=`count=${r}`),t&&(this.method="HEAD"),new Ye(this)}insert(e,{upsert:t=!1,onConflict:r,returning:s="representation",count:i=null}={}){this.method="POST";const o=[`return=${s}`];if(t&&o.push("resolution=merge-duplicates"),t&&r!==void 0&&this.url.searchParams.set("on_conflict",r),this.body=e,i&&o.push(`count=${i}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),Array.isArray(e)){const a=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(a.length>0){const l=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new Ye(this)}upsert(e,{onConflict:t,returning:r="representation",count:s=null,ignoreDuplicates:i=!1}={}){this.method="POST";const o=[`resolution=${i?"ignore":"merge"}-duplicates`,`return=${r}`];return t!==void 0&&this.url.searchParams.set("on_conflict",t),this.body=e,s&&o.push(`count=${s}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new Ye(this)}update(e,{returning:t="representation",count:r=null}={}){this.method="PATCH";const s=[`return=${t}`];return this.body=e,r&&s.push(`count=${r}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Ye(this)}delete({returning:e="representation",count:t=null}={}){this.method="DELETE";const r=[`return=${e}`];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Ye(this)}}class xo extends Pr{constructor(e,{headers:t={},schema:r,fetch:s,shouldThrowOnError:i}={}){super({fetch:s,shouldThrowOnError:i}),this.url=new URL(e),this.headers=Object.assign({},t),this.schema=r}rpc(e,{head:t=!1,count:r=null}={}){return t?(this.method="HEAD",e&&Object.entries(e).forEach(([s,i])=>{this.url.searchParams.append(s,i)})):(this.method="POST",this.body=e),r&&(this.headers.Prefer!==void 0?this.headers.Prefer+=`,count=${r}`:this.headers.Prefer=`count=${r}`),new Ye(this)}}const Fo="0.37.2",Go={"X-Client-Info":`postgrest-js/${Fo}`};class Ho{constructor(e,{headers:t={},schema:r,fetch:s,throwOnError:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},Go),t),this.schema=r,this.fetch=s,this.shouldThrowOnError=i}auth(e){return this.headers.Authorization=`Bearer ${e}`,this}from(e){const t=`${this.url}/${e}`;return new ns(t,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(e,t,{head:r=!1,count:s=null}={}){const i=`${this.url}/rpc/${e}`;return new xo(i,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError}).rpc(t,{head:r,count:s})}}var X;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(X||(X={}));const Un=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=qo(o,n,e,s),i),{})},qo=(n,e,t,r)=>{const s=e.find(a=>a.name===n),i=s==null?void 0:s.type,o=t[n];return i&&!r.includes(i)?ss(i,o):wr(o)},ss=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Vo(e,t)}switch(n){case X.bool:return zo(e);case X.float4:case X.float8:case X.int2:case X.int4:case X.int8:case X.numeric:case X.oid:return Jo(e);case X.json:case X.jsonb:return Wo(e);case X.timestamp:return Yo(e);case X.abstime:case X.date:case X.daterange:case X.int4range:case X.int8range:case X.money:case X.reltime:case X.text:case X.time:case X.timestamptz:case X.timetz:case X.tsrange:case X.tstzrange:return wr(e);default:return wr(e)}},wr=n=>n,zo=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Jo=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Wo=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Vo=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>ss(e,a))}return n},Yo=n=>typeof n=="string"?n.replace(" ","T"):n,Ko="websocket",Xo="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",Qo=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],Zo="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",ea=["I\xF1aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],ta="1.0.34",ra={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},na="https://github.com/theturtle32/WebSocket-Node",sa={node:">=4.0.0"},ia={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},oa={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},aa={verbose:!1},la={test:"tape test/unit/*.js",gulp:"gulp"},ua="index",ca={lib:"./lib"},ha="lib/browser.js",fa="Apache-2.0";var da={name:Ko,description:Xo,keywords:Qo,author:Zo,contributors:ea,version:ta,repository:ra,homepage:na,engines:sa,dependencies:ia,devDependencies:oa,config:aa,scripts:la,main:ua,directories:ca,browser:ha,license:fa},pa=da.version,Me;if(typeof globalThis=="object")Me=globalThis;else try{Me=require("es5-ext/global")}catch{}finally{if(!Me&&typeof window!="undefined"&&(Me=window),!Me)throw new Error("Could not determine global this")}var vt=Me.WebSocket||Me.MozWebSocket,ma=pa;function is(n,e){var t;return e?t=new vt(n,e):t=new vt(n),t}vt&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(n){Object.defineProperty(is,n,{get:function(){return vt[n]}})});var va={w3cwebsocket:vt?is:null,version:ma};const _a="1.7.2",ga={"X-Client-Info":`realtime-js/${_a}`},wa="1.0.0",os=1e4,ya=1e3;var mt;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(mt||(mt={}));var Q;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Q||(Q={}));var ue;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(ue||(ue={}));var yr;(function(n){n.websocket="websocket"})(yr||(yr={}));var Be;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Be||(Be={}));class Ar{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class ba{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=r.decode(e.slice(o,o+s));o=o+s;const l=r.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}}class Xe{constructor(e,t,r={},s=os){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel instanceof br?this.channel.on(this.refEvent,e):this.channel.on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel.trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){!this.refEvent||(this.channel instanceof br?this.channel.off(this.refEvent):this.channel.off(this.refEvent,{}))}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}class br{constructor(e,t={},r){this.topic=e,this.params=t,this.socket=r,this.bindings=[],this.state=Q.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new Xe(this,ue.join,this.params,this.timeout),this.rejoinTimer=new Ar(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Q.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=Q.closed,this.socket.remove(this)}),this.onError(s=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this.isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.on(ue.reply,(s,i)=>{this.trigger(this.replyEventName(i),s)})}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(e=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(e),this.joinPush}onClose(e){this.on(ue.close,e)}onError(e){this.on(ue.error,t=>e(t))}on(e,t){this.bindings.push({event:e,callback:t})}off(e){this.bindings=this.bindings.filter(t=>t.event!==e)}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Xe(this,e,t,r);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Q.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(ue.close,"leave",this.joinRef())};this.joinPush.destroy();let r=new Xe(this,ue.leave,{},e);return r.receive("ok",()=>t()).receive("timeout",()=>t()),r.send(),this.canPush()||r.trigger("ok",{}),r}onMessage(e,t,r){return t}isMember(e){return this.topic===e}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=Q.joining,this.joinPush.resend(e))}trigger(e,t,r){let{close:s,error:i,leave:o,join:a}=ue;if(r&&[s,i,o,a].indexOf(e)>=0&&r!==this.joinRef())return;let u=this.onMessage(e,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(h=>h.event==="*"?e===(t==null?void 0:t.type):h.event===e).map(h=>h.callback(u,r))}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===Q.closed}isErrored(){return this.state===Q.errored}isJoined(){return this.state===Q.joined}isJoining(){return this.state===Q.joining}isLeaving(){return this.state===Q.leaving}}class Ke{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel.on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel.joinRef(),this.state=Ke.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=Ke.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel.on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ke.syncDiff(this.state,s,i,o),a())})}static syncState(e,t,r,s){const i=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(i,(u,h)=>{o[u]||(l[u]=h)}),this.map(o,(u,h)=>{const c=i[u];if(c){const p=h.map(k=>k.presence_id),_=c.map(k=>k.presence_id),m=h.filter(k=>_.indexOf(k.presence_id)<0),g=c.filter(k=>p.indexOf(k.presence_id)<0);m.length>0&&(a[u]=m),g.length>0&&(l[u]=g)}else a[u]=h}),this.syncDiff(i,{joins:a,leaves:l},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{const u=e[a];if(e[a]=this.cloneDeep(l),u){const h=e[a].map(p=>p.presence_id),c=u.filter(p=>h.indexOf(p.presence_id)<0);e[a].unshift(...c)}r(a,u,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const h=l.map(c=>c.presence_id);u=u.filter(c=>h.indexOf(c.presence_id)<0),e[a]=u,s(a,u,l),u.length===0&&delete e[a]}),e}static list(e,t){return t||(t=(r,s)=>s),this.map(e,(r,s)=>t(r,s))}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_id=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}list(e){return Ke.list(this.state,e)}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel.joinRef()}}class Rt{constructor(e,t={},r){this.topic=e,this.params=t,this.socket=r,this.bindings=[],this.state=Q.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new Xe(this,ue.join,this.params,this.timeout),this.rejoinTimer=new Ar(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Q.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=Q.closed,this.socket.remove(this)}),this.onError(s=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this.isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.on(ue.reply,{},(s,i)=>{this.trigger(this.replyEventName(i),s)}),this.presence=new Ke(this)}list(){return this.presence.list()}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(e=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const t=this.bindings.reduce((r,s)=>{const{type:i}=s;return["phx_close","phx_error","phx_reply","presence_diff","presence_state"].includes(i)||(r[i]=s),r},{});return Object.keys(t).length&&this.updateJoinPayload({configs:t}),this.joinedOnce=!0,this.rejoin(e),this.joinPush}}onClose(e){this.on(ue.close,{},e)}onError(e){this.on(ue.error,{},t=>e(t))}on(e,t,r){this.bindings.push({type:e,filter:t!=null?t:{},callback:r!=null?r:()=>{}})}off(e,t){this.bindings=this.bindings.filter(r=>!(r.type===e&&Rt.isEqual(r.filter,t)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Xe(this,e,t,r);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Q.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(ue.close,"leave",this.joinRef())};this.joinPush.destroy();const r=new Xe(this,ue.leave,{},e);return r.receive("ok",()=>t()).receive("timeout",()=>t()),r.send(),this.canPush()||r.trigger("ok",{}),r}onMessage(e,t,r){return t}isMember(e){return this.topic===e}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=Q.joining,this.joinPush.resend(e))}trigger(e,t,r){const{close:s,error:i,leave:o,join:a}=ue;if(r&&[s,i,o,a].indexOf(e)>=0&&r!==this.joinRef())return;const u=this.onMessage(e,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(h=>{var c,p;return(h==null?void 0:h.type)===e&&(((c=h==null?void 0:h.filter)===null||c===void 0?void 0:c.event)==="*"||((p=h==null?void 0:h.filter)===null||p===void 0?void 0:p.event)===(t==null?void 0:t.event))}).map(h=>h.callback(u,r))}send(e){const t=this.push(e.type,e);return new Promise((r,s)=>{t.receive("ok",()=>r("ok")),t.receive("timeout",()=>s("timeout"))})}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===Q.closed}isErrored(){return this.state===Q.errored}isJoined(){return this.state===Q.joined}isJoining(){return this.state===Q.joining}isLeaving(){return this.state===Q.leaving}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}}var ka=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},Ea=globalThis&&globalThis.__rest||function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const Ta=()=>{};class Sa{constructor(e,t){this.accessToken=null,this.channels=[],this.endPoint="",this.headers=ga,this.params={},this.timeout=os,this.transport=va.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.longpollerTimeout=2e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Ta,this.conn=null,this.sendBuffer=[],this.serializer=new ba,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.endPoint=`${e}/${yr.websocket}`,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.transport&&(this.transport=t.transport),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs),t!=null&&t.longpollerTimeout&&(this.longpollerTimeout=t.longpollerTimeout),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:r=>[1e3,2e3,5e3,1e4][r-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(r,s)=>s(JSON.stringify(r)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ar(()=>ka(this,void 0,void 0,function*(){yield this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this.endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this.onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e)))}disconnect(e,t){return new Promise((r,s)=>{try{this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t||""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset()),r({error:null,data:!0})}catch(i){r({error:i,data:!1})}})}log(e,t,r){this.logger(e,t,r)}onOpen(e){this.stateChangeCallbacks.open.push(e)}onClose(e){this.stateChangeCallbacks.close.push(e)}onError(e){this.stateChangeCallbacks.error.push(e)}onMessage(e){this.stateChangeCallbacks.message.push(e)}connectionState(){switch(this.conn&&this.conn.readyState){case mt.connecting:return Be.Connecting;case mt.open:return Be.Open;case mt.closing:return Be.Closing;default:return Be.Closed}}isConnected(){return this.connectionState()===Be.Open}remove(e){this.channels=this.channels.filter(t=>t.joinRef()!==e.joinRef())}channel(e,t={}){var r;const{selfBroadcast:s}=t,i=Ea(t,["selfBroadcast"]);s&&(i.self_broadcast=s);const o=!((r=this.params)===null||r===void 0)&&r.vsndate?new Rt(e,i,this):new br(e,i,this);return o instanceof Rt&&(o.presence.onJoin((a,l,u)=>{o.trigger("presence",{event:"JOIN",key:a,currentPresences:l,newPresences:u})}),o.presence.onLeave((a,l,u)=>{o.trigger("presence",{event:"LEAVE",key:a,currentPresences:l,leftPresences:u})}),o.presence.onSync(()=>{o.trigger("presence",{event:"SYNC"})})),this.channels.push(o),o}push(e){const{topic:t,event:r,payload:s,ref:i}=e;let o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:o}=t;(o&&o===this.pendingHeartbeatRef||s===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,i),this.channels.filter(a=>a.isMember(r)).forEach(a=>a.trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:wa}))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({user_token:e}),t.joinedOnce&&t.isJoined()&&t.push(ue.access_token,{access_token:e})})}leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r.isJoined()||r.isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_onConnOpen(){this.log("transport",`connected to ${this.endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e.trigger(ue.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(!!this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(ya,"hearbeat timeout");return}this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class Oa{constructor(e,t,r,s){const i={},o=s==="*"?`realtime:${r}`:`realtime:${r}:${s}`,a=t.Authorization.split(" ")[1];a&&(i.user_token=a),this.subscription=e.channel(o,i)}getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Un(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Un(e.columns,e.old_record)),t}on(e,t){return this.subscription.on(e,r=>{let s={schema:r.schema,table:r.table,commit_timestamp:r.commit_timestamp,eventType:r.type,new:{},old:{},errors:r.errors};s=Object.assign(Object.assign({},s),this.getPayloadRecords(r)),t(s)}),this}subscribe(e=()=>{}){return this.subscription.onError(t=>e("SUBSCRIPTION_ERROR",t)),this.subscription.onClose(()=>e("CLOSED")),this.subscription.subscribe().receive("ok",()=>e("SUBSCRIBED")).receive("error",t=>e("SUBSCRIPTION_ERROR",t)).receive("timeout",()=>e("RETRYING_AFTER_TIMEOUT")),this.subscription}}class ja extends ns{constructor(e,{headers:t={},schema:r,realtime:s,table:i,fetch:o,shouldThrowOnError:a}){super(e,{headers:t,schema:r,fetch:o,shouldThrowOnError:a}),this._subscription=null,this._realtime=s,this._headers=t,this._schema=r,this._table=i}on(e,t){return this._realtime.isConnected()||this._realtime.connect(),this._subscription||(this._subscription=new Oa(this._realtime,this._headers,this._schema,this._table)),this._subscription.on(e,t)}}const $a="0.0.0",Pa={"X-Client-Info":`storage-js/${$a}`};var yt=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Ra=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Aa=(n,e)=>{if(typeof n.json!="function")return e(n);n.json().then(t=>e({message:Ra(t),status:(n==null?void 0:n.status)||500}))},Ia=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};function Dt(n,e,t,r,s,i){return yt(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(t,Ia(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?o(l):l.json()}).then(l=>o(l)).catch(l=>Aa(l,a))})})}function kr(n,e,t,r){return yt(this,void 0,void 0,function*(){return Dt(n,"GET",e,t,r)})}function Le(n,e,t,r,s){return yt(this,void 0,void 0,function*(){return Dt(n,"POST",e,r,s,t)})}function Ca(n,e,t,r,s){return yt(this,void 0,void 0,function*(){return Dt(n,"PUT",e,r,s,t)})}function as(n,e,t,r,s){return yt(this,void 0,void 0,function*(){return Dt(n,"DELETE",e,r,s,t)})}const ls=n=>{let e;return n?e=n:typeof fetch=="undefined"?e=Ut:e=fetch,(...t)=>e(...t)};var Ve=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Na{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Pa),t),this.fetch=ls(r)}listBuckets(){return Ve(this,void 0,void 0,function*(){try{return{data:yield kr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}getBucket(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield kr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}createBucket(e,t={public:!1}){return Ve(this,void 0,void 0,function*(){try{return{data:(yield Le(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public},{headers:this.headers})).name,error:null}}catch(r){return{data:null,error:r}}})}updateBucket(e,t){return Ve(this,void 0,void 0,function*(){try{return{data:yield Ca(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public},{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}emptyBucket(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield Le(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}deleteBucket(e){return Ve(this,void 0,void 0,function*(){try{return{data:yield as(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}}var je=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Ua={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Da={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ma{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=ls(s)}uploadOrUpdate(e,t,r,s){return je(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Da),s),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob!="undefined"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",r)):typeof FormData!="undefined"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl)):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType);const l=this._removeEmptyFolders(t),u=this._getFinalPath(l),h=yield this.fetch(`${this.url}/object/${u}`,{method:e,body:i,headers:a});if(h.ok)return{data:{Key:u},error:null};{const c=yield h.json();return{data:null,error:c}}}catch(i){return{data:null,error:i}}})}upload(e,t,r){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}update(e,t,r){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t){return je(this,void 0,void 0,function*(){try{return{data:yield Le(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}copy(e,t){return je(this,void 0,void 0,function*(){try{return{data:yield Le(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}createSignedUrl(e,t){return je(this,void 0,void 0,function*(){try{const r=this._getFinalPath(e);let s=yield Le(this.fetch,`${this.url}/object/sign/${r}`,{expiresIn:t},{headers:this.headers});const i=`${this.url}${s.signedURL}`;return s={signedURL:i},{data:s,error:null,signedURL:i}}catch(r){return{data:null,error:r,signedURL:null}}})}createSignedUrls(e,t){return je(this,void 0,void 0,function*(){try{return{data:(yield Le(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers})).map(s=>Object.assign(Object.assign({},s),{signedURL:s.signedURL?`${this.url}${s.signedURL}`:null})),error:null}}catch(r){return{data:null,error:r}}})}download(e){return je(this,void 0,void 0,function*(){try{const t=this._getFinalPath(e);return{data:yield(yield kr(this.fetch,`${this.url}/object/${t}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(t){return{data:null,error:t}}})}getPublicUrl(e){try{const t=this._getFinalPath(e),r=`${this.url}/object/public/${t}`;return{data:{publicURL:r},error:null,publicURL:r}}catch(t){return{data:null,error:t,publicURL:null}}}remove(e){return je(this,void 0,void 0,function*(){try{return{data:yield as(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}list(e,t,r){return je(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Ua),t),{prefix:e||""});return{data:yield Le(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){return{data:null,error:s}}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}}class Ba extends Na{constructor(e,t={},r){super(e,t,r)}from(e){return new Ma(this.url,this.headers,e,this.fetch)}}const La=n=>{let e;return n?e=n:typeof fetch=="undefined"?e=Ut:e=fetch,(...t)=>e(...t)};var xa=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Fa{constructor(e,{headers:t={},customFetch:r}={}){this.url=e,this.headers=t,this.fetch=La(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t){return xa(this,void 0,void 0,function*(){try{const{headers:r,body:s}=t!=null?t:{},i=yield this.fetch(`${this.url}/${e}`,{method:"POST",headers:Object.assign({},this.headers,r),body:s}),o=i.headers.get("x-relay-error");if(o&&o==="true")return{data:null,error:new Error(yield i.text())};let a;const{responseType:l}=t!=null?t:{};return!l||l==="json"?a=yield i.json():l==="arrayBuffer"?a=yield i.arrayBuffer():l==="blob"?a=yield i.blob():a=yield i.text(),{data:a,error:null}}catch(r){return{data:null,error:r}}})}}var Tt=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Ga={schema:"public",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:rs};class Ha{constructor(e,t,r){if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const s=fo(e),i=Object.assign(Object.assign({},Ga),r);if(this.restUrl=`${s}/rest/v1`,this.realtimeUrl=`${s}/realtime/v1`.replace("http","ws"),this.authUrl=`${s}/auth/v1`,this.storageUrl=`${s}/storage/v1`,s.match(/(supabase\.co)|(supabase\.in)/)){const a=s.split(".");this.functionsUrl=`${a[0]}.functions.${a[1]}.${a[2]}`}else this.functionsUrl=`${s}/functions/v1`;this.schema=i.schema,this.multiTab=i.multiTab,this.fetch=i.fetch,this.headers=Object.assign(Object.assign({},rs),r==null?void 0:r.headers),this.shouldThrowOnError=i.shouldThrowOnError||!1,this.auth=this._initSupabaseAuthClient(i),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},i.realtime)),this._listenForAuthEvents(),this._listenForMultiTabEvents()}get functions(){return new Fa(this.functionsUrl,{headers:this._getAuthHeaders(),customFetch:this.fetch})}get storage(){return new Ba(this.storageUrl,this._getAuthHeaders(),this.fetch)}from(e){const t=`${this.restUrl}/${e}`;return new ja(t,{headers:this._getAuthHeaders(),schema:this.schema,realtime:this.realtime,table:e,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(e,t,{head:r=!1,count:s=null}={}){return this._initPostgRESTClient().rpc(e,t,{head:r,count:s})}channel(e,t){var r,s;const i=(s=(r=this.auth.session())===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:this.supabaseKey;return this.realtime.isConnected()||this.realtime.connect(),this.realtime.channel(e,Object.assign(Object.assign({},t),{user_token:i}))}removeAllSubscriptions(){return Tt(this,void 0,void 0,function*(){const e=this.getSubscriptions().slice(),t=e.map(s=>this.removeSubscription(s));return(yield Promise.all(t)).map(({error:s},i)=>({data:{subscription:e[i]},error:s}))})}removeChannel(e){return Tt(this,void 0,void 0,function*(){const{error:t}=yield this._closeSubscription(e),r=this.getSubscriptions(),s=r.filter(i=>i.isJoined()).length;return r.length===0&&(yield this.realtime.disconnect()),{data:{openChannels:s},error:t}})}removeSubscription(e){return Tt(this,void 0,void 0,function*(){const{error:t}=yield this._closeSubscription(e),r=this.getSubscriptions(),s=r.filter(i=>i.isJoined()).length;return r.length===0&&(yield this.realtime.disconnect()),{data:{openSubscriptions:s},error:t}})}_closeSubscription(e){return Tt(this,void 0,void 0,function*(){let t=null;if(!e.isClosed()){const{error:r}=yield this._unsubscribeSubscription(e);t=r}return this.realtime.remove(e),{error:t}})}_unsubscribeSubscription(e){return new Promise(t=>{e.unsubscribe().receive("ok",()=>t({error:null})).receive("error",r=>t({error:r})).receive("timeout",()=>t({error:new Error("timed out")}))})}getSubscriptions(){return this.realtime.channels}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,localStorage:s,headers:i,fetch:o,cookieOptions:a,multiTab:l}){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Bo({url:this.authUrl,headers:Object.assign(Object.assign({},i),u),autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,localStorage:s,fetch:o,cookieOptions:a,multiTab:l})}_initRealtimeClient(e){return new Sa(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign(Object.assign({},e==null?void 0:e.params),{apikey:this.supabaseKey})}))}_initPostgRESTClient(){return new Ho(this.restUrl,{headers:this._getAuthHeaders(),schema:this.schema,fetch:this.fetch,throwOnError:this.shouldThrowOnError})}_getAuthHeaders(){var e,t;const r=Object.assign({},this.headers),s=(t=(e=this.auth.session())===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey;return r.apikey=this.supabaseKey,r.Authorization=r.Authorization||`Bearer ${s}`,r}_listenForMultiTabEvents(){if(!this.multiTab||!po()||!(window!=null&&window.addEventListener))return null;try{return window==null?void 0:window.addEventListener("storage",e=>{var t,r,s;if(e.key===ho){const i=JSON.parse(String(e.newValue)),o=(r=(t=i==null?void 0:i.currentSession)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:void 0,a=(s=this.auth.session())===null||s===void 0?void 0:s.access_token;o?!a&&o?this._handleTokenChanged("SIGNED_IN",o,"STORAGE"):a!==o&&this._handleTokenChanged("TOKEN_REFRESHED",o,"STORAGE"):this._handleTokenChanged("SIGNED_OUT",o,"STORAGE")}})}catch(e){return console.error("_listenForMultiTabEvents",e),null}}_listenForAuthEvents(){let{data:e}=this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,r==null?void 0:r.access_token,"CLIENT")});return e}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.realtime.setAuth(t),r=="STORAGE"&&this.auth.setAuth(t),this.changedAccessToken=t):(e==="SIGNED_OUT"||e==="USER_DELETED")&&(this.realtime.setAuth(this.supabaseKey),r=="STORAGE"&&this.auth.signOut())}}const qa=(n,e,t)=>new Ha(n,e,t),za="https://dbmtysppmiwwjwaeneex.supabase.co",Ja="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRibXR5c3BwbWl3d2p3YWVuZWV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDQ5NTI0NDUsImV4cCI6MTk2MDUyODQ0NX0.i_1JrAfv5fieeVaiJrVIQPL6V0_-H9sR-PKIuGDAIfI",Fe=qa(za,Ja),Wa=async n=>{const e=await Fe.from("wordgame_wod-questions").select("question,id,category").in("id",n);if(e.error)throw console.log(e.error),new Error("getQuestionText failed");if(e.data)return e.data},xl=async({email:n,password:e})=>{const t=await Fe.auth.signIn({email:n,password:e});if(t.error)throw console.log(t.error),new Error("signIn failed");if(t.user)return!0;throw new Error("no user found")},Va=async n=>{const e=await Fe.from("wordgame_games").select("question_ids").eq("id",n);if(e.error)throw console.log(e.error),new Error("getQuestions failed");if(e.data.length)try{const t=e.data[0].question_ids.split("|").map(s=>+s);return await Wa(t)}catch(t){return t}throw new Error("no questions matching that game id")},Fl=async n=>{const e=await Fe.from("wordgame_games").select("wod_started").eq("id",n);if(e.error)throw console.log(e.error),new Error("getWodStarted failed");if(e.data.length)return e.data[0].wod_started;throw new Error("no games matching this id")},us=async({table:n,column:e,value:t,id:r})=>{const s=await Fe.from(n).update({[e]:t}).eq("id",r);if(s.error)throw console.log(s.error),new Error("update failed");if(s.data)return s.data},Ya=async({table:n,data:e})=>{const t=await Fe.from(n).insert(e);if(t.error)throw console.log(t.error),new Error("insert failed");if(t.data)return t.data},Ka=async({table:n,data:e})=>{const t=await Fe.from(n).upsert(e);if(t.error)throw console.log(t.error),new Error("upsert failed");if(t.data)return t.data};function Dn(n,e,t){const r=n.slice();r[8]=e[t].id,r[9]=e[t].question,r[10]=e[t].category,r[12]=e,r[13]=t;const s=r[10]==="standard";return r[11]=s,r}function Xa(n){let e,t,r,s,i;return{c(){e=w("p"),t=w("button"),r=O("How to Play")},l(o){e=y(o,"P",{});var a=T(e);t=y(a,"BUTTON",{});var l=T(t);r=j(l,"How to Play"),l.forEach(d),a.forEach(d)},m(o,a){$(o,e,a),v(e,t),v(t,r),s||(i=ce(t,"click",n[6]),s=!0)},p:q,d(o){o&&d(e),s=!1,i()}}}function Qa(n){let e,t,r,s;function i(l,u){return l[2]?el:Za}let o=i(n),a=o(n);return{c(){e=w("p"),t=O("Tell us about yourself:"),r=N(),a.c(),s=ae()},l(l){e=y(l,"P",{});var u=T(e);t=j(u,"Tell us about yourself:"),u.forEach(d),r=U(l),a.l(l),s=ae()},m(l,u){$(l,e,u),v(e,t),$(l,r,u),a.m(l,u),$(l,s,u)},p(l,u){o===(o=i(l))&&a?a.p(l,u):(a.d(1),a=o(l),a&&(a.c(),a.m(s.parentNode,s)))},d(l){l&&d(e),l&&d(r),a.d(l),l&&d(s)}}}function Za(n){let e,t,r,s,i,o,a=n[1],l=[];for(let u=0;u<a.length;u+=1)l[u]=Mn(Dn(n,a,u));return{c(){e=w("form");for(let u=0;u<l.length;u+=1)l[u].c();t=N(),r=w("button"),s=O("Submit"),this.h()},l(u){e=y(u,"FORM",{});var h=T(e);for(let p=0;p<l.length;p+=1)l[p].l(h);t=U(h),r=y(h,"BUTTON",{type:!0});var c=T(r);s=j(c,"Submit"),c.forEach(d),h.forEach(d),this.h()},h(){S(r,"type","submit")},m(u,h){$(u,e,h);for(let c=0;c<l.length;c+=1)l[c].m(e,null);v(e,t),v(e,r),v(r,s),i||(o=ce(e,"submit",bs(n[4])),i=!0)},p(u,h){if(h&2){a=u[1];let c;for(c=0;c<a.length;c+=1){const p=Dn(u,a,c);l[c]?l[c].p(p,h):(l[c]=Mn(p),l[c].c(),l[c].m(e,t))}for(;c<l.length;c+=1)l[c].d(1);l.length=a.length}},d(u){u&&d(e),et(l,u),i=!1,o()}}}function el(n){let e,t;return{c(){e=w("p"),t=O("Error")},l(r){e=y(r,"P",{});var s=T(e);t=j(s,"Error"),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},p:q,d(r){r&&d(e)}}}function Mn(n){let e,t,r=n[9]+"",s,i,o,a,l,u,h,c;function p(){n[5].call(a,n[13])}return{c(){e=w("div"),t=w("label"),s=O(r),o=N(),a=w("input"),this.h()},l(_){e=y(_,"DIV",{});var m=T(e);t=y(m,"LABEL",{for:!0});var g=T(t);s=j(g,r),g.forEach(d),o=U(m),a=y(m,"INPUT",{id:!0,placeholder:!0}),m.forEach(d),this.h()},h(){S(t,"for",i="question-"+n[8]),a.required=l=n[11],S(a,"id",u="question-"+n[8]),S(a,"placeholder","")},m(_,m){$(_,e,m),v(e,t),v(t,s),v(e,o),v(e,a),Ot(a,n[1][n[13]].answer),h||(c=ce(a,"input",p),h=!0)},p(_,m){n=_,m&2&&r!==(r=n[9]+"")&&oe(s,r),m&2&&i!==(i="question-"+n[8])&&S(t,"for",i),m&2&&l!==(l=n[11])&&(a.required=l),m&2&&u!==(u="question-"+n[8])&&S(a,"id",u),m&2&&a.value!==n[1][n[13]].answer&&Ot(a,n[1][n[13]].answer)},d(_){_&&d(e),h=!1,c()}}}function tl(n){let e,t,r,s,i,o,a;function l(c,p){return c[0]?Xa:Qa}let u=l(n),h=u(n);return{c(){e=w("h2"),t=O("Welcome, WOD!"),r=N(),s=w("p"),i=O("Let's play a word game!"),o=N(),h.c(),a=ae(),this.h()},l(c){e=y(c,"H2",{class:!0});var p=T(e);t=j(p,"Welcome, WOD!"),p.forEach(d),r=U(c),s=y(c,"P",{});var _=T(s);i=j(_,"Let's play a word game!"),_.forEach(d),o=U(c),h.l(c),a=ae(),this.h()},h(){S(e,"class","svelte-1uepkdw")},m(c,p){$(c,e,p),v(e,t),$(c,r,p),$(c,s,p),v(s,i),$(c,o,p),h.m(c,p),$(c,a,p)},p(c,[p]){u===(u=l(c))&&h?h.p(c,p):(h.d(1),h=u(c),h&&(h.c(),h.m(a.parentNode,a)))},i:q,o:q,d(c){c&&d(e),c&&d(r),c&&d(s),c&&d(o),h.d(c),c&&d(a)}}}function rl(n,e,t){let r,s;x(n,It,c=>t(7,r=c)),x(n,we,c=>t(3,s=c));let{wodReady:i}=e,o=[],a;const l=async()=>{console.log("submit");try{const c=o.map(p=>({game_id:r,question_id:p.id,answer:p.answer}));await Ka({table:"wordgame_wod-info",data:c}),t(0,i=!0),console.log({wodReady:i})}catch(c){console.log(c)}};gt(async()=>{console.log("mount");try{t(1,o=await Va(r))}catch{t(2,a=!0)}});function u(c){o[c].answer=this.value,t(1,o)}const h=()=>{ve(we,s="rules",s)};return n.$$set=c=>{"wodReady"in c&&t(0,i=c.wodReady)},n.$$.update=()=>{n.$$.dirty&1&&console.log({wodReady:i})},[i,o,a,s,l,u,h]}class nl extends Z{constructor(e){super(),ee(this,e,rl,tl,te,{wodReady:0})}}function sl(n){let e,t;return{c(){e=w("p"),t=O(n[1])},l(r){e=y(r,"P",{});var s=T(e);t=j(s,n[1]),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},p(r,s){s&2&&oe(t,r[1])},d(r){r&&d(e)}}}function il(n){let e,t;return{c(){e=w("p"),t=O("Submitting responses...")},l(r){e=y(r,"P",{});var s=T(e);t=j(s,"Submitting responses..."),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},p:q,d(r){r&&d(e)}}}function ol(n){let e,t,r,s;function i(l,u){return l[0]===void 0?il:sl}let o=i(n),a=o(n);return{c(){e=w("h2"),t=O("Thanks for playing!"),r=N(),a.c(),s=ae()},l(l){e=y(l,"H2",{});var u=T(e);t=j(u,"Thanks for playing!"),u.forEach(d),r=U(l),a.l(l),s=ae()},m(l,u){$(l,e,u),v(e,t),$(l,r,u),a.m(l,u),$(l,s,u)},p(l,[u]){o===(o=i(l))&&a?a.p(l,u):(a.d(1),a=o(l),a&&(a.c(),a.m(s.parentNode,s)))},i:q,o:q,d(l){l&&d(e),l&&d(r),a.d(l),l&&d(s)}}}function al(n,e,t){let r,s,i;x(n,It,a=>t(2,s=a)),x(n,Te,a=>t(3,i=a));let o;return gt(async()=>{try{const l=[].concat(...i.user).filter(h=>h.valid).map(h=>({game_id:s,round:h.round,text:h.text,timestamp:h.timestamp,points:h.points,lemmas:h.lemmas}));(await Ya({table:"wordgame_wod-answers",data:l})).length?(t(0,o=!0),await us({table:"wordgame_games",column:"wod_finished",value:!0,id:s})):t(0,o=!1)}catch{t(0,o=!1)}}),n.$$.update=()=>{n.$$.dirty&1&&t(1,r=o?"Game successfully submitted!":"There was an error submitting your game. Please contact admins.")},[o,r]}class ll extends Z{constructor(e){super(),ee(this,e,al,ol,te,{})}}const ul=async n=>{if("clipboard"in navigator)await navigator.clipboard.writeText(n);else{const e=document.createElement("input");e.type="text",e.disabled=!0,e.style.setProperty("position","fixed"),e.style.setProperty("z-index","-100"),e.style.setProperty("pointer-events","none"),e.style.setProperty("opacity","0"),e.value=n,document.body.appendChild(e),e.click(),e.select(),document.execCommand("copy"),document.body.removeChild(e)}},cl=(n,e)=>{async function t(){if(e)try{await ul(e),n.dispatchEvent(new CustomEvent("svelte-copy",{detail:e}))}catch(r){n.dispatchEvent(new CustomEvent("svelte-copy:error",{detail:r}))}}return n.addEventListener("click",t,!0),{update:r=>e=r,destroy:()=>n.removeEventListener("click",t,!0)}};function hl(n){let e,t,r,s,i,o,a,l,u,h,c,p,_;return{c(){e=w("p"),t=O("Use the copy button below, then "),r=w("a"),s=O("click here"),i=O(" to give us feedback!"),o=N(),a=w("textarea"),l=N(),u=w("button"),h=O("Copy to clipboard"),this.h()},l(m){e=y(m,"P",{class:!0});var g=T(e);t=j(g,"Use the copy button below, then "),r=y(g,"A",{href:!0,target:!0});var k=T(r);s=j(k,"click here"),k.forEach(d),i=j(g," to give us feedback!"),g.forEach(d),o=U(m),a=y(m,"TEXTAREA",{style:!0,class:!0}),T(a).forEach(d),l=U(m),u=y(m,"BUTTON",{});var E=T(u);h=j(E,"Copy to clipboard"),E.forEach(d),this.h()},h(){S(r,"href","https://forms.gle/P8npksT5XLE6tFWT8"),S(r,"target","_blank"),S(e,"class","svelte-bkfopd"),ks(a,"width","100%"),a.value=n[0],S(a,"class","svelte-bkfopd")},m(m,g){$(m,e,g),v(e,t),v(e,r),v(r,s),v(e,i),$(m,o,g),$(m,a,g),$(m,l,g),$(m,u,g),v(u,h),p||(_=Es(c=cl.call(null,u,n[0])),p=!0)},p(m,[g]){g&1&&(a.value=m[0]),c&&Ts(c.update)&&g&1&&c.update.call(null,m[0])},i:q,o:q,d(m){m&&d(e),m&&d(o),m&&d(a),m&&d(l),m&&d(u),p=!1,_()}}}function fl(n,e,t){let r,s;return x(n,Te,i=>t(1,s=i)),n.$$.update=()=>{n.$$.dirty&2&&t(0,r=JSON.stringify([].concat(...s.user)))},[r,s]}class dl extends Z{constructor(e){super(),ee(this,e,fl,hl,te,{})}}function Bn(n){let e,t,r,s;const i=[ml,pl],o=[];function a(l,u){return l[3]?0:1}return e=a(n),t=o[e]=i[e](n),{c(){t.c(),r=ae()},l(l){t.l(l),r=ae()},m(l,u){o[e].m(l,u),$(l,r,u),s=!0},p(l,u){let h=e;e=a(l),e===h?o[e].p(l,u):(_e(),G(o[h],1,1,()=>{o[h]=null}),ge(),t=o[e],t?t.p(l,u):(t=o[e]=i[e](l),t.c()),M(t,1),t.m(r.parentNode,r))},i(l){s||(M(t),s=!0)},o(l){G(t),s=!1},d(l){o[e].d(l),l&&d(r)}}}function pl(n){let e,t;return e=new uo({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},p:q,i(r){t||(M(e.$$.fragment,r),t=!0)},o(r){G(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function ml(n){let e,t,r;function s(o){n[10](o)}let i={};return n[1]!==void 0&&(i.wodReady=n[1]),e=new nl({props:i}),Yn.push(()=>Ss(e,"wodReady",s)),{c(){re(e.$$.fragment)},l(o){ne(e.$$.fragment,o)},m(o,a){se(e,o,a),r=!0},p(o,a){const l={};!t&&a&2&&(t=!0,l.wodReady=o[1],Os(()=>t=!1)),e.$set(l)},i(o){r||(M(e.$$.fragment,o),r=!0)},o(o){G(e.$$.fragment,o),r=!1},d(o){ie(e,o)}}}function Ln(n){let e,t;return e=new io({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},i(r){t||(M(e.$$.fragment,r),t=!0)},o(r){G(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function xn(n){let e,t,r,s;const i=[_l,vl],o=[];function a(l,u){return l[3]?0:1}return e=a(n),t=o[e]=i[e](n),{c(){t.c(),r=ae()},l(l){t.l(l),r=ae()},m(l,u){o[e].m(l,u),$(l,r,u),s=!0},p(l,u){let h=e;e=a(l),e!==h&&(_e(),G(o[h],1,1,()=>{o[h]=null}),ge(),t=o[e],t||(t=o[e]=i[e](l),t.c()),M(t,1),t.m(r.parentNode,r))},i(l){s||(M(t),s=!0)},o(l){G(t),s=!1},d(l){o[e].d(l),l&&d(r)}}}function vl(n){let e,t;return e=new dl({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},i(r){t||(M(e.$$.fragment,r),t=!0)},o(r){G(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function _l(n){let e,t;return e=new ll({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},i(r){t||(M(e.$$.fragment,r),t=!0)},o(r){G(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function Fn(n){let e;function t(i,o){return i[0]?wl:gl}let r=t(n),s=r(n);return{c(){e=w("p"),s.c(),this.h()},l(i){e=y(i,"P",{class:!0});var o=T(e);s.l(o),o.forEach(d),this.h()},h(){S(e,"class","svelte-17qdobc")},m(i,o){$(i,e,o),s.m(e,null)},p(i,o){r===(r=t(i))&&s?s.p(i,o):(s.d(1),s=r(i),s&&(s.c(),s.m(e,null)))},d(i){i&&d(e),s.d()}}}function gl(n){let e,t;return{c(){e=w("span"),t=O("loading...")},l(r){e=y(r,"SPAN",{});var s=T(e);t=j(s,"loading..."),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},p:q,d(r){r&&d(e)}}}function wl(n){let e,t,r,s;return{c(){e=w("button"),t=O(n[2])},l(i){e=y(i,"BUTTON",{});var o=T(e);t=j(o,n[2]),o.forEach(d)},m(i,o){$(i,e,o),v(e,t),r||(s=ce(e,"click",n[7]),r=!0)},p(i,o){o&4&&oe(t,i[2])},d(i){i&&d(e),r=!1,s()}}}function Gn(n){let e,t;return e=new Wi({}),e.$on("end",n[8]),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},p:q,i(r){t||(M(e.$$.fragment,r),t=!0)},o(r){G(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function yl(n){let e,t,r,s,i,o,a=n[4]==="pre"&&Bn(n),l=n[4]!=="pre"&&Ln(),u=n[4]==="post"&&xn(n),h=n[6]&&Fn(n),c=n[5]&&Gn(n);return{c(){a&&a.c(),e=N(),l&&l.c(),t=N(),u&&u.c(),r=N(),h&&h.c(),s=N(),c&&c.c(),i=ae()},l(p){a&&a.l(p),e=U(p),l&&l.l(p),t=U(p),u&&u.l(p),r=U(p),h&&h.l(p),s=U(p),c&&c.l(p),i=ae()},m(p,_){a&&a.m(p,_),$(p,e,_),l&&l.m(p,_),$(p,t,_),u&&u.m(p,_),$(p,r,_),h&&h.m(p,_),$(p,s,_),c&&c.m(p,_),$(p,i,_),o=!0},p(p,[_]){p[4]==="pre"?a?(a.p(p,_),_&16&&M(a,1)):(a=Bn(p),a.c(),M(a,1),a.m(e.parentNode,e)):a&&(_e(),G(a,1,1,()=>{a=null}),ge()),p[4]!=="pre"?l?_&16&&M(l,1):(l=Ln(),l.c(),M(l,1),l.m(t.parentNode,t)):l&&(_e(),G(l,1,1,()=>{l=null}),ge()),p[4]==="post"?u?(u.p(p,_),_&16&&M(u,1)):(u=xn(p),u.c(),M(u,1),u.m(r.parentNode,r)):u&&(_e(),G(u,1,1,()=>{u=null}),ge()),p[6]?h?h.p(p,_):(h=Fn(p),h.c(),h.m(s.parentNode,s)):h&&(h.d(1),h=null),p[5]?c?(c.p(p,_),_&32&&M(c,1)):(c=Gn(p),c.c(),M(c,1),c.m(i.parentNode,i)):c&&(_e(),G(c,1,1,()=>{c=null}),ge())},i(p){o||(M(a),M(l),M(u),M(c),o=!0)},o(p){G(a),G(l),G(u),G(c),o=!1},d(p){a&&a.d(p),p&&d(e),l&&l.d(p),p&&d(t),u&&u.d(p),p&&d(r),h&&h.d(p),p&&d(s),c&&c.d(p),p&&d(i)}}}function bl(n,e,t){let r,s,i,o,a,l,u,h;x(n,xe,R=>t(3,o=R)),x(n,Sr,R=>t(4,a=R)),x(n,Ee,R=>t(11,l=R)),x(n,Qe,R=>t(12,u=R)),x(n,It,R=>t(13,h=R));let{loaded:c}=e,p=!1,_;const m={pre:"Begin game",mid:"Next round"},g=()=>{o&&us({table:"wordgame_games",column:"wod_started",value:!0,id:h}),t(5,p=!0)},k=()=>{ve(Qe,u=!0,u),ve(Ee,l+=1,l),t(5,p=!1)};function E(R){_=R,t(1,_)}return n.$$set=R=>{"loaded"in R&&t(0,c=R.loaded)},n.$$.update=()=>{n.$$.dirty&16&&t(2,r=m[a]),n.$$.dirty&26&&t(9,s=o&&a==="pre"&&!_),n.$$.dirty&524&&t(6,i=r&&(!o||!s))},[c,_,r,o,a,p,i,g,k,s,E]}class kl extends Z{constructor(e){super(),ee(this,e,bl,yl,te,{loaded:0})}}async function El(n){const e=`https://pudding.cool/projects/word-game-data/game-clues/${n}.csv?version=${Date.now()}`,r=(await Ct(e)).map(s=>ut(Ne({},s),{round:+s.round}));return r.sort((s,i)=>Ps(s.round,i.round)),r}async function Tl(n){const e=[];for(let t of n){const r=`https://pudding.cool/projects/word-game-data/clue-answers/${t}.csv?version=${Date.now()}`,i=(await Ct(r)).map(o=>ut(Ne({},o),{points:+o.points}));e.push(i)}return e}async function Sl(n){return await(await fetch(n)).json()}function Hn(n){let e,t;return e=new ti({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},i(r){t||(M(e.$$.fragment,r),t=!0)},o(r){G(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function qn(n){let e,t,r;return t=new qi({props:{clues:n[0],answers:n[1]}}),{c(){e=w("section"),re(t.$$.fragment),this.h()},l(s){e=y(s,"SECTION",{id:!0,class:!0});var i=T(e);ne(t.$$.fragment,i),i.forEach(d),this.h()},h(){S(e,"id","play"),S(e,"class","svelte-zc6s8i")},m(s,i){$(s,e,i),se(t,e,null),r=!0},p(s,i){const o={};i&1&&(o.clues=s[0]),i&2&&(o.answers=s[1]),t.$set(o)},i(s){r||(M(t.$$.fragment,s),r=!0)},o(s){G(t.$$.fragment,s),r=!1},d(s){s&&d(e),ie(t)}}}function zn(n){let e,t,r;return t=new kl({props:{loaded:n[2]}}),{c(){e=w("section"),re(t.$$.fragment),this.h()},l(s){e=y(s,"SECTION",{id:!0,class:!0});var i=T(e);ne(t.$$.fragment,i),i.forEach(d),this.h()},h(){S(e,"id","modal"),S(e,"class","svelte-zc6s8i")},m(s,i){$(s,e,i),se(t,e,null),r=!0},p(s,i){const o={};i&4&&(o.loaded=s[2]),t.$set(o)},i(s){r||(M(t.$$.fragment,s),r=!0)},o(s){G(t.$$.fragment,s),r=!1},d(s){s&&d(e),ie(t)}}}function Ol(n){let e,t,r,s,i=n[5]&&Hn(),o=n[4]&&qn(n),a=n[3]&&zn(n);return{c(){i&&i.c(),e=N(),o&&o.c(),t=N(),a&&a.c(),r=ae()},l(l){i&&i.l(l),e=U(l),o&&o.l(l),t=U(l),a&&a.l(l),r=ae()},m(l,u){i&&i.m(l,u),$(l,e,u),o&&o.m(l,u),$(l,t,u),a&&a.m(l,u),$(l,r,u),s=!0},p(l,[u]){l[5]?i?u&32&&M(i,1):(i=Hn(),i.c(),M(i,1),i.m(e.parentNode,e)):i&&(_e(),G(i,1,1,()=>{i=null}),ge()),l[4]?o?(o.p(l,u),u&16&&M(o,1)):(o=qn(l),o.c(),M(o,1),o.m(t.parentNode,t)):o&&(_e(),G(o,1,1,()=>{o=null}),ge()),l[3]?a?(a.p(l,u),u&8&&M(a,1)):(a=zn(l),a.c(),M(a,1),a.m(r.parentNode,r)):a&&(_e(),G(a,1,1,()=>{a=null}),ge())},i(l){s||(M(i),M(o),M(a),s=!0)},o(l){G(i),G(o),G(a),s=!1},d(l){i&&i.d(l),l&&d(e),o&&o.d(l),l&&d(t),a&&a.d(l),l&&d(r)}}}function jl(n,e,t){let r,s,i,o,a,l,u;x(n,Pt,m=>t(5,i=m)),x(n,It,m=>t(8,o=m)),x(n,xe,m=>t(9,a=m)),x(n,Sr,m=>t(6,l=m)),x(n,Qe,m=>t(7,u=m));let h,c,p;const _=async()=>{if(a)return o;const g=`https://pudding.cool/projects/word-game-data/games.json?version=${Date.now()}`,{updated:k,games:E}=await Sl(g);console.log("updated:",k);const{id:R}=E.find(L=>L.live);return R};return gt(async()=>{ve(Pt,i=await _(),i);const m=await El(i);t(0,h=m.map(g=>g.clue)),t(1,c=await Tl(m.map(g=>g.clueId))),t(2,p=!0)}),n.$$.update=()=>{n.$$.dirty&192&&t(4,r=l==="mid"&&u),n.$$.dirty&192&&t(3,s=!u||["pre","post"].includes(l))},[h,c,p,s,r,i,l,u]}class $l extends Z{constructor(e){super(),ee(this,e,jl,Ol,te,{})}}function Pl(n){let e,t,r,s,i,o,a,l,u,h,c,p,_,m,g,k,E,R,L,W,B,A,F,D,J,K,I,z,P,f,b,C,Y,V,H,ye,de,Se,Mt,Bt,Ge,tt,Lt,xt,Ft,He,rt,Gt,Ht,qt,nt,zt,Jt,be,st,Wt,Vt,it,Yt,Kt,ot,Xt,Qt,at,Zt,er,lt,qe,tr,rr,Ir;return{c(){e=w("section"),t=w("div"),r=w("h3"),s=O("How to Play"),i=N(),o=w("ul"),a=w("li"),l=w("strong"),u=O("Goal:"),h=O(" score more points than the Word Opponent of the Day (WOD)."),c=N(),p=w("li"),_=w("strong"),m=O("Duration:"),g=O(" Four one-minute rounds."),k=N(),E=w("li"),R=w("strong"),L=O("Gameplay:"),W=O(` Enter as many words as possible that satisfy a clue.
        `),B=w("ul"),A=w("li"),F=w("strong"),D=O("Sample clue"),J=O(": "),K=w("em"),I=O("words that start with "),z=w("strong"),P=O("A"),f=O(`
            . Answers: `),b=w("em"),C=O("apple"),Y=O(", "),V=w("em"),H=O("awesome"),ye=O(", "),de=w("em"),Se=O("activate"),Mt=O(", etc."),Bt=N(),Ge=w("li"),tt=w("strong"),Lt=O("Blocking!"),xt=O(` Whoever gets a word first gets points. If the WOD entered the
            word before you, you get no points. If you enter a word before the WOD, she gets no points.`),Ft=N(),He=w("li"),rt=w("strong"),Gt=O("The more obscure the better!"),Ht=O(` You get more points for less commonly used
            words.`),qt=N(),nt=w("h3"),zt=O("Rules"),Jt=N(),be=w("ul"),st=w("li"),Wt=O("4+ letter words"),Vt=N(),it=w("li"),Yt=O("No proper nouns"),Kt=N(),ot=w("li"),Xt=O("No hyphenated words"),Qt=N(),at=w("li"),Zt=O("No variations (e.g. plurals) of a played word"),er=N(),lt=w("p"),qe=w("button"),tr=O("CLOSE"),this.h()},l(Ce){e=y(Ce,"SECTION",{class:!0});var ze=T(e);t=y(ze,"DIV",{class:!0});var Oe=T(t);r=y(Oe,"H3",{});var Cr=T(r);s=j(Cr,"How to Play"),Cr.forEach(d),i=U(Oe),o=y(Oe,"UL",{});var Je=T(o);a=y(Je,"LI",{});var nr=T(a);l=y(nr,"STRONG",{});var Nr=T(l);u=j(Nr,"Goal:"),Nr.forEach(d),h=j(nr," score more points than the Word Opponent of the Day (WOD)."),nr.forEach(d),c=U(Je),p=y(Je,"LI",{});var sr=T(p);_=y(sr,"STRONG",{});var Ur=T(_);m=j(Ur,"Duration:"),Ur.forEach(d),g=j(sr," Four one-minute rounds."),sr.forEach(d),k=U(Je),E=y(Je,"LI",{});var bt=T(E);R=y(bt,"STRONG",{});var Dr=T(R);L=j(Dr,"Gameplay:"),Dr.forEach(d),W=j(bt,` Enter as many words as possible that satisfy a clue.
        `),B=y(bt,"UL",{});var We=T(B);A=y(We,"LI",{});var ke=T(A);F=y(ke,"STRONG",{});var Mr=T(F);D=j(Mr,"Sample clue"),Mr.forEach(d),J=j(ke,": "),K=y(ke,"EM",{});var ir=T(K);I=j(ir,"words that start with "),z=y(ir,"STRONG",{});var Br=T(z);P=j(Br,"A"),Br.forEach(d),ir.forEach(d),f=j(ke,`
            . Answers: `),b=y(ke,"EM",{});var Lr=T(b);C=j(Lr,"apple"),Lr.forEach(d),Y=j(ke,", "),V=y(ke,"EM",{});var xr=T(V);H=j(xr,"awesome"),xr.forEach(d),ye=j(ke,", "),de=y(ke,"EM",{});var Fr=T(de);Se=j(Fr,"activate"),Fr.forEach(d),Mt=j(ke,", etc."),ke.forEach(d),Bt=U(We),Ge=y(We,"LI",{});var or=T(Ge);tt=y(or,"STRONG",{});var Gr=T(tt);Lt=j(Gr,"Blocking!"),Gr.forEach(d),xt=j(or,` Whoever gets a word first gets points. If the WOD entered the
            word before you, you get no points. If you enter a word before the WOD, she gets no points.`),or.forEach(d),Ft=U(We),He=y(We,"LI",{});var ar=T(He);rt=y(ar,"STRONG",{});var Hr=T(rt);Gt=j(Hr,"The more obscure the better!"),Hr.forEach(d),Ht=j(ar,` You get more points for less commonly used
            words.`),ar.forEach(d),We.forEach(d),bt.forEach(d),Je.forEach(d),qt=U(Oe),nt=y(Oe,"H3",{});var qr=T(nt);zt=j(qr,"Rules"),qr.forEach(d),Jt=U(Oe),be=y(Oe,"UL",{});var Re=T(be);st=y(Re,"LI",{});var zr=T(st);Wt=j(zr,"4+ letter words"),zr.forEach(d),Vt=U(Re),it=y(Re,"LI",{});var Jr=T(it);Yt=j(Jr,"No proper nouns"),Jr.forEach(d),Kt=U(Re),ot=y(Re,"LI",{});var Wr=T(ot);Xt=j(Wr,"No hyphenated words"),Wr.forEach(d),Qt=U(Re),at=y(Re,"LI",{});var Vr=T(at);Zt=j(Vr,"No variations (e.g. plurals) of a played word"),Vr.forEach(d),Re.forEach(d),er=U(Oe),lt=y(Oe,"P",{});var Yr=T(lt);qe=y(Yr,"BUTTON",{});var Kr=T(qe);tr=j(Kr,"CLOSE"),Kr.forEach(d),Yr.forEach(d),Oe.forEach(d),ze.forEach(d),this.h()},h(){S(t,"class","svelte-5rby5g"),S(e,"class","svelte-5rby5g"),me(e,"visible",n[0]==="rules")},m(Ce,ze){$(Ce,e,ze),v(e,t),v(t,r),v(r,s),v(t,i),v(t,o),v(o,a),v(a,l),v(l,u),v(a,h),v(o,c),v(o,p),v(p,_),v(_,m),v(p,g),v(o,k),v(o,E),v(E,R),v(R,L),v(E,W),v(E,B),v(B,A),v(A,F),v(F,D),v(A,J),v(A,K),v(K,I),v(K,z),v(z,P),v(A,f),v(A,b),v(b,C),v(A,Y),v(A,V),v(V,H),v(A,ye),v(A,de),v(de,Se),v(A,Mt),v(B,Bt),v(B,Ge),v(Ge,tt),v(tt,Lt),v(Ge,xt),v(B,Ft),v(B,He),v(He,rt),v(rt,Gt),v(He,Ht),v(t,qt),v(t,nt),v(nt,zt),v(t,Jt),v(t,be),v(be,st),v(st,Wt),v(be,Vt),v(be,it),v(it,Yt),v(be,Kt),v(be,ot),v(ot,Xt),v(be,Qt),v(be,at),v(at,Zt),v(t,er),v(t,lt),v(lt,qe),v(qe,tr),rr||(Ir=[ce(qe,"click",n[1]),ce(e,"click",n[1])],rr=!0)},p(Ce,[ze]){ze&1&&me(e,"visible",Ce[0]==="rules")},i:q,o:q,d(Ce){Ce&&d(e),rr=!1,_t(Ir)}}}function Rl(n,e,t){let r;return x(n,we,i=>t(0,r=i)),[r,()=>{ve(we,r=void 0,r)}]}class Al extends Z{constructor(e){super(),ee(this,e,Rl,Pl,te,{})}}function Il(n){let e,t,r,s,i,o,a,l,u,h;return{c(){e=w("section"),t=w("div"),r=w("h3"),s=O("About"),i=N(),o=w("p"),a=w("button"),l=O("CLOSE"),this.h()},l(c){e=y(c,"SECTION",{class:!0});var p=T(e);t=y(p,"DIV",{class:!0});var _=T(t);r=y(_,"H3",{});var m=T(r);s=j(m,"About"),m.forEach(d),i=U(_),o=y(_,"P",{});var g=T(o);a=y(g,"BUTTON",{});var k=T(a);l=j(k,"CLOSE"),k.forEach(d),g.forEach(d),_.forEach(d),p.forEach(d),this.h()},h(){S(t,"class","svelte-5rby5g"),S(e,"class","svelte-5rby5g"),me(e,"visible",n[0]==="about")},m(c,p){$(c,e,p),v(e,t),v(t,r),v(r,s),v(t,i),v(t,o),v(o,a),v(a,l),u||(h=[ce(a,"click",n[1]),ce(e,"click",n[1])],u=!0)},p(c,[p]){p&1&&me(e,"visible",c[0]==="about")},i:q,o:q,d(c){c&&d(e),u=!1,_t(h)}}}function Cl(n,e,t){let r;return x(n,we,i=>t(0,r=i)),[r,()=>{ve(we,r=void 0,r)}]}class Nl extends Z{constructor(e){super(),ee(this,e,Cl,Il,te,{})}}function Ul(n){let e,t,r,s,i,o,a,l;return e=new Qs({}),r=new $l({}),i=new Al({}),a=new Nl({}),{c(){re(e.$$.fragment),t=N(),re(r.$$.fragment),s=N(),re(i.$$.fragment),o=N(),re(a.$$.fragment)},l(u){ne(e.$$.fragment,u),t=U(u),ne(r.$$.fragment,u),s=U(u),ne(i.$$.fragment,u),o=U(u),ne(a.$$.fragment,u)},m(u,h){se(e,u,h),$(u,t,h),se(r,u,h),$(u,s,h),se(i,u,h),$(u,o,h),se(a,u,h),l=!0},p:q,i(u){l||(M(e.$$.fragment,u),M(r.$$.fragment,u),M(i.$$.fragment,u),M(a.$$.fragment,u),l=!0)},o(u){G(e.$$.fragment,u),G(r.$$.fragment,u),G(i.$$.fragment,u),G(a.$$.fragment,u),l=!1},d(u){ie(e,u),u&&d(t),ie(r,u),u&&d(s),ie(i,u),u&&d(o),ie(a,u)}}}class Gl extends Z{constructor(e){super(),ee(this,e,null,Ul,te,{})}}export{Gl as A,Ll as M,xe as a,Fl as g,xl as s,It as w};

var cs=Object.defineProperty,hs=Object.defineProperties;var fs=Object.getOwnPropertyDescriptors;var Xr=Object.getOwnPropertySymbols;var ds=Object.prototype.hasOwnProperty,ps=Object.prototype.propertyIsEnumerable;var Qr=(n,e,t)=>e in n?cs(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ne=(n,e)=>{for(var t in e||(e={}))ds.call(e,t)&&Qr(n,t,e[t]);if(Xr)for(var t of Xr(e))ps.call(e,t)&&Qr(n,t,e[t]);return n},ht=(n,e)=>hs(n,fs(e));import{S as Z,i as ee,s as te,e as y,c as b,b as S,g as $,d,l as oe,N as ms,M as v,E as q,O as rt,t as O,k as C,a as T,h as j,m as I,P as ce,G as wt,Q as x,R as me,v as yt,C as Zr,T as vs,U as _s,V as Jn,j as le,W as gs,X as _e,q as D,n as ge,o as F,p as we,w as re,x as ne,y as se,B as ie,Y as ws,Z as ys,_ as kr,$ as Wn,a0 as Vn,a1 as $t,a2 as Yn,a3 as bs,f as ks,a4 as Es,H as Ts,a5 as Ss,a6 as Os}from"./index-5fe9b45c.js";import{d as Ct,w as $e}from"./index-0e2bbb5e.js";function en(n,e,t){const r=n.slice();return r[5]=e[t],r}function tn(n){let e,t;return{c(){e=y("link"),this.h()},l(r){e=b(r,"LINK",{rel:!0,href:!0,as:!0,type:!0,crossorigin:!0}),this.h()},h(){S(e,"rel","preload"),S(e,"href",t=n[5]),S(e,"as","font"),S(e,"type","font/woff2"),S(e,"crossorigin","")},m(r,s){$(r,e,s)},p(r,s){s&16&&t!==(t=r[5])&&S(e,"href",t)},d(r){r&&d(e)}}}function js(n){let e,t,r,s,i,o,a,l,u,h,c,p,_,m,g,k,E,P,L,W,B,R,G,U,J,K;document.title=e=n[0];let A=n[4],z=[];for(let M=0;M<A.length;M+=1)z[M]=tn(en(n,A,M));return{c(){t=y("meta"),r=y("meta"),s=y("meta"),i=y("meta"),o=y("meta"),a=y("meta"),l=y("meta"),u=y("meta"),h=y("meta"),c=y("meta"),_=y("meta"),m=y("meta"),g=y("meta"),k=y("meta"),E=y("meta"),P=y("meta"),L=y("meta"),W=y("meta"),B=y("meta"),G=y("meta"),U=y("link");for(let M=0;M<z.length;M+=1)z[M].c();K=oe(),this.h()},l(M){const f=ms('[data-svelte="svelte-1ad9fm2"]',document.head);t=b(f,"META",{name:!0,content:!0}),r=b(f,"META",{name:!0,content:!0}),s=b(f,"META",{name:!0,content:!0}),i=b(f,"META",{property:!0,content:!0}),o=b(f,"META",{property:!0,content:!0}),a=b(f,"META",{property:!0,content:!0}),l=b(f,"META",{property:!0,content:!0}),u=b(f,"META",{property:!0,content:!0}),h=b(f,"META",{property:!0,content:!0}),c=b(f,"META",{property:!0,content:!0}),_=b(f,"META",{property:!0,content:!0}),m=b(f,"META",{property:!0,content:!0}),g=b(f,"META",{property:!0,content:!0}),k=b(f,"META",{name:!0,content:!0}),E=b(f,"META",{name:!0,content:!0}),P=b(f,"META",{name:!0,content:!0}),L=b(f,"META",{name:!0,content:!0}),W=b(f,"META",{name:!0,content:!0}),B=b(f,"META",{name:!0,content:!0}),G=b(f,"META",{name:!0,content:!0}),U=b(f,"LINK",{rel:!0,href:!0});for(let w=0;w<z.length;w+=1)z[w].l(f);K=oe(),f.forEach(d),this.h()},h(){S(t,"name","description"),S(t,"content",n[1]),S(r,"name","author"),S(r,"content","The Pudding"),S(s,"name","news_keywords"),S(s,"content",n[3]),S(i,"property","og:title"),S(i,"content",n[0]),S(o,"property","og:site_name"),S(o,"content","The Pudding"),S(a,"property","og:url"),S(a,"content",n[2]),S(l,"property","og:description"),S(l,"content",n[1]),S(u,"property","og:type"),S(u,"content","article"),S(h,"property","og:locale"),S(h,"content","en_US"),S(c,"property","og:image"),S(c,"content",p=n[2]+"/assets/social-facebook.jpg"),S(_,"property","og:image:type"),S(_,"content","image/jpeg"),S(m,"property","og:image:width"),S(m,"content","1200"),S(g,"property","og:image:height"),S(g,"content","600"),S(k,"name","twitter:card"),S(k,"content","summary_large_image"),S(E,"name","twitter:site"),S(E,"content","https://pudding.cool"),S(P,"name","twitter:creator"),S(P,"content","@puddingviz"),S(L,"name","twitter:title"),S(L,"content",n[0]),S(W,"name","twitter:description"),S(W,"content",n[1]),S(B,"name","twitter:image:src"),S(B,"content",R=n[2]+"/assets/social-twitter.jpg"),S(G,"name","robots"),S(G,"content","max-image-preview:large"),S(U,"rel","canonical"),S(U,"href",J=n[2]+"/")},m(M,f){v(document.head,t),v(document.head,r),v(document.head,s),v(document.head,i),v(document.head,o),v(document.head,a),v(document.head,l),v(document.head,u),v(document.head,h),v(document.head,c),v(document.head,_),v(document.head,m),v(document.head,g),v(document.head,k),v(document.head,E),v(document.head,P),v(document.head,L),v(document.head,W),v(document.head,B),v(document.head,G),v(document.head,U);for(let w=0;w<z.length;w+=1)z[w].m(document.head,null);v(document.head,K)},p(M,[f]){if(f&1&&e!==(e=M[0])&&(document.title=e),f&2&&S(t,"content",M[1]),f&8&&S(s,"content",M[3]),f&1&&S(i,"content",M[0]),f&4&&S(a,"content",M[2]),f&2&&S(l,"content",M[1]),f&4&&p!==(p=M[2]+"/assets/social-facebook.jpg")&&S(c,"content",p),f&1&&S(L,"content",M[0]),f&2&&S(W,"content",M[1]),f&4&&R!==(R=M[2]+"/assets/social-twitter.jpg")&&S(B,"content",R),f&4&&J!==(J=M[2]+"/")&&S(U,"href",J),f&16){A=M[4];let w;for(w=0;w<A.length;w+=1){const N=en(M,A,w);z[w]?z[w].p(N,f):(z[w]=tn(N),z[w].c(),z[w].m(K.parentNode,K))}for(;w<z.length;w+=1)z[w].d(1);z.length=A.length}},i:q,o:q,d(M){d(t),d(r),d(s),d(i),d(o),d(a),d(l),d(u),d(h),d(c),d(_),d(m),d(g),d(k),d(E),d(P),d(L),d(W),d(B),d(G),d(U),rt(z,M),d(K)}}}function $s(n,e,t){let{title:r="Title TK"}=e,{description:s="Description TK"}=e,{url:i="https://pudding.cool"}=e,{keywords:o=""}=e,{preloadFont:a=[]}=e;return n.$$set=l=>{"title"in l&&t(0,r=l.title),"description"in l&&t(1,s=l.description),"url"in l&&t(2,i=l.url),"keywords"in l&&t(3,o=l.keywords),"preloadFont"in l&&t(4,a=l.preloadFont)},[r,s,i,o,a]}class Bl extends Z{constructor(e){super(),ee(this,e,$s,js,te,{title:0,description:1,url:2,keywords:3,preloadFont:4})}}function Ps(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function Rs(n,e,t){n=+n,e=+e,t=(s=arguments.length)<2?(e=n,n=0,1):s<3?1:+t;for(var r=-1,s=Math.max(0,Math.ceil((e-n)/t))|0,i=new Array(s);++r<s;)i[r]=n+r*t;return i}var As=Cs(Math.random);function Cs(n){return function(t,r=0,s=t.length){let i=s-(r=+r);for(;i;){const o=n()*i--|0,a=t[i+r];t[i+r]=t[o+r],t[o+r]=a}return t}}function hr(n,e){let t=0;if(e===void 0)for(let r of n)(r=+r)&&(t+=r);else{let r=-1;for(let s of n)(s=+e(s,++r,n))&&(t+=s)}return t}var rn={},or={},ar=34,ft=10,lr=13;function Kn(n){return new Function("d","return {"+n.map(function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'}).join(",")+"}")}function Is(n,e){var t=Kn(n);return function(r,s){return e(t(r),s,n)}}function nn(n){var e=Object.create(null),t=[];return n.forEach(function(r){for(var s in r)s in e||t.push(e[s]=s)}),t}function pe(n,e){var t=n+"",r=t.length;return r<e?new Array(e-r+1).join(0)+t:t}function Ns(n){return n<0?"-"+pe(-n,6):n>9999?"+"+pe(n,6):pe(n,4)}function Us(n){var e=n.getUTCHours(),t=n.getUTCMinutes(),r=n.getUTCSeconds(),s=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":Ns(n.getUTCFullYear())+"-"+pe(n.getUTCMonth()+1,2)+"-"+pe(n.getUTCDate(),2)+(s?"T"+pe(e,2)+":"+pe(t,2)+":"+pe(r,2)+"."+pe(s,3)+"Z":r?"T"+pe(e,2)+":"+pe(t,2)+":"+pe(r,2)+"Z":t||e?"T"+pe(e,2)+":"+pe(t,2)+"Z":"")}function Ds(n){var e=new RegExp('["'+n+`
\r]`),t=n.charCodeAt(0);function r(c,p){var _,m,g=s(c,function(k,E){if(_)return _(k,E-1);m=k,_=p?Is(k,p):Kn(k)});return g.columns=m||[],g}function s(c,p){var _=[],m=c.length,g=0,k=0,E,P=m<=0,L=!1;c.charCodeAt(m-1)===ft&&--m,c.charCodeAt(m-1)===lr&&--m;function W(){if(P)return or;if(L)return L=!1,rn;var R,G=g,U;if(c.charCodeAt(G)===ar){for(;g++<m&&c.charCodeAt(g)!==ar||c.charCodeAt(++g)===ar;);return(R=g)>=m?P=!0:(U=c.charCodeAt(g++))===ft?L=!0:U===lr&&(L=!0,c.charCodeAt(g)===ft&&++g),c.slice(G+1,R-1).replace(/""/g,'"')}for(;g<m;){if((U=c.charCodeAt(R=g++))===ft)L=!0;else if(U===lr)L=!0,c.charCodeAt(g)===ft&&++g;else if(U!==t)continue;return c.slice(G,R)}return P=!0,c.slice(G,m)}for(;(E=W())!==or;){for(var B=[];E!==rn&&E!==or;)B.push(E),E=W();p&&(B=p(B,k++))==null||_.push(B)}return _}function i(c,p){return c.map(function(_){return p.map(function(m){return h(_[m])}).join(n)})}function o(c,p){return p==null&&(p=nn(c)),[p.map(h).join(n)].concat(i(c,p)).join(`
`)}function a(c,p){return p==null&&(p=nn(c)),i(c,p).join(`
`)}function l(c){return c.map(u).join(`
`)}function u(c){return c.map(h).join(n)}function h(c){return c==null?"":c instanceof Date?Us(c):e.test(c+="")?'"'+c.replace(/"/g,'""')+'"':c}return{parse:r,parseRows:s,format:o,formatBody:a,formatRows:l,formatRow:u,formatValue:h}}var Ms=Ds(","),Bs=Ms.parse;function Ls(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Pt(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,r=n.slice(0,t);return[r.length>1?r[0]+r.slice(2):r,+n.slice(t+1)]}function xs(n){return n=Pt(Math.abs(n)),n?n[1]:NaN}function Fs(n,e){return function(t,r){for(var s=t.length,i=[],o=0,a=n[0],l=0;s>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),i.push(t.substring(s-=a,s+a)),!((l+=a+1)>r));)a=n[o=(o+1)%n.length];return i.reverse().join(e)}}function Gs(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var Hs=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function fr(n){if(!(e=Hs.exec(n)))throw new Error("invalid format: "+n);var e;return new Er({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}fr.prototype=Er.prototype;function Er(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}Er.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function qs(n){e:for(var e=n.length,t=1,r=-1,s;t<e;++t)switch(n[t]){case".":r=s=t;break;case"0":r===0&&(r=t),s=t;break;default:if(!+n[t])break e;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(s+1):n}var Xn;function zs(n,e){var t=Pt(n,e);if(!t)return n+"";var r=t[0],s=t[1],i=s-(Xn=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Pt(n,Math.max(0,e+i-1))[0]}function sn(n,e){var t=Pt(n,e);if(!t)return n+"";var r=t[0],s=t[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}var on={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:Ls,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>sn(n*100,e),r:sn,s:zs,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function an(n){return n}var ln=Array.prototype.map,un=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Js(n){var e=n.grouping===void 0||n.thousands===void 0?an:Fs(ln.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",s=n.decimal===void 0?".":n.decimal+"",i=n.numerals===void 0?an:Gs(ln.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"\u2212":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function u(c){c=fr(c);var p=c.fill,_=c.align,m=c.sign,g=c.symbol,k=c.zero,E=c.width,P=c.comma,L=c.precision,W=c.trim,B=c.type;B==="n"?(P=!0,B="g"):on[B]||(L===void 0&&(L=12),W=!0,B="g"),(k||p==="0"&&_==="=")&&(k=!0,p="0",_="=");var R=g==="$"?t:g==="#"&&/[boxX]/.test(B)?"0"+B.toLowerCase():"",G=g==="$"?r:/[%p]/.test(B)?o:"",U=on[B],J=/[defgprs%]/.test(B);L=L===void 0?6:/[gprs]/.test(B)?Math.max(1,Math.min(21,L)):Math.max(0,Math.min(20,L));function K(A){var z=R,M=G,f,w,N;if(B==="c")M=U(A)+M,A="";else{A=+A;var V=A<0||1/A<0;if(A=isNaN(A)?l:U(Math.abs(A),L),W&&(A=qs(A)),V&&+A==0&&m!=="+"&&(V=!1),z=(V?m==="("?m:a:m==="-"||m==="("?"":m)+z,M=(B==="s"?un[8+Xn/3]:"")+M+(V&&m==="("?")":""),J){for(f=-1,w=A.length;++f<w;)if(N=A.charCodeAt(f),48>N||N>57){M=(N===46?s+A.slice(f+1):A.slice(f))+M,A=A.slice(0,f);break}}}P&&!k&&(A=e(A,1/0));var Y=z.length+A.length+M.length,H=Y<E?new Array(E-Y+1).join(p):"";switch(P&&k&&(A=e(H+A,H.length?E-M.length:1/0),H=""),_){case"<":A=z+A+M+H;break;case"=":A=z+H+A+M;break;case"^":A=H.slice(0,Y=H.length>>1)+z+A+M+H.slice(Y);break;default:A=H+z+A+M;break}return i(A)}return K.toString=function(){return c+""},K}function h(c,p){var _=u((c=fr(c),c.type="f",c)),m=Math.max(-8,Math.min(8,Math.floor(xs(p)/3)))*3,g=Math.pow(10,-m),k=un[8+m/3];return function(E){return _(g*E)+k}}return{format:u,formatPrefix:h}}var ur,Qn;Ws({thousands:",",grouping:[3],currency:["$",""]});function Ws(n){return ur=Js(n),Qn=ur.format,ur}function pt(n,e,t){this.k=n,this.x=e,this.y=t}pt.prototype={constructor:pt,scale:function(n){return n===1?this:new pt(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new pt(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new pt(1,0,0);const Rt=4,cn=()=>Rs(Rt).map(()=>[]),hn=n=>hr(n.filter(e=>e.valid),e=>e.points),dr=$e(),et=$e(!1),Ee=$e(-1),Tr=Ct([Ee,et],([n,e],t)=>{n>=Rt-1&&!e?t("post"):t(!e&&n===-1?"pre":"mid")}),Te=$e({user:cn(),opponent:cn()}),pr=$e([]),Vs=Ct(Te,(n,e)=>{const t=n.user.map(hn),r=n.opponent.map(hn);e({user:t,opponent:r})}),Sr=Ct(Vs,(n,e)=>{const t=hr(n.user),r=hr(n.opponent);e({user:t,opponent:r})}),Ys=n=>[].concat(...n),fn=n=>{const e=n.filter(t=>t.valid).map(t=>t.lemmas.split("|"));return Ys(e)},Or=Ct([Te,Ee],([n,e],t)=>{if(e<0)return;const r=fn(n.user[e]),s=fn(n.opponent[e]),i=[...r,...s];t(i)}),ye=$e(void 0),xe=$e(void 0),It=$e(void 0);function Ks(n){let e,t,r,s,i,o,a,l,u,h,c;return{c(){e=y("nav"),t=y("button"),r=O("Hamburger"),s=C(),i=y("button"),o=O("Rules"),a=C(),l=y("button"),u=O("About"),this.h()},l(p){e=b(p,"NAV",{class:!0});var _=T(e);t=b(_,"BUTTON",{});var m=T(t);r=j(m,"Hamburger"),m.forEach(d),s=I(_),i=b(_,"BUTTON",{});var g=T(i);o=j(g,"Rules"),g.forEach(d),a=I(_),l=b(_,"BUTTON",{});var k=T(l);u=j(k,"About"),k.forEach(d),_.forEach(d),this.h()},h(){S(e,"class","svelte-bz9c25")},m(p,_){$(p,e,_),v(e,t),v(t,r),v(e,s),v(e,i),v(i,o),v(e,a),v(e,l),v(l,u),h||(c=[ce(t,"click",n[1]),ce(i,"click",n[2]),ce(l,"click",n[3])],h=!0)},p:q,i:q,o:q,d(p){p&&d(e),h=!1,wt(c)}}}function Xs(n,e,t){let r;return x(n,ye,a=>t(0,r=a)),[r,()=>{me(ye,r="hamburger",r)},()=>{me(ye,r="rules",r)},()=>{me(ye,r="about",r)}]}class Qs extends Z{constructor(e){super(),ee(this,e,Xs,Ks,te,{})}}let Ue,mt;const tt=$e(0),Zn=n=>{mt||(mt=n);const e=Math.round(n-mt);mt=n,tt.update(t=>t+e),Ue=window.requestAnimationFrame(Zn)},vt={start(){Ue||(mt=null,Ue=window.requestAnimationFrame(Zn))},stop(){Ue&&(window.cancelAnimationFrame(Ue),Ue=null)},toggle(){Ue?vt.stop():vt.start()},set(n){typeof n=="number"&&tt.set(n)},reset(){tt.set(0)}},jt=({lemmas:n,corpus:e})=>!!n.split("|").filter(r=>!!e.find(s=>s===r)).length;async function jr(n){const t=await(await fetch(n)).text();return Bs(t)}async function Zs(n){const e=`https://pudding.cool/projects/word-game-data/wod-answers/${n}.csv?version=${Date.now()}`;return(await jr(e)).map(s=>ht(Ne({},s),{round:+s.round,timestamp:+s.timestamp,points:+s.points}))}function ei(n,e,t){let r,s,i,o,a;x(n,dr,p=>t(2,r=p)),x(n,Ee,p=>t(3,s=p)),x(n,Te,p=>t(4,i=p)),x(n,tt,p=>t(0,o=p)),x(n,Or,p=>t(5,a=p));let l=[];const u=p=>jt({lemmas:p,corpus:a}),h=({lemmas:p})=>{const _=!u(p);return{valid:_,reason:_?void 0:0}},c=()=>{const p=l.findIndex(_=>_.round===s&&o>=_.timestamp);if(p>-1){const[_]=l.splice(p,1),m=Ne(Ne({},_),h(_));me(Te,i.opponent[s]=[...i.opponent[s],m],i)}};return yt(async()=>{l=await Zs(r)}),n.$$.update=()=>{n.$$.dirty&1&&c()},[o]}class ti extends Z{constructor(e){super(),ee(this,e,ei,null,te,{})}}function dn(n){return Object.prototype.toString.call(n)==="[object Date]"}function mr(n,e){if(n===e||n!==n)return()=>n;const t=typeof n;if(t!==typeof e||Array.isArray(n)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(n)){const r=e.map((s,i)=>mr(n[i],s));return s=>r.map(i=>i(s))}if(t==="object"){if(!n||!e)throw new Error("Object cannot be null");if(dn(n)&&dn(e)){n=n.getTime(),e=e.getTime();const i=e-n;return o=>new Date(n+o*i)}const r=Object.keys(e),s={};return r.forEach(i=>{s[i]=mr(n[i],e[i])}),i=>{const o={};return r.forEach(a=>{o[a]=s[a](i)}),o}}if(t==="number"){const r=e-n;return s=>n+s*r}throw new Error(`Cannot interpolate ${t} values`)}function es(n,e={}){const t=$e(n);let r,s=n;function i(o,a){if(n==null)return t.set(n=o),Promise.resolve();s=o;let l=r,u=!1,{delay:h=0,duration:c=400,easing:p=Jn,interpolate:_=mr}=Zr(Zr({},e),a);if(c===0)return l&&(l.abort(),l=null),t.set(n=s),Promise.resolve();const m=vs()+h;let g;return r=_s(k=>{if(k<m)return!0;u||(g=_(n,o),typeof c=="function"&&(c=c(n,o)),u=!0),l&&(l.abort(),l=null);const E=k-m;return E>c?(t.set(n=o),!1):(t.set(n=g(p(E/c))),!0)}),r.promise}return{set:i,update:(o,a)=>i(o(s,n),a),subscribe:t.subscribe}}function ri(n,{delay:e=0,duration:t=400,easing:r=Jn}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:i=>`opacity: ${i*s}`}}function pn(n){let e,t,r,s;return{c(){e=y("span"),t=O(n[2]),this.h()},l(i){e=b(i,"SPAN",{class:!0});var o=T(e);t=j(o,n[2]),o.forEach(d),this.h()},h(){S(e,"class","svelte-xlb350")},m(i,o){$(i,e,o),v(e,t),s=!0},p(i,o){(!s||o&4)&&le(t,i[2])},i(i){s||(r&&r.end(1),s=!0)},o(i){r=gs(e,ri,{}),s=!1},d(i){i&&d(e),i&&r&&r.end()}}}function ni(n){let e,t,r,s,i=n[1]&&pn(n);return{c(){e=y("li"),t=O(n[3]),r=C(),i&&i.c(),this.h()},l(o){e=b(o,"LI",{class:!0});var a=T(e);t=j(a,n[3]),r=I(a),i&&i.l(a),a.forEach(d),this.h()},h(){S(e,"class","svelte-xlb350"),_e(e,"invalid",n[0])},m(o,a){$(o,e,a),v(e,t),v(e,r),i&&i.m(e,null),s=!0},p(o,[a]){(!s||a&8)&&le(t,o[3]),o[1]?i?(i.p(o,a),a&2&&D(i,1)):(i=pn(o),i.c(),D(i,1),i.m(e,null)):i&&(ge(),F(i,1,1,()=>{i=null}),we()),a&1&&_e(e,"invalid",o[0])},i(o){s||(D(i),s=!0)},o(o){F(i),s=!1},d(o){o&&d(e),i&&i.d()}}}function si(n,e,t){let r,s,i,o,{opponent:a}=e,{valid:l}=e,{text:u}=e,{revealOpponent:h}=e,{points:c}=e;const p=es(0,{duration:1e3});let _=!0;return p.set(1).then(()=>{t(9,_=!1)}),n.$$set=m=>{"opponent"in m&&t(4,a=m.opponent),"valid"in m&&t(5,l=m.valid),"text"in m&&t(6,u=m.text),"revealOpponent"in m&&t(7,h=m.revealOpponent),"points"in m&&t(8,c=m.points)},n.$$.update=()=>{n.$$.dirty&240&&t(3,r=a&&l&&!h?u.split("").map(()=>"\u2589").join(""):u),n.$$.dirty&32&&t(0,s=!l),n.$$.dirty&257&&t(2,i=s||!c?"":`+${c}`),n.$$.dirty&656&&t(1,o=_&&(!a||!h))},[s,o,i,r,a,l,u,h,c,_]}class ii extends Z{constructor(e){super(),ee(this,e,si,ni,te,{opponent:4,valid:5,text:6,revealOpponent:7,points:8})}}function mn(n,e,t){const r=n.slice();return r[2]=e[t].valid,r[3]=e[t].text,r[4]=e[t].revealOpponent,r[5]=e[t].points,r}function vn(n,e){let t,r,s;return r=new ii({props:{opponent:e[1],valid:e[2],text:e[3],revealOpponent:e[4],points:e[5]}}),{key:n,first:null,c(){t=oe(),re(r.$$.fragment),this.h()},l(i){t=oe(),ne(r.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){$(i,t,o),se(r,i,o),s=!0},p(i,o){e=i;const a={};o&2&&(a.opponent=e[1]),o&1&&(a.valid=e[2]),o&1&&(a.text=e[3]),o&1&&(a.revealOpponent=e[4]),o&1&&(a.points=e[5]),r.$set(a)},i(i){s||(D(r.$$.fragment,i),s=!0)},o(i){F(r.$$.fragment,i),s=!1},d(i){i&&d(t),ie(r,i)}}}function oi(n){let e,t=[],r=new Map,s,i=n[0];const o=a=>a[3];for(let a=0;a<i.length;a+=1){let l=mn(n,i,a),u=o(l);r.set(u,t[a]=vn(u,l))}return{c(){e=y("ul");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=b(a,"UL",{class:!0});var l=T(e);for(let u=0;u<t.length;u+=1)t[u].l(l);l.forEach(d),this.h()},h(){S(e,"class","svelte-12ad0m2")},m(a,l){$(a,e,l);for(let u=0;u<t.length;u+=1)t[u].m(e,null);s=!0},p(a,[l]){l&3&&(i=a[0],ge(),t=ws(t,l,o,1,a,i,r,e,ys,vn,null,mn),we())},i(a){if(!s){for(let l=0;l<i.length;l+=1)D(t[l]);s=!0}},o(a){for(let l=0;l<t.length;l+=1)F(t[l]);s=!1},d(a){a&&d(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function ai(n,e,t){let{guesses:r}=e,{opponent:s=!1}=e;return n.$$set=i=>{"guesses"in i&&t(0,r=i.guesses),"opponent"in i&&t(1,s=i.opponent)},[r,s]}class ts extends Z{constructor(e){super(),ee(this,e,ai,oi,te,{guesses:0,opponent:1})}}function _n(n){let e,t;return e=new ts({props:{guesses:n[0],opponent:!0}}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},p(r,s){const i={};s&1&&(i.guesses=r[0]),e.$set(i)},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function li(n){let e,t,r,s;t=new ts({props:{guesses:n[1]}});let i=!n[2]&&_n(n);return{c(){e=y("div"),re(t.$$.fragment),r=C(),i&&i.c(),this.h()},l(o){e=b(o,"DIV",{class:!0});var a=T(e);ne(t.$$.fragment,a),r=I(a),i&&i.l(a),a.forEach(d),this.h()},h(){S(e,"class","svelte-7qsaem")},m(o,a){$(o,e,a),se(t,e,null),v(e,r),i&&i.m(e,null),s=!0},p(o,[a]){const l={};a&2&&(l.guesses=o[1]),t.$set(l),o[2]?i&&(ge(),F(i,1,1,()=>{i=null}),we()):i?(i.p(o,a),a&4&&D(i,1)):(i=_n(o),i.c(),D(i,1),i.m(e,null))},i(o){s||(D(t.$$.fragment,o),D(i),s=!0)},o(o){F(t.$$.fragment,o),F(i),s=!1},d(o){o&&d(e),ie(t),i&&i.d()}}}const ui=0;function ci(n,e,t){let r,s,i,o,a;x(n,Ee,u=>t(3,i=u)),x(n,Te,u=>t(4,o=u)),x(n,xe,u=>t(2,a=u));const l=u=>u.reason===void 0||u.reason===ui;return n.$$.update=()=>{n.$$.dirty&24&&t(1,r=o.user[i].filter(l)),n.$$.dirty&24&&t(0,s=o.opponent[i].filter(l))},[s,r,a,i,o]}class hi extends Z{constructor(e){super(),ee(this,e,ci,li,te,{})}}var fi=[{row:0,value:"q"},{row:0,value:"w"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"a"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:2,value:"Shift"},{row:2,value:"z"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"m"},{row:2,value:"Backspace"},{row:3,value:"Page1"},{row:3,value:","},{row:3,value:"Space"},{row:3,value:"."},{row:3,value:"Enter"},{row:0,value:"1",page:1},{row:0,value:"2",page:1},{row:0,value:"3",page:1},{row:0,value:"4",page:1},{row:0,value:"5",page:1},{row:0,value:"6",page:1},{row:0,value:"7",page:1},{row:0,value:"8",page:1},{row:0,value:"9",page:1},{row:0,value:"0",page:1},{row:1,value:"!",page:1},{row:1,value:"@",page:1},{row:1,value:"#",page:1},{row:1,value:"$",page:1},{row:1,value:"%",page:1},{row:1,value:"^",page:1},{row:1,value:"&",page:1},{row:1,value:"*",page:1},{row:1,value:"(",page:1},{row:1,value:")",page:1},{row:2,value:"-",page:1},{row:2,value:"_",page:1},{row:2,value:"=",page:1},{row:2,value:"+",page:1},{row:2,value:";",page:1},{row:2,value:":",page:1},{row:2,value:"'",page:1},{row:2,value:'"',page:1},{row:2,value:"<",page:1},{row:2,value:">",page:1},{row:3,value:"Page0",page:1},{row:3,value:"/",page:1},{row:3,value:"?",page:1},{row:3,value:"[",page:1},{row:3,value:"]",page:1},{row:3,value:"{",page:1},{row:3,value:"}",page:1},{row:3,value:"|",page:1},{row:3,value:"\\",page:1},{row:3,value:"~",page:1}],di=[{row:0,value:"q"},{row:0,value:"w"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"a"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:2,value:"z"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"m"},{row:2,value:"Backspace"}],pi=[{row:0,value:"q"},{row:0,value:"w"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"a"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:2,value:"Enter"},{row:2,value:"z"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"m"},{row:2,value:"Backspace"}],mi=[{row:0,value:"a"},{row:0,value:"z"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"q"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:1,value:"m"},{row:2,value:"Shift"},{row:2,value:"w"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"Backspace"},{row:3,value:"Page1"},{row:3,value:","},{row:3,value:"Space"},{row:3,value:"."},{row:3,value:"Enter"},{row:0,value:"1",page:1},{row:0,value:"2",page:1},{row:0,value:"3",page:1},{row:0,value:"4",page:1},{row:0,value:"5",page:1},{row:0,value:"6",page:1},{row:0,value:"7",page:1},{row:0,value:"8",page:1},{row:0,value:"9",page:1},{row:0,value:"0",page:1},{row:1,value:"!",page:1},{row:1,value:"@",page:1},{row:1,value:"#",page:1},{row:1,value:"$",page:1},{row:1,value:"%",page:1},{row:1,value:"^",page:1},{row:1,value:"&",page:1},{row:1,value:"*",page:1},{row:1,value:"(",page:1},{row:1,value:")",page:1},{row:2,value:"-",page:1},{row:2,value:"_",page:1},{row:2,value:"=",page:1},{row:2,value:"+",page:1},{row:2,value:";",page:1},{row:2,value:":",page:1},{row:2,value:"'",page:1},{row:2,value:'"',page:1},{row:2,value:"<",page:1},{row:2,value:">",page:1},{row:3,value:"Page0",page:1},{row:3,value:"/",page:1},{row:3,value:"?",page:1},{row:3,value:"[",page:1},{row:3,value:"]",page:1},{row:3,value:"{",page:1},{row:3,value:"}",page:1},{row:3,value:"|",page:1},{row:3,value:"\\",page:1},{row:3,value:"~",page:1}],vi=[{row:0,value:"a"},{row:0,value:"z"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"q"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:1,value:"m"},{row:2,value:"w"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"Backspace"}],_i=[{row:0,value:"a"},{row:0,value:"z"},{row:0,value:"e"},{row:0,value:"r"},{row:0,value:"t"},{row:0,value:"y"},{row:0,value:"u"},{row:0,value:"i"},{row:0,value:"o"},{row:0,value:"p"},{row:1,value:"q"},{row:1,value:"s"},{row:1,value:"d"},{row:1,value:"f"},{row:1,value:"g"},{row:1,value:"h"},{row:1,value:"j"},{row:1,value:"k"},{row:1,value:"l"},{row:1,value:"m"},{row:2,value:"Enter"},{row:2,value:"w"},{row:2,value:"x"},{row:2,value:"c"},{row:2,value:"v"},{row:2,value:"b"},{row:2,value:"n"},{row:2,value:"Backspace"}],gi='<svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-delete"><path d="M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"></path><line x1="18" y1="9" x2="12" y2="15"></line><line x1="12" y1="9" x2="18" y2="15"></line></svg>',wi='<svg width="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-corner-down-left"><polyline points="9 10 4 15 9 20"></polyline><path d="M20 4v7a4 4 0 0 1-4 4H4"></path></svg>';function gn(n,e,t){const r=n.slice();return r[27]=e[t],r[29]=t,r}function wn(n,e,t){const r=n.slice();return r[30]=e[t],r}function yn(n,e,t){const r=n.slice();return r[33]=e[t].value,r[34]=e[t].display,r}function yi(n){let e=n[34]+"",t;return{c(){t=O(e)},l(r){t=j(r,e)},m(r,s){$(r,t,s)},p(r,s){s[0]&8&&e!==(e=r[34]+"")&&le(t,e)},d(r){r&&d(t)}}}function bi(n){let e,t=n[34]+"",r;return{c(){e=new Wn(!1),r=oe(),this.h()},l(s){e=Vn(s,!1),r=oe(),this.h()},h(){e.a=r},m(s,i){e.m(t,s,i),$(s,r,i)},p(s,i){i[0]&8&&t!==(t=s[34]+"")&&e.p(t)},d(s){s&&d(r),s&&e.d()}}}function bn(n){let e,t,r,s,i;function o(_,m){return m[0]&8&&(t=null),t==null&&(t=!!_[34].includes("<svg")),t?bi:yi}let a=o(n,[-1,-1]),l=a(n);function u(..._){return n[19](n[33],..._)}function h(..._){return n[20](n[33],..._)}function c(){return n[21](n[33])}function p(){return n[22](n[33])}return{c(){e=y("button"),l.c(),this.h()},l(_){e=b(_,"BUTTON",{class:!0});var m=T(e);l.l(m),m.forEach(d),this.h()},h(){S(e,"class",r="key key--"+n[33]+" "+(n[0][n[33]]||"")+" svelte-zdf3cm"),_e(e,"single",n[33].length===1),_e(e,"active",n[33]===n[2])},m(_,m){$(_,e,m),l.m(e,null),s||(i=[ce(e,"touchstart",u),ce(e,"mousedown",h),ce(e,"touchend",c,{passive:!0}),ce(e,"mouseup",p)],s=!0)},p(_,m){n=_,a===(a=o(n,m))&&l?l.p(n,m):(l.d(1),l=a(n),l&&(l.c(),l.m(e,null))),m[0]&9&&r!==(r="key key--"+n[33]+" "+(n[0][n[33]]||"")+" svelte-zdf3cm")&&S(e,"class",r),m[0]&9&&_e(e,"single",n[33].length===1),m[0]&13&&_e(e,"active",n[33]===n[2])},d(_){_&&d(e),l.d(),s=!1,wt(i)}}}function kn(n){let e,t=n[30],r=[];for(let s=0;s<t.length;s+=1)r[s]=bn(yn(n,t,s));return{c(){e=y("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=b(s,"DIV",{class:!0});var i=T(e);for(let o=0;o<r.length;o+=1)r[o].l(i);i.forEach(d),this.h()},h(){S(e,"class","row row--"+n[29]+" svelte-zdf3cm")},m(s,i){$(s,e,i);for(let o=0;o<r.length;o+=1)r[o].m(e,null)},p(s,i){if(i[0]&61){t=s[30];let o;for(o=0;o<t.length;o+=1){const a=yn(s,t,o);r[o]?r[o].p(a,i):(r[o]=bn(a),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=t.length}},d(s){s&&d(e),rt(r,s)}}}function En(n){let e,t,r=n[27],s=[];for(let i=0;i<r.length;i+=1)s[i]=kn(wn(n,r,i));return{c(){e=y("div");for(let i=0;i<s.length;i+=1)s[i].c();t=C(),this.h()},l(i){e=b(i,"DIV",{class:!0});var o=T(e);for(let a=0;a<s.length;a+=1)s[a].l(o);t=I(o),o.forEach(d),this.h()},h(){S(e,"class","page svelte-zdf3cm"),_e(e,"visible",n[29]===n[1])},m(i,o){$(i,e,o);for(let a=0;a<s.length;a+=1)s[a].m(e,null);v(e,t)},p(i,o){if(o[0]&61){r=i[27];let a;for(a=0;a<r.length;a+=1){const l=wn(i,r,a);s[a]?s[a].p(l,o):(s[a]=kn(l),s[a].c(),s[a].m(e,t))}for(;a<s.length;a+=1)s[a].d(1);s.length=r.length}o[0]&2&&_e(e,"visible",i[29]===i[1])},d(i){i&&d(e),rt(s,i)}}}function ki(n){let e,t=n[3],r=[];for(let s=0;s<t.length;s+=1)r[s]=En(gn(n,t,s));return{c(){e=y("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=b(s,"DIV",{class:!0});var i=T(e);for(let o=0;o<r.length;o+=1)r[o].l(i);i.forEach(d),this.h()},h(){S(e,"class","svelte-keyboard")},m(s,i){$(s,e,i);for(let o=0;o<r.length;o+=1)r[o].m(e,null)},p(s,i){if(i[0]&63){t=s[3];let o;for(o=0;o<t.length;o+=1){const a=gn(s,t,o);r[o]?r[o].p(a,i):(r[o]=En(a),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=t.length}},i:q,o:q,d(s){s&&d(e),rt(r,s)}}}const Ei="abcdefghijklmnopqrstuvwxyz";function Ti(n,e,t){let r,s,i,o,a,l,u,h,c,{custom:p}=e,{localizationLayout:_="qwerty"}=e,{layout:m="standard"}=e,{noSwap:g=[]}=e,{keyClass:k={}}=e,E=0,P=!1,L;const W={qwerty:{standard:fi,crossword:di,wordle:pi},azerty:{standard:mi,crossword:vi,wordle:_i}},B=kr(),R={Page0:"abc",Page1:"?123",Space:" ",Shift:"abc",Enter:wi,Backspace:gi},G=f=>[...new Set(f)],U=(f,w)=>{if(f.preventDefault(),t(2,L=w),w.includes("Page"))t(1,E=+w.substr(-1));else if(w==="Shift")t(10,P=!P);else{let N=w;P&&Ei.includes(w)&&(N=w.toUpperCase()),B("keydown",N)}return f.stopPropagation(),!1},J=f=>{setTimeout(()=>{f===L&&t(2,L=void 0)},50)},K=(f,w)=>U(w,f),A=(f,w)=>U(w,f),z=f=>J(f),M=f=>J(f);return n.$$set=f=>{"custom"in f&&t(6,p=f.custom),"localizationLayout"in f&&t(7,_=f.localizationLayout),"layout"in f&&t(8,m=f.layout),"noSwap"in f&&t(9,g=f.noSwap),"keyClass"in f&&t(0,k=f.keyClass)},n.$$.update=()=>{n.$$.dirty[0]&448&&t(18,r=p||W[_][m]||standard),n.$$.dirty[0]&263680&&t(17,s=r.map(f=>{let w=f.display;const N=R[f.value];return N&&!g.includes(f.value)&&!f.noSwap&&(w=N),w||(w=P?f.value.toUpperCase():f.value),f.value==="Shift"&&(w=P?N:N.toUpperCase()),ht(Ne({},f),{display:w})})),n.$$.dirty[0]&131072&&t(15,i=s.filter(f=>!f.page)),n.$$.dirty[0]&131072&&t(13,o=s.filter(f=>f.page)),n.$$.dirty[0]&32768&&t(14,a=G(i.map(f=>f.row))),n.$$.dirty[0]&16384&&a.sort((f,w)=>f-w),n.$$.dirty[0]&8192&&t(16,l=G(o.map(f=>f.row))),n.$$.dirty[0]&65536&&l.sort((f,w)=>f-w),n.$$.dirty[0]&49152&&t(12,u=a.map(f=>i.filter(w=>w.row===f))),n.$$.dirty[0]&24576&&t(11,h=a.map(f=>o.filter(w=>w.row===f))),n.$$.dirty[0]&6144&&t(3,c=[u,h])},[k,E,L,c,U,J,p,_,m,g,P,h,u,o,a,i,l,s,r,K,A,z,M]}class Si extends Z{constructor(e){super(),ee(this,e,Ti,ki,te,{custom:6,localizationLayout:7,layout:8,noSwap:9,keyClass:0},null,[-1,-1])}}function Oi(n){let e,t,r,s,i,o,a,l,u,h,c,p,_,m,g;return i=new Si({props:{layout:"wordle"}}),i.$on("keydown",n[2]),{c(){e=y("div"),t=y("p"),r=O(n[1]),s=C(),re(i.$$.fragment),o=C(),a=y("div"),l=y("form"),u=y("input"),h=C(),c=y("button"),p=O("Submit"),this.h()},l(k){e=b(k,"DIV",{class:!0});var E=T(e);t=b(E,"P",{});var P=T(t);r=j(P,n[1]),P.forEach(d),s=I(E),ne(i.$$.fragment,E),E.forEach(d),o=I(k),a=b(k,"DIV",{class:!0});var L=T(a);l=b(L,"FORM",{});var W=T(l);u=b(W,"INPUT",{maxlength:!0,class:!0}),h=I(W),c=b(W,"BUTTON",{type:!0,class:!0});var B=T(c);p=j(B,"Submit"),B.forEach(d),W.forEach(d),L.forEach(d),this.h()},h(){S(e,"class","keyboard svelte-1jya41k"),S(u,"maxlength","15"),S(u,"class","svelte-1jya41k"),S(c,"type","submit"),S(c,"class","svelte-1jya41k"),S(a,"class","no-keyboard svelte-1jya41k")},m(k,E){$(k,e,E),v(e,t),v(t,r),v(e,s),se(i,e,null),$(k,o,E),$(k,a,E),v(a,l),v(l,u),$t(u,n[1]),n[5](u),v(l,h),v(l,c),v(c,p),_=!0,m||(g=[ce(u,"input",n[4]),ce(l,"submit",n[3])],m=!0)},p(k,[E]){(!_||E&2)&&le(r,k[1]),E&2&&u.value!==k[1]&&$t(u,k[1])},i(k){_||(D(i.$$.fragment,k),_=!0)},o(k){F(i.$$.fragment,k),_=!1},d(k){k&&d(e),ie(i),k&&d(o),k&&d(a),n[5](null),m=!1,wt(g)}}}function ji(n,e,t){const r=kr();let s,i="";const o=()=>{i&&r("submit",i),t(1,i="")},a=c=>{c.detail==="Enter"?o():c.detail==="Backspace"?t(1,i=i.substring(0,i.length-1)):t(1,i=`${i}${c.detail}`)},l=c=>{c.preventDefault(),t(1,i=i.trim().toLowerCase()),o()};yt(()=>{s.focus()});function u(){i=this.value,t(1,i)}function h(c){Yn[c?"unshift":"push"](()=>{s=c,t(0,s)})}return[s,i,a,l,u,h]}class $i extends Z{constructor(e){super(),ee(this,e,ji,Oi,te,{})}}function Pi(n){let e,t;return{c(){e=y("p"),t=O(n[0]),this.h()},l(r){e=b(r,"P",{class:!0});var s=T(e);t=j(s,n[0]),s.forEach(d),this.h()},h(){S(e,"class","svelte-jyzswz")},m(r,s){$(r,e,s),v(e,t)},p(r,[s]){s&1&&le(t,r[0])},i:q,o:q,d(r){r&&d(e)}}}const Tn=1e3;function Ri(n,e,t){let r,s,i;x(n,et,l=>t(1,s=l)),x(n,tt,l=>t(2,i=l));const o=15*Tn,a=l=>{l?vt.start():(vt.stop(),vt.reset())};return n.$$.update=()=>{n.$$.dirty&4&&t(0,r=Math.floor((o-i)/Tn)),n.$$.dirty&1&&r<=0&&me(et,s=!1,s),n.$$.dirty&2&&a(s)},[r,s,i]}class Ai extends Z{constructor(e){super(),ee(this,e,Ri,Pi,te,{})}}function Ci(n){let e,t,r,s,i;return{c(){e=y("div"),t=y("p"),r=O("Type as many words as you can that..."),s=C(),i=y("p"),this.h()},l(o){e=b(o,"DIV",{class:!0});var a=T(e);t=b(a,"P",{class:!0});var l=T(t);r=j(l,"Type as many words as you can that..."),l.forEach(d),s=I(a),i=b(a,"P",{class:!0});var u=T(i);u.forEach(d),a.forEach(d),this.h()},h(){S(t,"class","instructions svelte-12uh45b"),S(i,"class","clue svelte-12uh45b"),S(e,"class","svelte-12uh45b")},m(o,a){$(o,e,a),v(e,t),v(t,r),v(e,s),v(e,i),i.innerHTML=n[0]},p(o,[a]){a&1&&(i.innerHTML=o[0])},i:q,o:q,d(o){o&&d(e)}}}function Ii(n,e,t){let{clue:r}=e;return n.$$set=s=>{"clue"in s&&t(0,r=s.clue)},[r]}class Ni extends Z{constructor(e){super(),ee(this,e,Ii,Ci,te,{clue:0})}}function Sn(n){let e,t,r,s,i,o=n[0].opponent+"",a;return{c(){e=y("p"),t=y("span"),r=O("Michelle"),s=C(),i=y("span"),a=O(o),this.h()},l(l){e=b(l,"P",{class:!0});var u=T(e);t=b(u,"SPAN",{class:!0});var h=T(t);r=j(h,"Michelle"),h.forEach(d),s=I(u),i=b(u,"SPAN",{class:!0});var c=T(i);a=j(c,o),c.forEach(d),u.forEach(d),this.h()},h(){S(t,"class","name svelte-1xmjoob"),S(i,"class","score svelte-1xmjoob"),S(e,"class","svelte-1xmjoob")},m(l,u){$(l,e,u),v(e,t),v(t,r),v(e,s),v(e,i),v(i,a)},p(l,u){u&1&&o!==(o=l[0].opponent+"")&&le(a,o)},d(l){l&&d(e)}}}function Ui(n){let e,t,r,s,i,o,a=n[0].user+"",l,u,h=!n[1]&&Sn(n);return{c(){e=y("div"),t=y("p"),r=y("span"),s=O("You"),i=C(),o=y("span"),l=O(a),u=C(),h&&h.c(),this.h()},l(c){e=b(c,"DIV",{class:!0});var p=T(e);t=b(p,"P",{class:!0});var _=T(t);r=b(_,"SPAN",{class:!0});var m=T(r);s=j(m,"You"),m.forEach(d),i=I(_),o=b(_,"SPAN",{class:!0});var g=T(o);l=j(g,a),g.forEach(d),_.forEach(d),u=I(p),h&&h.l(p),p.forEach(d),this.h()},h(){S(r,"class","name svelte-1xmjoob"),S(o,"class","score svelte-1xmjoob"),S(t,"class","svelte-1xmjoob"),S(e,"class","svelte-1xmjoob")},m(c,p){$(c,e,p),v(e,t),v(t,r),v(r,s),v(t,i),v(t,o),v(o,l),v(e,u),h&&h.m(e,null)},p(c,[p]){p&1&&a!==(a=c[0].user+"")&&le(l,a),c[1]?h&&(h.d(1),h=null):h?h.p(c,p):(h=Sn(c),h.c(),h.m(e,null))},i:q,o:q,d(c){c&&d(e),h&&h.d()}}}function Di(n,e,t){let r,s;return x(n,Sr,i=>t(0,r=i)),x(n,xe,i=>t(1,s=i)),[r,s]}class Mi extends Z{constructor(e){super(),ee(this,e,Di,Ui,te,{})}}function On(n){let e,t,r=n[0].text+"",s,i,o=n[2][n[0].reason]+"",a;return{c(){e=y("p"),t=y("strong"),s=O(r),i=C(),a=O(o),this.h()},l(l){e=b(l,"P",{class:!0});var u=T(e);t=b(u,"STRONG",{});var h=T(t);s=j(h,r),h.forEach(d),i=I(u),a=j(u,o),u.forEach(d),this.h()},h(){S(e,"class","svelte-2dcxu0")},m(l,u){$(l,e,u),v(e,t),v(t,s),v(e,i),v(e,a)},p(l,u){u&1&&r!==(r=l[0].text+"")&&le(s,r),u&1&&o!==(o=l[2][l[0].reason]+"")&&le(a,o)},d(l){l&&d(e)}}}function Bi(n){let e,t=n[1]&&On(n);return{c(){e=y("div"),t&&t.c(),this.h()},l(r){e=b(r,"DIV",{class:!0});var s=T(e);t&&t.l(s),s.forEach(d),this.h()},h(){S(e,"class","svelte-2dcxu0")},m(r,s){$(r,e,s),t&&t.m(e,null)},p(r,[s]){r[1]?t?t.p(r,s):(t=On(r),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},i:q,o:q,d(r){r&&d(e),t&&t.d()}}}const Li=2500;function xi(n,e,t){let r,s,i;x(n,Ee,c=>t(4,s=c)),x(n,Te,c=>t(5,i=c));let o,a=!1,l=0;const u=["(or a variation) was played by opponent","is too short","contains non-letters","is not in the word list","was already entered"],h=()=>{t(3,l=i.user[s].length),clearTimeout(o),r.valid?t(1,a=!1):(t(1,a=!0),o=setTimeout(()=>t(1,a=!1),Li))};return n.$$.update=()=>{n.$$.dirty&48&&t(0,r=i.user[s][i.user[s].length-1]),n.$$.dirty&48&&(i.user[s].length||t(3,l=0)),n.$$.dirty&57&&r&&i.user[s].length!==l&&h()},[r,a,u,l,s,i]}class Fi extends Z{constructor(e){super(),ee(this,e,xi,Bi,te,{})}}function Gi(n){let e,t,r,s,i,o,a,l,u,h,c,p,_,m;return t=new Ni({props:{clue:n[0]}}),s=new Ai({}),a=new hi({}),u=new Mi({}),c=new Fi({}),_=new $i({}),_.$on("submit",n[1]),{c(){e=y("div"),re(t.$$.fragment),r=C(),re(s.$$.fragment),i=C(),o=y("div"),re(a.$$.fragment),l=C(),re(u.$$.fragment),h=C(),re(c.$$.fragment),p=C(),re(_.$$.fragment),this.h()},l(g){e=b(g,"DIV",{class:!0});var k=T(e);ne(t.$$.fragment,k),r=I(k),ne(s.$$.fragment,k),i=I(k),o=b(k,"DIV",{class:!0});var E=T(o);ne(a.$$.fragment,E),l=I(E),ne(u.$$.fragment,E),h=I(E),ne(c.$$.fragment,E),p=I(E),ne(_.$$.fragment,E),E.forEach(d),k.forEach(d),this.h()},h(){S(o,"class","board svelte-1uowmjb"),S(e,"class","play svelte-1uowmjb")},m(g,k){$(g,e,k),se(t,e,null),v(e,r),se(s,e,null),v(e,i),v(e,o),se(a,o,null),v(o,l),se(u,o,null),v(o,h),se(c,o,null),v(o,p),se(_,o,null),m=!0},p(g,[k]){const E={};k&1&&(E.clue=g[0]),t.$set(E)},i(g){m||(D(t.$$.fragment,g),D(s.$$.fragment,g),D(a.$$.fragment,g),D(u.$$.fragment,g),D(c.$$.fragment,g),D(_.$$.fragment,g),m=!0)},o(g){F(t.$$.fragment,g),F(s.$$.fragment,g),F(a.$$.fragment,g),F(u.$$.fragment,g),F(c.$$.fragment,g),F(_.$$.fragment,g),m=!1},d(g){g&&d(e),ie(t),ie(s),ie(a),ie(u),ie(c),ie(_)}}}function Hi(n,e,t){let r,s,i,o,a,l,u,h;x(n,Ee,R=>t(5,o=R)),x(n,Te,R=>t(7,a=R)),x(n,tt,R=>t(8,l=R)),x(n,Or,R=>t(9,u=R)),x(n,pr,R=>t(10,h=R));let{clues:c}=e,{answers:p}=e;const _=R=>{const G=s.find(U=>U.word===R);return G?G.lemmas:""},m=R=>!i.includes(R),g=({text:R,lemmas:G})=>jt({lemmas:G,corpus:u}),k=({text:R,lemmas:G})=>{const U=a.user[o].map(J=>J.lemmas);return jt({lemmas:G,corpus:U})},E=R=>new RegExp(/([^a-z])/,"g").test(R),P=({text:R,lemmas:G})=>{let U=!0,J;return R.length<4?(U=!1,J=1):E(R)?(U=!1,J=2):m(R)?(U=!1,J=3):k({text:R,lemmas:G})?(U=!1,J=4):g({text:R,lemmas:G})&&(U=!1,J=0),{valid:U,reason:J}},L=({text:R,timestamp:G})=>{const{points:U}=s.find(J=>J.word===R);return+U},W=R=>{a.opponent[o].forEach(G=>{const U=G.lemmas.split("|");jt({lemmas:R,corpus:U})&&(G.revealOpponent=!0)})},B=async({detail:R})=>{const G=R,U=_(G),{valid:J,reason:K}=P({text:G,lemmas:U}),A=l,z=J?L({text:G,timestamp:A}):void 0,M={text:G,lemmas:U,points:z,timestamp:A,round:o,valid:J,reason:K};me(Te,a.user[o]=[...a.user[o],M],a),W(U)};return n.$$set=R=>{"clues"in R&&t(2,c=R.clues),"answers"in R&&t(3,p=R.answers)},n.$$.update=()=>{n.$$.dirty&36&&t(0,r=c[o]),n.$$.dirty&40&&t(4,s=p[o]),n.$$.dirty&16&&me(pr,h=s,h),n.$$.dirty&16&&(i=s.map(R=>R.word))},[r,B,c,p,s,o]}class qi extends Z{constructor(e){super(),ee(this,e,Hi,Gi,te,{clues:2,answers:3})}}function zi(n){let e,t;return{c(){e=y("p"),t=O(n[0]),this.h()},l(r){e=b(r,"P",{class:!0});var s=T(e);t=j(s,n[0]),s.forEach(d),this.h()},h(){S(e,"class","svelte-1sj1s4l")},m(r,s){$(r,e,s),v(e,t)},p(r,[s]){s&1&&le(t,r[0])},i:q,o:q,d(r){r&&d(e)}}}const jn=3;function Ji(n,e,t){let r,s;const i=kr(),o=-1,a=jn*1e3,l=es(jn,{duration:a});return x(n,l,u=>t(2,s=u)),l.set(o).then(()=>{i("end")}),n.$$.update=()=>{n.$$.dirty&4&&t(0,r=s<0?"Begin!":Math.floor(s)+1)},[r,l,s]}class Wi extends Z{constructor(e){super(),ee(this,e,Ji,zi,te,{})}}function $n(n){let e,t,r=n[2].opponent+"",s;return{c(){e=y("p"),t=O("Michelle: "),s=O(r)},l(i){e=b(i,"P",{});var o=T(e);t=j(o,"Michelle: "),s=j(o,r),o.forEach(d)},m(i,o){$(i,e,o),v(e,t),v(e,s)},p(i,o){o&4&&r!==(r=i[2].opponent+"")&&le(s,r)},d(i){i&&d(e)}}}function Vi(n){let e,t,r=n[0]+1+"",s,i,o,a,l,u=n[1]?"Your score":"You",h,c,p=n[2].user+"",_,m,g,k=!n[1]&&$n(n);return{c(){e=y("p"),t=O("Round "),s=O(r),i=O(" of "),o=O(Rt),a=C(),l=y("p"),h=O(u),c=O(": "),_=O(p),m=C(),k&&k.c(),g=oe()},l(E){e=b(E,"P",{});var P=T(e);t=j(P,"Round "),s=j(P,r),i=j(P," of "),o=j(P,Rt),P.forEach(d),a=I(E),l=b(E,"P",{});var L=T(l);h=j(L,u),c=j(L,": "),_=j(L,p),L.forEach(d),m=I(E),k&&k.l(E),g=oe()},m(E,P){$(E,e,P),v(e,t),v(e,s),v(e,i),v(e,o),$(E,a,P),$(E,l,P),v(l,h),v(l,c),v(l,_),$(E,m,P),k&&k.m(E,P),$(E,g,P)},p(E,[P]){P&1&&r!==(r=E[0]+1+"")&&le(s,r),P&2&&u!==(u=E[1]?"Your score":"You")&&le(h,u),P&4&&p!==(p=E[2].user+"")&&le(_,p),E[1]?k&&(k.d(1),k=null):k?k.p(E,P):(k=$n(E),k.c(),k.m(g.parentNode,g))},i:q,o:q,d(E){E&&d(e),E&&d(a),E&&d(l),E&&d(m),k&&k.d(E),E&&d(g)}}}function Yi(n,e,t){let r,s,i;return x(n,Ee,o=>t(0,r=o)),x(n,xe,o=>t(1,s=o)),x(n,Sr,o=>t(2,i=o)),[r,s,i]}class Ki extends Z{constructor(e){super(),ee(this,e,Yi,Vi,te,{})}}function Pn(n,e,t){const r=n.slice();return r[10]=e[t].text,r[11]=e[t].points,r}function Rn(n){let e,t,r,s,i,o,a,l,u,h,c,p,_=n[2].slice(0,7),m=[];for(let g=0;g<_.length;g+=1)m[g]=An(Pn(n,_,g));return{c(){e=y("p"),t=O("Here are some words that Michelle got that you didn't:"),r=C(),s=y("table"),i=y("thead"),o=y("th"),a=O("Word"),l=C(),u=y("th"),h=O("Points"),c=C(),p=y("tbody");for(let g=0;g<m.length;g+=1)m[g].c();this.h()},l(g){e=b(g,"P",{});var k=T(e);t=j(k,"Here are some words that Michelle got that you didn't:"),k.forEach(d),r=I(g),s=b(g,"TABLE",{class:!0});var E=T(s);i=b(E,"THEAD",{});var P=T(i);o=b(P,"TH",{});var L=T(o);a=j(L,"Word"),L.forEach(d),l=I(P),u=b(P,"TH",{});var W=T(u);h=j(W,"Points"),W.forEach(d),P.forEach(d),c=I(E),p=b(E,"TBODY",{});var B=T(p);for(let R=0;R<m.length;R+=1)m[R].l(B);B.forEach(d),E.forEach(d),this.h()},h(){S(s,"class","svelte-1nqgcdy")},m(g,k){$(g,e,k),v(e,t),$(g,r,k),$(g,s,k),v(s,i),v(i,o),v(o,a),v(i,l),v(i,u),v(u,h),v(s,c),v(s,p);for(let E=0;E<m.length;E+=1)m[E].m(p,null)},p(g,k){if(k&4){_=g[2].slice(0,7);let E;for(E=0;E<_.length;E+=1){const P=Pn(g,_,E);m[E]?m[E].p(P,k):(m[E]=An(P),m[E].c(),m[E].m(p,null))}for(;E<m.length;E+=1)m[E].d(1);m.length=_.length}},d(g){g&&d(e),g&&d(r),g&&d(s),rt(m,g)}}}function An(n){let e,t,r=n[10]+"",s,i,o,a=n[11]+"",l;return{c(){e=y("tr"),t=y("td"),s=O(r),i=C(),o=y("td"),l=O(a)},l(u){e=b(u,"TR",{});var h=T(e);t=b(h,"TD",{});var c=T(t);s=j(c,r),c.forEach(d),i=I(h),o=b(h,"TD",{});var p=T(o);l=j(p,a),p.forEach(d),h.forEach(d)},m(u,h){$(u,e,h),v(e,t),v(t,s),v(e,i),v(e,o),v(o,l)},p(u,h){h&4&&r!==(r=u[10]+"")&&le(s,r),h&4&&a!==(a=u[11]+"")&&le(l,a)},d(u){u&&d(e)}}}function Xi(n){let e,t,r,s,i,o,a,l,u,h,c,p,_,m=n[2].length&&Rn(n);return{c(){e=y("p"),t=O("There were "),r=y("strong"),s=O(n[3]),i=O(" possible words that satisfied the clue."),o=C(),m&&m.c(),a=C(),l=y("p"),u=O("Here are some common words that "),h=O(n[0]),c=O(": "),p=new Wn(!1),_=O("."),this.h()},l(g){e=b(g,"P",{});var k=T(e);t=j(k,"There were "),r=b(k,"STRONG",{});var E=T(r);s=j(E,n[3]),E.forEach(d),i=j(k," possible words that satisfied the clue."),k.forEach(d),o=I(g),m&&m.l(g),a=I(g),l=b(g,"P",{});var P=T(l);u=j(P,"Here are some common words that "),h=j(P,n[0]),c=j(P,": "),p=Vn(P,!1),_=j(P,"."),P.forEach(d),this.h()},h(){p.a=_},m(g,k){$(g,e,k),v(e,t),v(e,r),v(r,s),v(e,i),$(g,o,k),m&&m.m(g,k),$(g,a,k),$(g,l,k),v(l,u),v(l,h),v(l,c),p.m(n[1],l),v(l,_)},p(g,[k]){k&8&&le(s,g[3]),g[2].length?m?m.p(g,k):(m=Rn(g),m.c(),m.m(a.parentNode,a)):m&&(m.d(1),m=null),k&1&&le(h,g[0]),k&2&&p.p(g[1])},i:q,o:q,d(g){g&&d(e),g&&d(o),m&&m.d(g),g&&d(a),g&&d(l)}}}function Qi(n,e,t){let r,s,i,o,a,l,u,h,c,p;return x(n,xe,_=>t(5,l=_)),x(n,Or,_=>t(6,u=_)),x(n,pr,_=>t(7,h=_)),x(n,Ee,_=>t(8,c=_)),x(n,Te,_=>t(9,p=_)),n.$$.update=()=>{n.$$.dirty&128&&t(3,r=Qn(",")(h.length)),n.$$.dirty&768&&t(2,s=p.opponent[c].filter(_=>_.valid&&!_.guessedByUserLate)),n.$$.dirty&192&&t(4,i=h.filter(_=>+_.points==1).filter(_=>!u.includes(m=>m.text))),n.$$.dirty&16&&t(1,o=As(i).slice(0,5).map(_=>`<span>${_.word}</span>`).join(", ")),n.$$.dirty&32&&t(0,a=l?"you didn't get":"neither of you got")},[a,o,s,r,i,l,u,h,c,p]}class Zi extends Z{constructor(e){super(),ee(this,e,Qi,Xi,te,{})}}function Cn(n){let e,t;return{c(){e=y("h2"),t=O(n[1]),this.h()},l(r){e=b(r,"H2",{class:!0});var s=T(e);t=j(s,n[1]),s.forEach(d),this.h()},h(){S(e,"class","svelte-4gydqf")},m(r,s){$(r,e,s),v(e,t)},p(r,s){s&2&&le(t,r[1])},d(r){r&&d(e)}}}function In(n){let e;function t(i,o){return i[2]?ro:i[3]?to:eo}let r=t(n),s=r(n);return{c(){s.c(),e=oe()},l(i){s.l(i),e=oe()},m(i,o){s.m(i,o),$(i,e,o)},p(i,o){r!==(r=t(i))&&(s.d(1),s=r(i),s&&(s.c(),s.m(e.parentNode,e)))},d(i){s.d(i),i&&d(e)}}}function eo(n){let e,t;return{c(){e=y("p"),t=O("Tie!")},l(r){e=b(r,"P",{});var s=T(e);t=j(s,"Tie!"),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},d(r){r&&d(e)}}}function to(n){let e,t;return{c(){e=y("p"),t=O("You lose!")},l(r){e=b(r,"P",{});var s=T(e);t=j(s,"You lose!"),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},d(r){r&&d(e)}}}function ro(n){let e,t;return{c(){e=y("p"),t=O("You win!")},l(r){e=b(r,"P",{});var s=T(e);t=j(s,"You win!"),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},d(r){r&&d(e)}}}function no(n){let e,t,r,s,i,o,a,l=!n[4]&&Cn(n);r=new Ki({}),i=new Zi({});let u=n[0]==="post"&&!n[4]&&In(n);return{c(){e=y("div"),l&&l.c(),t=C(),re(r.$$.fragment),s=C(),re(i.$$.fragment),o=C(),u&&u.c(),this.h()},l(h){e=b(h,"DIV",{class:!0});var c=T(e);l&&l.l(c),t=I(c),ne(r.$$.fragment,c),s=I(c),ne(i.$$.fragment,c),o=I(c),u&&u.l(c),c.forEach(d),this.h()},h(){S(e,"class","svelte-4gydqf")},m(h,c){$(h,e,c),l&&l.m(e,null),v(e,t),se(r,e,null),v(e,s),se(i,e,null),v(e,o),u&&u.m(e,null),a=!0},p(h,[c]){h[4]?l&&(l.d(1),l=null):l?l.p(h,c):(l=Cn(h),l.c(),l.m(e,t)),h[0]==="post"&&!h[4]?u?u.p(h,c):(u=In(h),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(h){a||(D(r.$$.fragment,h),D(i.$$.fragment,h),a=!0)},o(h){F(r.$$.fragment,h),F(i.$$.fragment,h),a=!1},d(h){h&&d(e),l&&l.d(),ie(r),ie(i),u&&u.d()}}}function so(n,e,t){let r,s,i,o,a,l,u,h;x(n,Tr,m=>t(0,a=m)),x(n,Ee,m=>t(7,l=m)),x(n,Sr,m=>t(5,u=m)),x(n,xe,m=>t(4,h=m));const c={ahead:["Live look at her: \u{1F92A}.","She says this is almost as good as a day with boba.","She's really channeling her inner Jessie O'Connor.","Nice try. Follow me on Twitter @mich_mcghee."],behind:["Live look at Michelle: \u{1F62D}.","Michelle says this is almost as bad as a day without boba.","Michelle will try to channel her inner Jessie O'Connor this next round.","Ugh. Rematch?"]},p=()=>{const m=i?"Tie!":r?"You win!":"You lose!",g=r||i?c.behind[l]:c.ahead[l];return`${m} A message from Michelle: ${g}`},_=()=>{const m=i?"It's all tied up.":r?"You're in the lead!":"Michelle's in the lead.",g=r||i?c.behind[l]:c.ahead[l];return`${m} ${g}`};return n.$$.update=()=>{n.$$.dirty&32&&t(2,r=u.user>u.opponent),n.$$.dirty&32&&t(3,s=u.user<u.opponent),n.$$.dirty&32&&(i=u.user===u.opponent),n.$$.dirty&1&&t(1,o=a==="post"?p():_())},[a,o,r,s,h,u]}class io extends Z{constructor(e){super(),ee(this,e,so,no,te,{})}}function oo(n){let e,t,r,s,i,o,a,l,u,h,c,p,_,m,g,k,E,P,L,W,B,R,G,U,J,K,A,z,M;return{c(){e=y("h2"),t=O("Welcome to the Word Game"),r=C(),s=y("p"),i=O("One person a day gets the chance to play against the world in a game of words."),o=C(),a=y("p"),l=O("Today that person is "),u=y("strong"),h=O("Michelle from Oakland, CA"),c=O(". She "),p=y("em"),_=O("really"),m=O(` likes boba. Can
  you beat her?`),g=C(),k=y("p"),E=O("Do you want to be the "),P=y("strong"),L=O("Word Opponent of the Day?"),W=O(" Sign up here to be in the running."),B=C(),R=y("button"),G=O("BIG SIGNUP BUTTON"),U=C(),J=y("p"),K=y("button"),A=O("How to Play"),this.h()},l(f){e=b(f,"H2",{class:!0});var w=T(e);t=j(w,"Welcome to the Word Game"),w.forEach(d),r=I(f),s=b(f,"P",{});var N=T(s);i=j(N,"One person a day gets the chance to play against the world in a game of words."),N.forEach(d),o=I(f),a=b(f,"P",{});var V=T(a);l=j(V,"Today that person is "),u=b(V,"STRONG",{});var Y=T(u);h=j(Y,"Michelle from Oakland, CA"),Y.forEach(d),c=j(V,". She "),p=b(V,"EM",{});var H=T(p);_=j(H,"really"),H.forEach(d),m=j(V,` likes boba. Can
  you beat her?`),V.forEach(d),g=I(f),k=b(f,"P",{});var ve=T(k);E=j(ve,"Do you want to be the "),P=b(ve,"STRONG",{});var de=T(P);L=j(de,"Word Opponent of the Day?"),de.forEach(d),W=j(ve," Sign up here to be in the running."),ve.forEach(d),B=I(f),R=b(f,"BUTTON",{});var Se=T(R);G=j(Se,"BIG SIGNUP BUTTON"),Se.forEach(d),U=I(f),J=b(f,"P",{});var Ge=T(J);K=b(Ge,"BUTTON",{});var He=T(K);A=j(He,"How to Play"),He.forEach(d),Ge.forEach(d),this.h()},h(){S(e,"class","svelte-1uepkdw")},m(f,w){$(f,e,w),v(e,t),$(f,r,w),$(f,s,w),v(s,i),$(f,o,w),$(f,a,w),v(a,l),v(a,u),v(u,h),v(a,c),v(a,p),v(p,_),v(a,m),$(f,g,w),$(f,k,w),v(k,E),v(k,P),v(P,L),v(k,W),$(f,B,w),$(f,R,w),v(R,G),$(f,U,w),$(f,J,w),v(J,K),v(K,A),z||(M=ce(K,"click",n[1]),z=!0)},p:q,i:q,o:q,d(f){f&&d(e),f&&d(r),f&&d(s),f&&d(o),f&&d(a),f&&d(g),f&&d(k),f&&d(B),f&&d(R),f&&d(U),f&&d(J),z=!1,M()}}}function ao(n,e,t){let r;return x(n,ye,i=>t(0,r=i)),[r,()=>{me(ye,r="rules",r)}]}class lo extends Z{constructor(e){super(),ee(this,e,ao,oo,te,{})}}const uo="1.35.3",rs={"X-Client-Info":`supabase-js/${uo}`},co="supabase.auth.token";function ho(n){return n.replace(/\/$/,"")}const fo=()=>typeof window!="undefined",po="1.22.15",mo="http://localhost:9999",vo={"X-Client-Info":`gotrue-js/${po}`},Tt=10,De={ERROR_MESSAGE:"Request Failed",MAX_RETRIES:10,RETRY_INTERVAL:2},dt="supabase.auth.token",_o={name:"sb",lifetime:60*60*8,domain:"",path:"/",sameSite:"lax"};var bt=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const go=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),wo=(n,e)=>{if(!(n!=null&&n.status))return e({message:De.ERROR_MESSAGE});if(typeof n.json!="function")return e(n);n.json().then(t=>e({message:go(t),status:(n==null?void 0:n.status)||500}))},yo=(n,e,t)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||(r.headers=Object.assign({"Content-Type":"text/plain;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(t)),r};function Nt(n,e,t,r,s){return bt(this,void 0,void 0,function*(){return new Promise((i,o)=>{n(t,yo(e,r,s)).then(a=>{if(!a.ok)throw a;return r!=null&&r.noResolveJson?i:a.json()}).then(a=>i(a)).catch(a=>wo(a,o))})})}function cr(n,e,t){return bt(this,void 0,void 0,function*(){return Nt(n,"GET",e,t)})}function he(n,e,t,r){return bt(this,void 0,void 0,function*(){return Nt(n,"POST",e,r,t)})}function Nn(n,e,t,r){return bt(this,void 0,void 0,function*(){return Nt(n,"PUT",e,r,t)})}function bo(n,e,t,r){return bt(this,void 0,void 0,function*(){return Nt(n,"DELETE",e,r,t)})}function ko(n,e,t){const r=t||{},s=encodeURIComponent,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;if(typeof s!="function")throw new TypeError("option encode is invalid");if(!i.test(n))throw new TypeError("argument name is invalid");const o=s(e);if(o&&!i.test(o))throw new TypeError("argument val is invalid");let a=n+"="+o;if(r.maxAge!=null){const l=r.maxAge-0;if(isNaN(l)||!isFinite(l))throw new TypeError("option maxAge is invalid");a+="; Max-Age="+Math.floor(l)}if(r.domain){if(!i.test(r.domain))throw new TypeError("option domain is invalid");a+="; Domain="+r.domain}if(r.path){if(!i.test(r.path))throw new TypeError("option path is invalid");a+="; Path="+r.path}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");a+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(a+="; HttpOnly"),r.secure&&(a+="; Secure"),r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a}function Eo(n){if(!n||!n.headers||!n.headers.host)throw new Error('The "host" request header is not available');const e=n.headers.host.indexOf(":")>-1&&n.headers.host.split(":")[0]||n.headers.host;return!(["localhost","127.0.0.1"].indexOf(e)>-1||e.endsWith(".local"))}function To(n,e){var t,r,s;return ko(n.name,n.value,{maxAge:n.maxAge,expires:new Date(Date.now()+n.maxAge*1e3),httpOnly:!0,secure:e,path:(t=n.path)!==null&&t!==void 0?t:"/",domain:(r=n.domain)!==null&&r!==void 0?r:"",sameSite:(s=n.sameSite)!==null&&s!==void 0?s:"lax"})}function vr(n,e,t){const r=t.map(i=>To(i,Eo(n))),s=e.getHeader("Set-Cookie");return s&&(s instanceof Array?Array.prototype.push.apply(r,s):typeof s=="string"&&r.push(s)),r}function St(n,e,t){e.setHeader("Set-Cookie",vr(n,e,t))}var So=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Oo(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var _r={exports:{}};(function(n,e){var t=typeof self!="undefined"?self:So,r=function(){function i(){this.fetch=!1,this.DOMException=t.DOMException}return i.prototype=t,new i}();(function(i){(function(o){var a={searchParams:"URLSearchParams"in i,iterable:"Symbol"in i&&"iterator"in Symbol,blob:"FileReader"in i&&"Blob"in i&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in i,arrayBuffer:"ArrayBuffer"in i};function l(f){return f&&DataView.prototype.isPrototypeOf(f)}if(a.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(f){return f&&u.indexOf(Object.prototype.toString.call(f))>-1};function c(f){if(typeof f!="string"&&(f=String(f)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(f))throw new TypeError("Invalid character in header field name");return f.toLowerCase()}function p(f){return typeof f!="string"&&(f=String(f)),f}function _(f){var w={next:function(){var N=f.shift();return{done:N===void 0,value:N}}};return a.iterable&&(w[Symbol.iterator]=function(){return w}),w}function m(f){this.map={},f instanceof m?f.forEach(function(w,N){this.append(N,w)},this):Array.isArray(f)?f.forEach(function(w){this.append(w[0],w[1])},this):f&&Object.getOwnPropertyNames(f).forEach(function(w){this.append(w,f[w])},this)}m.prototype.append=function(f,w){f=c(f),w=p(w);var N=this.map[f];this.map[f]=N?N+", "+w:w},m.prototype.delete=function(f){delete this.map[c(f)]},m.prototype.get=function(f){return f=c(f),this.has(f)?this.map[f]:null},m.prototype.has=function(f){return this.map.hasOwnProperty(c(f))},m.prototype.set=function(f,w){this.map[c(f)]=p(w)},m.prototype.forEach=function(f,w){for(var N in this.map)this.map.hasOwnProperty(N)&&f.call(w,this.map[N],N,this)},m.prototype.keys=function(){var f=[];return this.forEach(function(w,N){f.push(N)}),_(f)},m.prototype.values=function(){var f=[];return this.forEach(function(w){f.push(w)}),_(f)},m.prototype.entries=function(){var f=[];return this.forEach(function(w,N){f.push([N,w])}),_(f)},a.iterable&&(m.prototype[Symbol.iterator]=m.prototype.entries);function g(f){if(f.bodyUsed)return Promise.reject(new TypeError("Already read"));f.bodyUsed=!0}function k(f){return new Promise(function(w,N){f.onload=function(){w(f.result)},f.onerror=function(){N(f.error)}})}function E(f){var w=new FileReader,N=k(w);return w.readAsArrayBuffer(f),N}function P(f){var w=new FileReader,N=k(w);return w.readAsText(f),N}function L(f){for(var w=new Uint8Array(f),N=new Array(w.length),V=0;V<w.length;V++)N[V]=String.fromCharCode(w[V]);return N.join("")}function W(f){if(f.slice)return f.slice(0);var w=new Uint8Array(f.byteLength);return w.set(new Uint8Array(f)),w.buffer}function B(){return this.bodyUsed=!1,this._initBody=function(f){this._bodyInit=f,f?typeof f=="string"?this._bodyText=f:a.blob&&Blob.prototype.isPrototypeOf(f)?this._bodyBlob=f:a.formData&&FormData.prototype.isPrototypeOf(f)?this._bodyFormData=f:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)?this._bodyText=f.toString():a.arrayBuffer&&a.blob&&l(f)?(this._bodyArrayBuffer=W(f.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(f)||h(f))?this._bodyArrayBuffer=W(f):this._bodyText=f=Object.prototype.toString.call(f):this._bodyText="",this.headers.get("content-type")||(typeof f=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var f=g(this);if(f)return f;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(E)}),this.text=function(){var f=g(this);if(f)return f;if(this._bodyBlob)return P(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(L(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(J)}),this.json=function(){return this.text().then(JSON.parse)},this}var R=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function G(f){var w=f.toUpperCase();return R.indexOf(w)>-1?w:f}function U(f,w){w=w||{};var N=w.body;if(f instanceof U){if(f.bodyUsed)throw new TypeError("Already read");this.url=f.url,this.credentials=f.credentials,w.headers||(this.headers=new m(f.headers)),this.method=f.method,this.mode=f.mode,this.signal=f.signal,!N&&f._bodyInit!=null&&(N=f._bodyInit,f.bodyUsed=!0)}else this.url=String(f);if(this.credentials=w.credentials||this.credentials||"same-origin",(w.headers||!this.headers)&&(this.headers=new m(w.headers)),this.method=G(w.method||this.method||"GET"),this.mode=w.mode||this.mode||null,this.signal=w.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&N)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(N)}U.prototype.clone=function(){return new U(this,{body:this._bodyInit})};function J(f){var w=new FormData;return f.trim().split("&").forEach(function(N){if(N){var V=N.split("="),Y=V.shift().replace(/\+/g," "),H=V.join("=").replace(/\+/g," ");w.append(decodeURIComponent(Y),decodeURIComponent(H))}}),w}function K(f){var w=new m,N=f.replace(/\r?\n[\t ]+/g," ");return N.split(/\r?\n/).forEach(function(V){var Y=V.split(":"),H=Y.shift().trim();if(H){var ve=Y.join(":").trim();w.append(H,ve)}}),w}B.call(U.prototype);function A(f,w){w||(w={}),this.type="default",this.status=w.status===void 0?200:w.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in w?w.statusText:"OK",this.headers=new m(w.headers),this.url=w.url||"",this._initBody(f)}B.call(A.prototype),A.prototype.clone=function(){return new A(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})},A.error=function(){var f=new A(null,{status:0,statusText:""});return f.type="error",f};var z=[301,302,303,307,308];A.redirect=function(f,w){if(z.indexOf(w)===-1)throw new RangeError("Invalid status code");return new A(null,{status:w,headers:{location:f}})},o.DOMException=i.DOMException;try{new o.DOMException}catch{o.DOMException=function(w,N){this.message=w,this.name=N;var V=Error(w);this.stack=V.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function M(f,w){return new Promise(function(N,V){var Y=new U(f,w);if(Y.signal&&Y.signal.aborted)return V(new o.DOMException("Aborted","AbortError"));var H=new XMLHttpRequest;function ve(){H.abort()}H.onload=function(){var de={status:H.status,statusText:H.statusText,headers:K(H.getAllResponseHeaders()||"")};de.url="responseURL"in H?H.responseURL:de.headers.get("X-Request-URL");var Se="response"in H?H.response:H.responseText;N(new A(Se,de))},H.onerror=function(){V(new TypeError("Network request failed"))},H.ontimeout=function(){V(new TypeError("Network request failed"))},H.onabort=function(){V(new o.DOMException("Aborted","AbortError"))},H.open(Y.method,Y.url,!0),Y.credentials==="include"?H.withCredentials=!0:Y.credentials==="omit"&&(H.withCredentials=!1),"responseType"in H&&a.blob&&(H.responseType="blob"),Y.headers.forEach(function(de,Se){H.setRequestHeader(Se,de)}),Y.signal&&(Y.signal.addEventListener("abort",ve),H.onreadystatechange=function(){H.readyState===4&&Y.signal.removeEventListener("abort",ve)}),H.send(typeof Y._bodyInit=="undefined"?null:Y._bodyInit)})}return M.polyfill=!0,i.fetch||(i.fetch=M,i.Headers=m,i.Request=U,i.Response=A),o.Headers=m,o.Request=U,o.Response=A,o.fetch=M,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,n.exports=e})(_r,_r.exports);var Ut=Oo(_r.exports),$r=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};function Ae(n){return Math.round(Date.now()/1e3)+n}function jo(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Pe=()=>typeof window!="undefined";function Ce(n,e){var t;e||(e=((t=window==null?void 0:window.location)===null||t===void 0?void 0:t.href)||""),n=n.replace(/[\[\]]/g,"\\$&");const r=new RegExp("[?&#]"+n+"(=([^&#]*)|&|#|$)"),s=r.exec(e);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}const $o=n=>{let e;return n?e=n:typeof fetch=="undefined"?e=Ut:e=fetch,(...t)=>e(...t)},Po=(n,e,t)=>$r(void 0,void 0,void 0,function*(){Pe()&&(yield n==null?void 0:n.setItem(e,JSON.stringify(t)))}),Ro=(n,e)=>$r(void 0,void 0,void 0,function*(){const t=Pe()&&(yield n==null?void 0:n.getItem(e));if(!t)return null;try{return JSON.parse(t)}catch{return t}}),Ao=(n,e)=>{const t=Pe()&&(n==null?void 0:n.getItem(e));if(!t||typeof t!="string")return null;try{return JSON.parse(t)}catch{return t}},Co=(n,e)=>$r(void 0,void 0,void 0,function*(){Pe()&&(yield n==null?void 0:n.removeItem(e))});var ae=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Io{constructor({url:e="",headers:t={},cookieOptions:r,fetch:s}){this.url=e,this.headers=t,this.cookieOptions=Object.assign(Object.assign({},_o),r),this.fetch=$o(s)}_createRequestHeaders(e){const t=Object.assign({},this.headers);return t.Authorization=`Bearer ${e}`,t}cookieName(){var e;return(e=this.cookieOptions.name)!==null&&e!==void 0?e:""}getUrlForProvider(e,t){const r=[`provider=${encodeURIComponent(e)}`];return t!=null&&t.redirectTo&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),`${this.url}/authorize?${r.join("&")}`}signUpWithEmail(e,t,r={}){return ae(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let i="";r.redirectTo&&(i="?redirect_to="+encodeURIComponent(r.redirectTo));const o=yield he(this.fetch,`${this.url}/signup${i}`,{email:e,password:t,data:r.data,gotrue_meta_security:{hcaptcha_token:r.captchaToken}},{headers:s}),a=Object.assign({},o);return a.expires_in&&(a.expires_at=Ae(o.expires_in)),{data:a,error:null}}catch(s){return{data:null,error:s}}})}signInWithEmail(e,t,r={}){return ae(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let i="?grant_type=password";r.redirectTo&&(i+="&redirect_to="+encodeURIComponent(r.redirectTo));const o=yield he(this.fetch,`${this.url}/token${i}`,{email:e,password:t},{headers:s}),a=Object.assign({},o);return a.expires_in&&(a.expires_at=Ae(o.expires_in)),{data:a,error:null}}catch(s){return{data:null,error:s}}})}signUpWithPhone(e,t,r={}){return ae(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers),i=yield he(this.fetch,`${this.url}/signup`,{phone:e,password:t,data:r.data,gotrue_meta_security:{hcaptcha_token:r.captchaToken}},{headers:s}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=Ae(i.expires_in)),{data:o,error:null}}catch(s){return{data:null,error:s}}})}signInWithPhone(e,t){return ae(this,void 0,void 0,function*(){try{const r=Object.assign({},this.headers),s="?grant_type=password",i=yield he(this.fetch,`${this.url}/token${s}`,{phone:e,password:t},{headers:r}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=Ae(i.expires_in)),{data:o,error:null}}catch(r){return{data:null,error:r}}})}signInWithOpenIDConnect({id_token:e,nonce:t,client_id:r,issuer:s,provider:i}){return ae(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),a="?grant_type=id_token",l=yield he(this.fetch,`${this.url}/token${a}`,{id_token:e,nonce:t,client_id:r,issuer:s,provider:i},{headers:o}),u=Object.assign({},l);return u.expires_in&&(u.expires_at=Ae(l.expires_in)),{data:u,error:null}}catch(o){return{data:null,error:o}}})}sendMagicLinkEmail(e,t={}){var r;return ae(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let i="";t.redirectTo&&(i+="?redirect_to="+encodeURIComponent(t.redirectTo));const o=(r=t.shouldCreateUser)!==null&&r!==void 0?r:!0;return{data:yield he(this.fetch,`${this.url}/otp${i}`,{email:e,create_user:o,gotrue_meta_security:{hcaptcha_token:t.captchaToken}},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}sendMobileOTP(e,t={}){var r;return ae(this,void 0,void 0,function*(){try{const s=(r=t.shouldCreateUser)!==null&&r!==void 0?r:!0,i=Object.assign({},this.headers);return{data:yield he(this.fetch,`${this.url}/otp`,{phone:e,create_user:s,gotrue_meta_security:{hcaptcha_token:t.captchaToken}},{headers:i}),error:null}}catch(s){return{data:null,error:s}}})}signOut(e){return ae(this,void 0,void 0,function*(){try{return yield he(this.fetch,`${this.url}/logout`,{},{headers:this._createRequestHeaders(e),noResolveJson:!0}),{error:null}}catch(t){return{error:t}}})}verifyMobileOTP(e,t,r={}){return ae(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers),i=yield he(this.fetch,`${this.url}/verify`,{phone:e,token:t,type:"sms",redirect_to:r.redirectTo},{headers:s}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=Ae(i.expires_in)),{data:o,error:null}}catch(s){return{data:null,error:s}}})}verifyOTP({email:e,phone:t,token:r,type:s="sms"},i={}){return ae(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),a=yield he(this.fetch,`${this.url}/verify`,{email:e,phone:t,token:r,type:s,redirect_to:i.redirectTo},{headers:o}),l=Object.assign({},a);return l.expires_in&&(l.expires_at=Ae(a.expires_in)),{data:l,error:null}}catch(o){return{data:null,error:o}}})}inviteUserByEmail(e,t={}){return ae(this,void 0,void 0,function*(){try{const r=Object.assign({},this.headers);let s="";return t.redirectTo&&(s+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield he(this.fetch,`${this.url}/invite${s}`,{email:e,data:t.data},{headers:r}),error:null}}catch(r){return{data:null,error:r}}})}resetPasswordForEmail(e,t={}){return ae(this,void 0,void 0,function*(){try{const r=Object.assign({},this.headers);let s="";return t.redirectTo&&(s+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield he(this.fetch,`${this.url}/recover${s}`,{email:e,gotrue_meta_security:{hcaptcha_token:t.captchaToken}},{headers:r}),error:null}}catch(r){return{data:null,error:r}}})}refreshAccessToken(e){return ae(this,void 0,void 0,function*(){try{const t=yield he(this.fetch,`${this.url}/token?grant_type=refresh_token`,{refresh_token:e},{headers:this.headers}),r=Object.assign({},t);return r.expires_in&&(r.expires_at=Ae(t.expires_in)),{data:r,error:null}}catch(t){return{data:null,error:t}}})}setAuthCookie(e,t){e.method!=="POST"&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:r,session:s}=e.body;if(!r)throw new Error("Auth event missing!");if(r==="SIGNED_IN"){if(!s)throw new Error("Auth session missing!");St(e,t,[{key:"access-token",value:s.access_token},{key:"refresh-token",value:s.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}r==="SIGNED_OUT"&&St(e,t,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))),t.status(200).json({})}deleteAuthCookie(e,t,{redirectTo:r="/"}){return St(e,t,["access-token","refresh-token"].map(s=>({name:`${this.cookieName()}-${s}`,value:"",maxAge:-1}))),t.redirect(307,r)}getAuthCookieString(e,t){e.method!=="POST"&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:r,session:s}=e.body;if(!r)throw new Error("Auth event missing!");if(r==="SIGNED_IN"){if(!s)throw new Error("Auth session missing!");return vr(e,t,[{key:"access-token",value:s.access_token},{key:"refresh-token",value:s.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}return r==="SIGNED_OUT"?vr(e,t,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))):t.getHeader("Set-Cookie")}generateLink(e,t,r={}){return ae(this,void 0,void 0,function*(){try{return{data:yield he(this.fetch,`${this.url}/admin/generate_link`,{type:e,email:t,password:r.password,data:r.data,redirect_to:r.redirectTo},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}createUser(e){return ae(this,void 0,void 0,function*(){try{const t=yield he(this.fetch,`${this.url}/admin/users`,e,{headers:this.headers});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}listUsers(){return ae(this,void 0,void 0,function*(){try{return{data:(yield cr(this.fetch,`${this.url}/admin/users`,{headers:this.headers})).users,error:null}}catch(e){return{data:null,error:e}}})}getUserById(e){return ae(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/admin/users/${e}`,{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}getUserByCookie(e,t){return ae(this,void 0,void 0,function*(){try{if(!e.cookies)throw new Error("Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!");const r=e.cookies[`${this.cookieName()}-access-token`],s=e.cookies[`${this.cookieName()}-refresh-token`];if(!r)throw new Error("No cookie found!");const{user:i,error:o}=yield this.getUser(r);if(o){if(!s)throw new Error("No refresh_token cookie found!");if(!t)throw new Error("You need to pass the res object to automatically refresh the session!");const{data:a,error:l}=yield this.refreshAccessToken(s);if(l)throw l;if(a)return St(e,t,[{key:"access-token",value:a.access_token},{key:"refresh-token",value:a.refresh_token}].map(u=>{var h;return{name:`${this.cookieName()}-${u.key}`,value:u.value,domain:this.cookieOptions.domain,maxAge:(h=this.cookieOptions.lifetime)!==null&&h!==void 0?h:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}})),{token:a.access_token,user:a.user,data:a.user,error:null}}return{token:r,user:i,data:i,error:null}}catch(r){return{token:null,user:null,data:null,error:r}}})}updateUserById(e,t){return ae(this,void 0,void 0,function*(){try{const r=yield Nn(this.fetch,`${this.url}/admin/users/${e}`,t,{headers:this.headers});return{user:r,data:r,error:null}}catch(r){return{user:null,data:null,error:r}}})}deleteUser(e){return ae(this,void 0,void 0,function*(){try{const t=yield bo(this.fetch,`${this.url}/admin/users/${e}`,{},{headers:this.headers});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}getUser(e){return ae(this,void 0,void 0,function*(){try{const t=yield cr(this.fetch,`${this.url}/user`,{headers:this._createRequestHeaders(e)});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}updateUser(e,t){return ae(this,void 0,void 0,function*(){try{const r=yield Nn(this.fetch,`${this.url}/user`,t,{headers:this._createRequestHeaders(e)});return{user:r,data:r,error:null}}catch(r){return{user:null,data:null,error:r}}})}}function No(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self!="undefined"&&(self.globalThis=self)}}var fe=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};No();const Uo={url:mo,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:vo};class Do{constructor(e){this.stateChangeEmitters=new Map,this.networkRetries=0;const t=Object.assign(Object.assign({},Uo),e);this.currentUser=null,this.currentSession=null,this.autoRefreshToken=t.autoRefreshToken,this.persistSession=t.persistSession,this.multiTab=t.multiTab,this.localStorage=t.localStorage||globalThis.localStorage,this.api=new Io({url:t.url,headers:t.headers,cookieOptions:t.cookieOptions,fetch:t.fetch}),this._recoverSession(),this._recoverAndRefresh(),this._listenForMultiTabEvents(),this._handleVisibilityChange(),t.detectSessionInUrl&&Pe()&&!!Ce("access_token")&&this.getSessionFromUrl({storeSession:!0}).then(({error:r})=>{r&&console.error("Error getting session from URL.",r)})}signUp({email:e,password:t,phone:r},s={}){return fe(this,void 0,void 0,function*(){try{this._removeSession();const{data:i,error:o}=r&&t?yield this.api.signUpWithPhone(r,t,{data:s.data,captchaToken:s.captchaToken}):yield this.api.signUpWithEmail(e,t,{redirectTo:s.redirectTo,data:s.data,captchaToken:s.captchaToken});if(o)throw o;if(!i)throw"An error occurred on sign up.";let a=null,l=null;return i.access_token&&(a=i,l=a.user,this._saveSession(a),this._notifyAllSubscribers("SIGNED_IN")),i.id&&(l=i),{user:l,session:a,error:null}}catch(i){return{user:null,session:null,error:i}}})}signIn({email:e,phone:t,password:r,refreshToken:s,provider:i,oidc:o},a={}){return fe(this,void 0,void 0,function*(){try{if(this._removeSession(),e&&!r){const{error:l}=yield this.api.sendMagicLinkEmail(e,{redirectTo:a.redirectTo,shouldCreateUser:a.shouldCreateUser,captchaToken:a.captchaToken});return{user:null,session:null,error:l}}if(e&&r)return this._handleEmailSignIn(e,r,{redirectTo:a.redirectTo});if(t&&!r){const{error:l}=yield this.api.sendMobileOTP(t,{shouldCreateUser:a.shouldCreateUser,captchaToken:a.captchaToken});return{user:null,session:null,error:l}}if(t&&r)return this._handlePhoneSignIn(t,r);if(s){const{error:l}=yield this._callRefreshToken(s);if(l)throw l;return{user:this.currentUser,session:this.currentSession,error:null}}if(i)return this._handleProviderSignIn(i,{redirectTo:a.redirectTo,scopes:a.scopes});if(o)return this._handleOpenIDConnectSignIn(o);throw new Error("You must provide either an email, phone number, a third-party provider or OpenID Connect.")}catch(l){return{user:null,session:null,error:l}}})}verifyOTP(e,t={}){return fe(this,void 0,void 0,function*(){try{this._removeSession();const{data:r,error:s}=yield this.api.verifyOTP(e,t);if(s)throw s;if(!r)throw"An error occurred on token verification.";let i=null,o=null;return r.access_token&&(i=r,o=i.user,this._saveSession(i),this._notifyAllSubscribers("SIGNED_IN")),r.id&&(o=r),{user:o,session:i,error:null}}catch(r){return{user:null,session:null,error:r}}})}user(){return this.currentUser}session(){return this.currentSession}refreshSession(){var e;return fe(this,void 0,void 0,function*(){try{if(!(!((e=this.currentSession)===null||e===void 0)&&e.access_token))throw new Error("Not logged in.");const{error:t}=yield this._callRefreshToken();if(t)throw t;return{data:this.currentSession,user:this.currentUser,error:null}}catch(t){return{data:null,user:null,error:t}}})}update(e){var t;return fe(this,void 0,void 0,function*(){try{if(!(!((t=this.currentSession)===null||t===void 0)&&t.access_token))throw new Error("Not logged in.");const{user:r,error:s}=yield this.api.updateUser(this.currentSession.access_token,e);if(s)throw s;if(!r)throw Error("Invalid user data.");const i=Object.assign(Object.assign({},this.currentSession),{user:r});return this._saveSession(i),this._notifyAllSubscribers("USER_UPDATED"),{data:r,user:r,error:null}}catch(r){return{data:null,user:null,error:r}}})}setSession(e){return fe(this,void 0,void 0,function*(){try{if(!e)throw new Error("No current session.");const{data:t,error:r}=yield this.api.refreshAccessToken(e);return r?{session:null,error:r}:(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"),{session:t,error:null})}catch(t){return{error:t,session:null}}})}setAuth(e){return this.currentSession=Object.assign(Object.assign({},this.currentSession),{access_token:e,token_type:"bearer",user:this.user()}),this._notifyAllSubscribers("TOKEN_REFRESHED"),this.currentSession}getSessionFromUrl(e){return fe(this,void 0,void 0,function*(){try{if(!Pe())throw new Error("No browser detected.");const t=Ce("error_description");if(t)throw new Error(t);const r=Ce("provider_token"),s=Ce("access_token");if(!s)throw new Error("No access_token detected.");const i=Ce("expires_in");if(!i)throw new Error("No expires_in detected.");const o=Ce("refresh_token");if(!o)throw new Error("No refresh_token detected.");const a=Ce("token_type");if(!a)throw new Error("No token_type detected.");const u=Math.round(Date.now()/1e3)+parseInt(i),{user:h,error:c}=yield this.api.getUser(s);if(c)throw c;const p={provider_token:r,access_token:s,expires_in:parseInt(i),expires_at:u,refresh_token:o,token_type:a,user:h};if(e!=null&&e.storeSession){this._saveSession(p);const _=Ce("type");this._notifyAllSubscribers("SIGNED_IN"),_==="recovery"&&this._notifyAllSubscribers("PASSWORD_RECOVERY")}return window.location.hash="",{data:p,error:null}}catch(t){return{data:null,error:t}}})}signOut(){var e;return fe(this,void 0,void 0,function*(){const t=(e=this.currentSession)===null||e===void 0?void 0:e.access_token;if(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"),t){const{error:r}=yield this.api.signOut(t);if(r)return{error:r}}return{error:null}})}onAuthStateChange(e){try{const t=jo(),r={id:t,callback:e,unsubscribe:()=>{this.stateChangeEmitters.delete(t)}};return this.stateChangeEmitters.set(t,r),{data:r,error:null}}catch(t){return{data:null,error:t}}}_handleEmailSignIn(e,t,r={}){var s,i;return fe(this,void 0,void 0,function*(){try{const{data:o,error:a}=yield this.api.signInWithEmail(e,t,{redirectTo:r.redirectTo});return a||!o?{data:null,user:null,session:null,error:a}:((((s=o==null?void 0:o.user)===null||s===void 0?void 0:s.confirmed_at)||((i=o==null?void 0:o.user)===null||i===void 0?void 0:i.email_confirmed_at))&&(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN")),{data:o,user:o.user,session:o,error:null})}catch(o){return{data:null,user:null,session:null,error:o}}})}_handlePhoneSignIn(e,t){var r;return fe(this,void 0,void 0,function*(){try{const{data:s,error:i}=yield this.api.signInWithPhone(e,t);return i||!s?{data:null,user:null,session:null,error:i}:(!((r=s==null?void 0:s.user)===null||r===void 0)&&r.phone_confirmed_at&&(this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN")),{data:s,user:s.user,session:s,error:null})}catch(s){return{data:null,user:null,session:null,error:s}}})}_handleProviderSignIn(e,t={}){const r=this.api.getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes});try{return Pe()&&(window.location.href=r),{provider:e,url:r,data:null,session:null,user:null,error:null}}catch(s){return r?{provider:e,url:r,data:null,session:null,user:null,error:null}:{data:null,user:null,session:null,error:s}}}_handleOpenIDConnectSignIn({id_token:e,nonce:t,client_id:r,issuer:s,provider:i}){return fe(this,void 0,void 0,function*(){if(e&&t&&(r&&s||i))try{const{data:o,error:a}=yield this.api.signInWithOpenIDConnect({id_token:e,nonce:t,client_id:r,issuer:s,provider:i});return a||!o?{user:null,session:null,error:a}:(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN"),{user:o.user,session:o,error:null})}catch(o){return{user:null,session:null,error:o}}throw new Error("You must provide a OpenID Connect provider with your id token and nonce.")})}_recoverSession(){try{const e=Ao(this.localStorage,dt);if(!e)return null;const{currentSession:t,expiresAt:r}=e,s=Math.round(Date.now()/1e3);r>=s+Tt&&(t==null?void 0:t.user)&&(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"))}catch(e){console.log("error",e)}}_recoverAndRefresh(){return fe(this,void 0,void 0,function*(){try{const e=yield Ro(this.localStorage,dt);if(!e)return null;const{currentSession:t,expiresAt:r}=e,s=Math.round(Date.now()/1e3);if(r<s+Tt)if(this.autoRefreshToken&&t.refresh_token){this.networkRetries++;const{error:i}=yield this._callRefreshToken(t.refresh_token);if(i){if(console.log(i.message),i.message===De.ERROR_MESSAGE&&this.networkRetries<De.MAX_RETRIES){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),this.refreshTokenTimer=setTimeout(()=>this._recoverAndRefresh(),Math.pow(De.RETRY_INTERVAL,this.networkRetries)*100);return}yield this._removeSession()}this.networkRetries=0}else this._removeSession();else t?(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN")):(console.log("Current session is missing data."),this._removeSession())}catch(e){return console.error(e),null}})}_callRefreshToken(e){var t;return e===void 0&&(e=(t=this.currentSession)===null||t===void 0?void 0:t.refresh_token),fe(this,void 0,void 0,function*(){try{if(!e)throw new Error("No current session.");const{data:r,error:s}=yield this.api.refreshAccessToken(e);if(s)throw s;if(!r)throw Error("Invalid session data.");return this._saveSession(r),this._notifyAllSubscribers("TOKEN_REFRESHED"),this._notifyAllSubscribers("SIGNED_IN"),{data:r,error:null}}catch(r){return{data:null,error:r}}})}_notifyAllSubscribers(e){this.stateChangeEmitters.forEach(t=>t.callback(e,this.currentSession))}_saveSession(e){this.currentSession=e,this.currentUser=e.user;const t=e.expires_at;if(t){const r=Math.round(Date.now()/1e3),s=t-r,i=s>Tt?Tt:.5;this._startAutoRefreshToken((s-i)*1e3)}this.persistSession&&e.expires_at&&this._persistSession(this.currentSession)}_persistSession(e){const t={currentSession:e,expiresAt:e.expires_at};Po(this.localStorage,dt,t)}_removeSession(){return fe(this,void 0,void 0,function*(){this.currentSession=null,this.currentUser=null,this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),Co(this.localStorage,dt)})}_startAutoRefreshToken(e){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),!(e<=0||!this.autoRefreshToken)&&(this.refreshTokenTimer=setTimeout(()=>fe(this,void 0,void 0,function*(){this.networkRetries++;const{error:t}=yield this._callRefreshToken();t||(this.networkRetries=0),(t==null?void 0:t.message)===De.ERROR_MESSAGE&&this.networkRetries<De.MAX_RETRIES&&this._startAutoRefreshToken(Math.pow(De.RETRY_INTERVAL,this.networkRetries)*100)}),e),typeof this.refreshTokenTimer.unref=="function"&&this.refreshTokenTimer.unref())}_listenForMultiTabEvents(){if(!this.multiTab||!Pe()||!(window!=null&&window.addEventListener))return!1;try{window==null||window.addEventListener("storage",e=>{var t;if(e.key===dt){const r=JSON.parse(String(e.newValue));!((t=r==null?void 0:r.currentSession)===null||t===void 0)&&t.access_token?(this._saveSession(r.currentSession),this._notifyAllSubscribers("SIGNED_IN")):(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"))}})}catch(e){console.error("_listenForMultiTabEvents",e)}}_handleVisibilityChange(){if(!this.multiTab||!Pe()||!(window!=null&&window.addEventListener))return!1;try{window==null||window.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this._recoverAndRefresh()})}catch(e){console.error("_handleVisibilityChange",e)}}}class Mo extends Do{constructor(e){super(e)}}var Bo=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Pr{constructor(e){Object.assign(this,e);let t;e.fetch?t=e.fetch:typeof fetch=="undefined"?t=Ut:t=fetch,this.fetch=(...r)=>t(...r),this.shouldThrowOnError=e.shouldThrowOnError||!1}throwOnError(e){return e==null&&(e=!0),this.shouldThrowOnError=e,this}then(e,t){typeof this.schema=="undefined"||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let r=this.fetch(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(s=>Bo(this,void 0,void 0,function*(){var i,o,a;let l=null,u=null,h=null;if(s.ok){const p=(i=this.headers.Prefer)===null||i===void 0?void 0:i.split(",").includes("return=minimal");if(this.method!=="HEAD"&&!p){const g=yield s.text();g&&(this.headers.Accept==="text/csv"?u=g:u=JSON.parse(g))}const _=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),m=(a=s.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");_&&m&&m.length>1&&(h=parseInt(m[1]))}else{const p=yield s.text();try{l=JSON.parse(p)}catch{l={message:p}}if(l&&this.shouldThrowOnError)throw l}return{error:l,data:u,count:h,status:s.status,statusText:s.statusText,body:u}}));return this.shouldThrowOnError||(r=r.catch(s=>({error:{message:`FetchError: ${s.message}`,details:"",hint:"",code:s.code||""},data:null,body:null,count:null,status:400,statusText:"Bad Request"}))),r.then(e,t)}}class Rr extends Pr{select(e="*"){let t=!1;const r=e.split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this}order(e,{ascending:t=!0,nullsFirst:r=!1,foreignTable:s}={}){const i=typeof s=="undefined"?"order":`${s}.order`,o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}.${r?"nullsfirst":"nullslast"}`),this}limit(e,{foreignTable:t}={}){const r=typeof t=="undefined"?"limit":`${t}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:r}={}){const s=typeof r=="undefined"?"offset":`${r}.offset`,i=typeof r=="undefined"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){this.headers.Accept="application/vnd.pgrst.object+json";const e=new Rr(this);return e.then=(t,r)=>this.then(s=>{var i,o;return!((o=(i=s.error)===null||i===void 0?void 0:i.details)===null||o===void 0)&&o.includes("Results contain 0 rows")?t({error:null,data:null,count:s.count,status:200,statusText:"OK",body:null}):t(s)},r),e}csv(){return this.headers.Accept="text/csv",this}}class Xe extends Rr{constructor(){super(...arguments),this.cs=this.contains,this.cd=this.containedBy,this.sl=this.rangeLt,this.sr=this.rangeGt,this.nxl=this.rangeGte,this.nxr=this.rangeLte,this.adj=this.rangeAdjacent,this.ov=this.overlaps}not(e,t,r){return this.url.searchParams.append(`${e}`,`not.${t}.${r}`),this}or(e,{foreignTable:t}={}){const r=typeof t=="undefined"?"or":`${t}.or`;return this.url.searchParams.append(r,`(${e})`),this}eq(e,t){return this.url.searchParams.append(`${e}`,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(`${e}`,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(`${e}`,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(`${e}`,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(`${e}`,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(`${e}`,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(`${e}`,`like.${t}`),this}ilike(e,t){return this.url.searchParams.append(`${e}`,`ilike.${t}`),this}is(e,t){return this.url.searchParams.append(`${e}`,`is.${t}`),this}in(e,t){const r=t.map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(`${e}`,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(`${e}`,`cs.{${t.join(",")}}`):this.url.searchParams.append(`${e}`,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(`${e}`,`cd.{${t.join(",")}}`):this.url.searchParams.append(`${e}`,`cd.${JSON.stringify(t)}`),this}rangeLt(e,t){return this.url.searchParams.append(`${e}`,`sl.${t}`),this}rangeGt(e,t){return this.url.searchParams.append(`${e}`,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(`${e}`,`nxl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(`${e}`,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(`${e}`,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`ov.${t}`):this.url.searchParams.append(`${e}`,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s=null}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(`${e}`,`${i}fts${o}.${t}`),this}fts(e,t,{config:r}={}){const s=typeof r=="undefined"?"":`(${r})`;return this.url.searchParams.append(`${e}`,`fts${s}.${t}`),this}plfts(e,t,{config:r}={}){const s=typeof r=="undefined"?"":`(${r})`;return this.url.searchParams.append(`${e}`,`plfts${s}.${t}`),this}phfts(e,t,{config:r}={}){const s=typeof r=="undefined"?"":`(${r})`;return this.url.searchParams.append(`${e}`,`phfts${s}.${t}`),this}wfts(e,t,{config:r}={}){const s=typeof r=="undefined"?"":`(${r})`;return this.url.searchParams.append(`${e}`,`wfts${s}.${t}`),this}filter(e,t,r){return this.url.searchParams.append(`${e}`,`${t}.${r}`),this}match(e){return Object.keys(e).forEach(t=>{this.url.searchParams.append(`${t}`,`eq.${e[t]}`)}),this}}class ns extends Pr{constructor(e,{headers:t={},schema:r,fetch:s,shouldThrowOnError:i}={}){super({fetch:s,shouldThrowOnError:i}),this.url=new URL(e),this.headers=Object.assign({},t),this.schema=r}select(e="*",{head:t=!1,count:r=null}={}){this.method="GET";let s=!1;const i=e.split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),r&&(this.headers.Prefer=`count=${r}`),t&&(this.method="HEAD"),new Xe(this)}insert(e,{upsert:t=!1,onConflict:r,returning:s="representation",count:i=null}={}){this.method="POST";const o=[`return=${s}`];if(t&&o.push("resolution=merge-duplicates"),t&&r!==void 0&&this.url.searchParams.set("on_conflict",r),this.body=e,i&&o.push(`count=${i}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),Array.isArray(e)){const a=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(a.length>0){const l=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new Xe(this)}upsert(e,{onConflict:t,returning:r="representation",count:s=null,ignoreDuplicates:i=!1}={}){this.method="POST";const o=[`resolution=${i?"ignore":"merge"}-duplicates`,`return=${r}`];return t!==void 0&&this.url.searchParams.set("on_conflict",t),this.body=e,s&&o.push(`count=${s}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new Xe(this)}update(e,{returning:t="representation",count:r=null}={}){this.method="PATCH";const s=[`return=${t}`];return this.body=e,r&&s.push(`count=${r}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Xe(this)}delete({returning:e="representation",count:t=null}={}){this.method="DELETE";const r=[`return=${e}`];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Xe(this)}}class Lo extends Pr{constructor(e,{headers:t={},schema:r,fetch:s,shouldThrowOnError:i}={}){super({fetch:s,shouldThrowOnError:i}),this.url=new URL(e),this.headers=Object.assign({},t),this.schema=r}rpc(e,{head:t=!1,count:r=null}={}){return t?(this.method="HEAD",e&&Object.entries(e).forEach(([s,i])=>{this.url.searchParams.append(s,i)})):(this.method="POST",this.body=e),r&&(this.headers.Prefer!==void 0?this.headers.Prefer+=`,count=${r}`:this.headers.Prefer=`count=${r}`),new Xe(this)}}const xo="0.37.2",Fo={"X-Client-Info":`postgrest-js/${xo}`};class Go{constructor(e,{headers:t={},schema:r,fetch:s,throwOnError:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},Fo),t),this.schema=r,this.fetch=s,this.shouldThrowOnError=i}auth(e){return this.headers.Authorization=`Bearer ${e}`,this}from(e){const t=`${this.url}/${e}`;return new ns(t,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(e,t,{head:r=!1,count:s=null}={}){const i=`${this.url}/rpc/${e}`;return new Lo(i,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError}).rpc(t,{head:r,count:s})}}var X;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(X||(X={}));const Un=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=Ho(o,n,e,s),i),{})},Ho=(n,e,t,r)=>{const s=e.find(a=>a.name===n),i=s==null?void 0:s.type,o=t[n];return i&&!r.includes(i)?ss(i,o):gr(o)},ss=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Wo(e,t)}switch(n){case X.bool:return qo(e);case X.float4:case X.float8:case X.int2:case X.int4:case X.int8:case X.numeric:case X.oid:return zo(e);case X.json:case X.jsonb:return Jo(e);case X.timestamp:return Vo(e);case X.abstime:case X.date:case X.daterange:case X.int4range:case X.int8range:case X.money:case X.reltime:case X.text:case X.time:case X.timestamptz:case X.timetz:case X.tsrange:case X.tstzrange:return gr(e);default:return gr(e)}},gr=n=>n,qo=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},zo=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Jo=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Wo=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>ss(e,a))}return n},Vo=n=>typeof n=="string"?n.replace(" ","T"):n,Yo="websocket",Ko="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",Xo=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],Qo="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",Zo=["I\xF1aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],ea="1.0.34",ta={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},ra="https://github.com/theturtle32/WebSocket-Node",na={node:">=4.0.0"},sa={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},ia={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},oa={verbose:!1},aa={test:"tape test/unit/*.js",gulp:"gulp"},la="index",ua={lib:"./lib"},ca="lib/browser.js",ha="Apache-2.0";var fa={name:Yo,description:Ko,keywords:Xo,author:Qo,contributors:Zo,version:ea,repository:ta,homepage:ra,engines:na,dependencies:sa,devDependencies:ia,config:oa,scripts:aa,main:la,directories:ua,browser:ca,license:ha},da=fa.version,Me;if(typeof globalThis=="object")Me=globalThis;else try{Me=require("es5-ext/global")}catch{}finally{if(!Me&&typeof window!="undefined"&&(Me=window),!Me)throw new Error("Could not determine global this")}var gt=Me.WebSocket||Me.MozWebSocket,pa=da;function is(n,e){var t;return e?t=new gt(n,e):t=new gt(n),t}gt&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(n){Object.defineProperty(is,n,{get:function(){return gt[n]}})});var ma={w3cwebsocket:gt?is:null,version:pa};const va="1.7.2",_a={"X-Client-Info":`realtime-js/${va}`},ga="1.0.0",os=1e4,wa=1e3;var _t;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(_t||(_t={}));var Q;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Q||(Q={}));var ue;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(ue||(ue={}));var wr;(function(n){n.websocket="websocket"})(wr||(wr={}));var Be;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Be||(Be={}));class Ar{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class ya{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=r.decode(e.slice(o,o+s));o=o+s;const l=r.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}}class Ze{constructor(e,t,r={},s=os){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel instanceof yr?this.channel.on(this.refEvent,e):this.channel.on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel.trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){!this.refEvent||(this.channel instanceof yr?this.channel.off(this.refEvent):this.channel.off(this.refEvent,{}))}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}class yr{constructor(e,t={},r){this.topic=e,this.params=t,this.socket=r,this.bindings=[],this.state=Q.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new Ze(this,ue.join,this.params,this.timeout),this.rejoinTimer=new Ar(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Q.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=Q.closed,this.socket.remove(this)}),this.onError(s=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this.isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.on(ue.reply,(s,i)=>{this.trigger(this.replyEventName(i),s)})}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(e=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(e),this.joinPush}onClose(e){this.on(ue.close,e)}onError(e){this.on(ue.error,t=>e(t))}on(e,t){this.bindings.push({event:e,callback:t})}off(e){this.bindings=this.bindings.filter(t=>t.event!==e)}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Ze(this,e,t,r);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Q.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(ue.close,"leave",this.joinRef())};this.joinPush.destroy();let r=new Ze(this,ue.leave,{},e);return r.receive("ok",()=>t()).receive("timeout",()=>t()),r.send(),this.canPush()||r.trigger("ok",{}),r}onMessage(e,t,r){return t}isMember(e){return this.topic===e}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=Q.joining,this.joinPush.resend(e))}trigger(e,t,r){let{close:s,error:i,leave:o,join:a}=ue;if(r&&[s,i,o,a].indexOf(e)>=0&&r!==this.joinRef())return;let u=this.onMessage(e,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(h=>h.event==="*"?e===(t==null?void 0:t.type):h.event===e).map(h=>h.callback(u,r))}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===Q.closed}isErrored(){return this.state===Q.errored}isJoined(){return this.state===Q.joined}isJoining(){return this.state===Q.joining}isLeaving(){return this.state===Q.leaving}}class Qe{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel.on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel.joinRef(),this.state=Qe.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=Qe.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel.on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Qe.syncDiff(this.state,s,i,o),a())})}static syncState(e,t,r,s){const i=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(i,(u,h)=>{o[u]||(l[u]=h)}),this.map(o,(u,h)=>{const c=i[u];if(c){const p=h.map(k=>k.presence_id),_=c.map(k=>k.presence_id),m=h.filter(k=>_.indexOf(k.presence_id)<0),g=c.filter(k=>p.indexOf(k.presence_id)<0);m.length>0&&(a[u]=m),g.length>0&&(l[u]=g)}else a[u]=h}),this.syncDiff(i,{joins:a,leaves:l},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{const u=e[a];if(e[a]=this.cloneDeep(l),u){const h=e[a].map(p=>p.presence_id),c=u.filter(p=>h.indexOf(p.presence_id)<0);e[a].unshift(...c)}r(a,u,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const h=l.map(c=>c.presence_id);u=u.filter(c=>h.indexOf(c.presence_id)<0),e[a]=u,s(a,u,l),u.length===0&&delete e[a]}),e}static list(e,t){return t||(t=(r,s)=>s),this.map(e,(r,s)=>t(r,s))}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_id=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}list(e){return Qe.list(this.state,e)}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel.joinRef()}}class At{constructor(e,t={},r){this.topic=e,this.params=t,this.socket=r,this.bindings=[],this.state=Q.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new Ze(this,ue.join,this.params,this.timeout),this.rejoinTimer=new Ar(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Q.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=Q.closed,this.socket.remove(this)}),this.onError(s=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this.isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.on(ue.reply,{},(s,i)=>{this.trigger(this.replyEventName(i),s)}),this.presence=new Qe(this)}list(){return this.presence.list()}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(e=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const t=this.bindings.reduce((r,s)=>{const{type:i}=s;return["phx_close","phx_error","phx_reply","presence_diff","presence_state"].includes(i)||(r[i]=s),r},{});return Object.keys(t).length&&this.updateJoinPayload({configs:t}),this.joinedOnce=!0,this.rejoin(e),this.joinPush}}onClose(e){this.on(ue.close,{},e)}onError(e){this.on(ue.error,{},t=>e(t))}on(e,t,r){this.bindings.push({type:e,filter:t!=null?t:{},callback:r!=null?r:()=>{}})}off(e,t){this.bindings=this.bindings.filter(r=>!(r.type===e&&At.isEqual(r.filter,t)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Ze(this,e,t,r);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Q.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(ue.close,"leave",this.joinRef())};this.joinPush.destroy();const r=new Ze(this,ue.leave,{},e);return r.receive("ok",()=>t()).receive("timeout",()=>t()),r.send(),this.canPush()||r.trigger("ok",{}),r}onMessage(e,t,r){return t}isMember(e){return this.topic===e}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=Q.joining,this.joinPush.resend(e))}trigger(e,t,r){const{close:s,error:i,leave:o,join:a}=ue;if(r&&[s,i,o,a].indexOf(e)>=0&&r!==this.joinRef())return;const u=this.onMessage(e,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(h=>{var c,p;return(h==null?void 0:h.type)===e&&(((c=h==null?void 0:h.filter)===null||c===void 0?void 0:c.event)==="*"||((p=h==null?void 0:h.filter)===null||p===void 0?void 0:p.event)===(t==null?void 0:t.event))}).map(h=>h.callback(u,r))}send(e){const t=this.push(e.type,e);return new Promise((r,s)=>{t.receive("ok",()=>r("ok")),t.receive("timeout",()=>s("timeout"))})}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===Q.closed}isErrored(){return this.state===Q.errored}isJoined(){return this.state===Q.joined}isJoining(){return this.state===Q.joining}isLeaving(){return this.state===Q.leaving}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}}var ba=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},ka=globalThis&&globalThis.__rest||function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const Ea=()=>{};class Ta{constructor(e,t){this.accessToken=null,this.channels=[],this.endPoint="",this.headers=_a,this.params={},this.timeout=os,this.transport=ma.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.longpollerTimeout=2e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Ea,this.conn=null,this.sendBuffer=[],this.serializer=new ya,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.endPoint=`${e}/${wr.websocket}`,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.transport&&(this.transport=t.transport),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs),t!=null&&t.longpollerTimeout&&(this.longpollerTimeout=t.longpollerTimeout),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:r=>[1e3,2e3,5e3,1e4][r-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(r,s)=>s(JSON.stringify(r)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ar(()=>ba(this,void 0,void 0,function*(){yield this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this.endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this.onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e)))}disconnect(e,t){return new Promise((r,s)=>{try{this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t||""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset()),r({error:null,data:!0})}catch(i){r({error:i,data:!1})}})}log(e,t,r){this.logger(e,t,r)}onOpen(e){this.stateChangeCallbacks.open.push(e)}onClose(e){this.stateChangeCallbacks.close.push(e)}onError(e){this.stateChangeCallbacks.error.push(e)}onMessage(e){this.stateChangeCallbacks.message.push(e)}connectionState(){switch(this.conn&&this.conn.readyState){case _t.connecting:return Be.Connecting;case _t.open:return Be.Open;case _t.closing:return Be.Closing;default:return Be.Closed}}isConnected(){return this.connectionState()===Be.Open}remove(e){this.channels=this.channels.filter(t=>t.joinRef()!==e.joinRef())}channel(e,t={}){var r;const{selfBroadcast:s}=t,i=ka(t,["selfBroadcast"]);s&&(i.self_broadcast=s);const o=!((r=this.params)===null||r===void 0)&&r.vsndate?new At(e,i,this):new yr(e,i,this);return o instanceof At&&(o.presence.onJoin((a,l,u)=>{o.trigger("presence",{event:"JOIN",key:a,currentPresences:l,newPresences:u})}),o.presence.onLeave((a,l,u)=>{o.trigger("presence",{event:"LEAVE",key:a,currentPresences:l,leftPresences:u})}),o.presence.onSync(()=>{o.trigger("presence",{event:"SYNC"})})),this.channels.push(o),o}push(e){const{topic:t,event:r,payload:s,ref:i}=e;let o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:o}=t;(o&&o===this.pendingHeartbeatRef||s===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,i),this.channels.filter(a=>a.isMember(r)).forEach(a=>a.trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ga}))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({user_token:e}),t.joinedOnce&&t.isJoined()&&t.push(ue.access_token,{access_token:e})})}leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r.isJoined()||r.isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_onConnOpen(){this.log("transport",`connected to ${this.endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e.trigger(ue.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(!!this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(wa,"hearbeat timeout");return}this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class Sa{constructor(e,t,r,s){const i={},o=s==="*"?`realtime:${r}`:`realtime:${r}:${s}`,a=t.Authorization.split(" ")[1];a&&(i.user_token=a),this.subscription=e.channel(o,i)}getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Un(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Un(e.columns,e.old_record)),t}on(e,t){return this.subscription.on(e,r=>{let s={schema:r.schema,table:r.table,commit_timestamp:r.commit_timestamp,eventType:r.type,new:{},old:{},errors:r.errors};s=Object.assign(Object.assign({},s),this.getPayloadRecords(r)),t(s)}),this}subscribe(e=()=>{}){return this.subscription.onError(t=>e("SUBSCRIPTION_ERROR",t)),this.subscription.onClose(()=>e("CLOSED")),this.subscription.subscribe().receive("ok",()=>e("SUBSCRIBED")).receive("error",t=>e("SUBSCRIPTION_ERROR",t)).receive("timeout",()=>e("RETRYING_AFTER_TIMEOUT")),this.subscription}}class Oa extends ns{constructor(e,{headers:t={},schema:r,realtime:s,table:i,fetch:o,shouldThrowOnError:a}){super(e,{headers:t,schema:r,fetch:o,shouldThrowOnError:a}),this._subscription=null,this._realtime=s,this._headers=t,this._schema=r,this._table=i}on(e,t){return this._realtime.isConnected()||this._realtime.connect(),this._subscription||(this._subscription=new Sa(this._realtime,this._headers,this._schema,this._table)),this._subscription.on(e,t)}}const ja="0.0.0",$a={"X-Client-Info":`storage-js/${ja}`};var kt=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Pa=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Ra=(n,e)=>{if(typeof n.json!="function")return e(n);n.json().then(t=>e({message:Pa(t),status:(n==null?void 0:n.status)||500}))},Aa=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};function Dt(n,e,t,r,s,i){return kt(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(t,Aa(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?o(l):l.json()}).then(l=>o(l)).catch(l=>Ra(l,a))})})}function br(n,e,t,r){return kt(this,void 0,void 0,function*(){return Dt(n,"GET",e,t,r)})}function Le(n,e,t,r,s){return kt(this,void 0,void 0,function*(){return Dt(n,"POST",e,r,s,t)})}function Ca(n,e,t,r,s){return kt(this,void 0,void 0,function*(){return Dt(n,"PUT",e,r,s,t)})}function as(n,e,t,r,s){return kt(this,void 0,void 0,function*(){return Dt(n,"DELETE",e,r,s,t)})}const ls=n=>{let e;return n?e=n:typeof fetch=="undefined"?e=Ut:e=fetch,(...t)=>e(...t)};var Ke=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Ia{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},$a),t),this.fetch=ls(r)}listBuckets(){return Ke(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}getBucket(e){return Ke(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}createBucket(e,t={public:!1}){return Ke(this,void 0,void 0,function*(){try{return{data:(yield Le(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public},{headers:this.headers})).name,error:null}}catch(r){return{data:null,error:r}}})}updateBucket(e,t){return Ke(this,void 0,void 0,function*(){try{return{data:yield Ca(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public},{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}emptyBucket(e){return Ke(this,void 0,void 0,function*(){try{return{data:yield Le(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}deleteBucket(e){return Ke(this,void 0,void 0,function*(){try{return{data:yield as(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}}var je=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Na={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ua={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Da{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=ls(s)}uploadOrUpdate(e,t,r,s){return je(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Ua),s),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob!="undefined"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",r)):typeof FormData!="undefined"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl)):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType);const l=this._removeEmptyFolders(t),u=this._getFinalPath(l),h=yield this.fetch(`${this.url}/object/${u}`,{method:e,body:i,headers:a});if(h.ok)return{data:{Key:u},error:null};{const c=yield h.json();return{data:null,error:c}}}catch(i){return{data:null,error:i}}})}upload(e,t,r){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}update(e,t,r){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t){return je(this,void 0,void 0,function*(){try{return{data:yield Le(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}copy(e,t){return je(this,void 0,void 0,function*(){try{return{data:yield Le(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}createSignedUrl(e,t){return je(this,void 0,void 0,function*(){try{const r=this._getFinalPath(e);let s=yield Le(this.fetch,`${this.url}/object/sign/${r}`,{expiresIn:t},{headers:this.headers});const i=`${this.url}${s.signedURL}`;return s={signedURL:i},{data:s,error:null,signedURL:i}}catch(r){return{data:null,error:r,signedURL:null}}})}createSignedUrls(e,t){return je(this,void 0,void 0,function*(){try{return{data:(yield Le(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers})).map(s=>Object.assign(Object.assign({},s),{signedURL:s.signedURL?`${this.url}${s.signedURL}`:null})),error:null}}catch(r){return{data:null,error:r}}})}download(e){return je(this,void 0,void 0,function*(){try{const t=this._getFinalPath(e);return{data:yield(yield br(this.fetch,`${this.url}/object/${t}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(t){return{data:null,error:t}}})}getPublicUrl(e){try{const t=this._getFinalPath(e),r=`${this.url}/object/public/${t}`;return{data:{publicURL:r},error:null,publicURL:r}}catch(t){return{data:null,error:t,publicURL:null}}}remove(e){return je(this,void 0,void 0,function*(){try{return{data:yield as(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}list(e,t,r){return je(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Na),t),{prefix:e||""});return{data:yield Le(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){return{data:null,error:s}}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}}class Ma extends Ia{constructor(e,t={},r){super(e,t,r)}from(e){return new Da(this.url,this.headers,e,this.fetch)}}const Ba=n=>{let e;return n?e=n:typeof fetch=="undefined"?e=Ut:e=fetch,(...t)=>e(...t)};var La=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class xa{constructor(e,{headers:t={},customFetch:r}={}){this.url=e,this.headers=t,this.fetch=Ba(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t){return La(this,void 0,void 0,function*(){try{const{headers:r,body:s}=t!=null?t:{},i=yield this.fetch(`${this.url}/${e}`,{method:"POST",headers:Object.assign({},this.headers,r),body:s}),o=i.headers.get("x-relay-error");if(o&&o==="true")return{data:null,error:new Error(yield i.text())};let a;const{responseType:l}=t!=null?t:{};return!l||l==="json"?a=yield i.json():l==="arrayBuffer"?a=yield i.arrayBuffer():l==="blob"?a=yield i.blob():a=yield i.text(),{data:a,error:null}}catch(r){return{data:null,error:r}}})}}var Ot=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(h){try{u(r.next(h))}catch(c){o(c)}}function l(h){try{u(r.throw(h))}catch(c){o(c)}}function u(h){h.done?i(h.value):s(h.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Fa={schema:"public",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:rs};class Ga{constructor(e,t,r){if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const s=ho(e),i=Object.assign(Object.assign({},Fa),r);if(this.restUrl=`${s}/rest/v1`,this.realtimeUrl=`${s}/realtime/v1`.replace("http","ws"),this.authUrl=`${s}/auth/v1`,this.storageUrl=`${s}/storage/v1`,s.match(/(supabase\.co)|(supabase\.in)/)){const a=s.split(".");this.functionsUrl=`${a[0]}.functions.${a[1]}.${a[2]}`}else this.functionsUrl=`${s}/functions/v1`;this.schema=i.schema,this.multiTab=i.multiTab,this.fetch=i.fetch,this.headers=Object.assign(Object.assign({},rs),r==null?void 0:r.headers),this.shouldThrowOnError=i.shouldThrowOnError||!1,this.auth=this._initSupabaseAuthClient(i),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},i.realtime)),this._listenForAuthEvents(),this._listenForMultiTabEvents()}get functions(){return new xa(this.functionsUrl,{headers:this._getAuthHeaders(),customFetch:this.fetch})}get storage(){return new Ma(this.storageUrl,this._getAuthHeaders(),this.fetch)}from(e){const t=`${this.restUrl}/${e}`;return new Oa(t,{headers:this._getAuthHeaders(),schema:this.schema,realtime:this.realtime,table:e,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(e,t,{head:r=!1,count:s=null}={}){return this._initPostgRESTClient().rpc(e,t,{head:r,count:s})}channel(e,t){var r,s;const i=(s=(r=this.auth.session())===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:this.supabaseKey;return this.realtime.isConnected()||this.realtime.connect(),this.realtime.channel(e,Object.assign(Object.assign({},t),{user_token:i}))}removeAllSubscriptions(){return Ot(this,void 0,void 0,function*(){const e=this.getSubscriptions().slice(),t=e.map(s=>this.removeSubscription(s));return(yield Promise.all(t)).map(({error:s},i)=>({data:{subscription:e[i]},error:s}))})}removeChannel(e){return Ot(this,void 0,void 0,function*(){const{error:t}=yield this._closeSubscription(e),r=this.getSubscriptions(),s=r.filter(i=>i.isJoined()).length;return r.length===0&&(yield this.realtime.disconnect()),{data:{openChannels:s},error:t}})}removeSubscription(e){return Ot(this,void 0,void 0,function*(){const{error:t}=yield this._closeSubscription(e),r=this.getSubscriptions(),s=r.filter(i=>i.isJoined()).length;return r.length===0&&(yield this.realtime.disconnect()),{data:{openSubscriptions:s},error:t}})}_closeSubscription(e){return Ot(this,void 0,void 0,function*(){let t=null;if(!e.isClosed()){const{error:r}=yield this._unsubscribeSubscription(e);t=r}return this.realtime.remove(e),{error:t}})}_unsubscribeSubscription(e){return new Promise(t=>{e.unsubscribe().receive("ok",()=>t({error:null})).receive("error",r=>t({error:r})).receive("timeout",()=>t({error:new Error("timed out")}))})}getSubscriptions(){return this.realtime.channels}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,localStorage:s,headers:i,fetch:o,cookieOptions:a,multiTab:l}){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Mo({url:this.authUrl,headers:Object.assign(Object.assign({},i),u),autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,localStorage:s,fetch:o,cookieOptions:a,multiTab:l})}_initRealtimeClient(e){return new Ta(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign(Object.assign({},e==null?void 0:e.params),{apikey:this.supabaseKey})}))}_initPostgRESTClient(){return new Go(this.restUrl,{headers:this._getAuthHeaders(),schema:this.schema,fetch:this.fetch,throwOnError:this.shouldThrowOnError})}_getAuthHeaders(){var e,t;const r=Object.assign({},this.headers),s=(t=(e=this.auth.session())===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey;return r.apikey=this.supabaseKey,r.Authorization=r.Authorization||`Bearer ${s}`,r}_listenForMultiTabEvents(){if(!this.multiTab||!fo()||!(window!=null&&window.addEventListener))return null;try{return window==null?void 0:window.addEventListener("storage",e=>{var t,r,s;if(e.key===co){const i=JSON.parse(String(e.newValue)),o=(r=(t=i==null?void 0:i.currentSession)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:void 0,a=(s=this.auth.session())===null||s===void 0?void 0:s.access_token;o?!a&&o?this._handleTokenChanged("SIGNED_IN",o,"STORAGE"):a!==o&&this._handleTokenChanged("TOKEN_REFRESHED",o,"STORAGE"):this._handleTokenChanged("SIGNED_OUT",o,"STORAGE")}})}catch(e){return console.error("_listenForMultiTabEvents",e),null}}_listenForAuthEvents(){let{data:e}=this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,r==null?void 0:r.access_token,"CLIENT")});return e}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.realtime.setAuth(t),r=="STORAGE"&&this.auth.setAuth(t),this.changedAccessToken=t):(e==="SIGNED_OUT"||e==="USER_DELETED")&&(this.realtime.setAuth(this.supabaseKey),r=="STORAGE"&&this.auth.signOut())}}const Ha=(n,e,t)=>new Ga(n,e,t),qa="https://dbmtysppmiwwjwaeneex.supabase.co",za="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRibXR5c3BwbWl3d2p3YWVuZWV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDQ5NTI0NDUsImV4cCI6MTk2MDUyODQ0NX0.i_1JrAfv5fieeVaiJrVIQPL6V0_-H9sR-PKIuGDAIfI",Fe=Ha(qa,za),Ja=async n=>{const e=await Fe.from("wordgame_wod-questions").select("question,id,category").in("id",n);if(e.error)throw console.log(e.error),new Error("getQuestionText failed");if(e.data)return e.data},Ll=async({email:n,password:e})=>{const t=await Fe.auth.signIn({email:n,password:e});if(t.error)throw console.log(t.error),new Error("signIn failed");if(t.user)return!0;throw new Error("no user found")},Wa=async n=>{const e=await Fe.from("wordgame_games").select("question_ids").eq("id",n);if(e.error)throw console.log(e.error),new Error("getQuestions failed");if(e.data.length)try{const t=e.data[0].question_ids.split("|").map(s=>+s);return await Ja(t)}catch(t){return t}throw new Error("no questions matching that game id")},xl=async n=>{const e=await Fe.from("wordgame_games").select("wod_started").eq("id",n);if(e.error)throw console.log(e.error),new Error("getWodStarted failed");if(e.data.length)return e.data[0].wod_started;throw new Error("no games matching this id")},us=async({table:n,column:e,value:t,id:r})=>{const s=await Fe.from(n).update({[e]:t}).eq("id",r);if(s.error)throw console.log(s.error),new Error("update failed");if(s.data)return s.data},Va=async({table:n,data:e})=>{const t=await Fe.from(n).insert(e);if(t.error)throw console.log(t.error),new Error("insert failed");if(t.data)return t.data},Ya=async({table:n,data:e})=>{const t=await Fe.from(n).upsert(e);if(t.error)throw console.log(t.error),new Error("upsert failed");if(t.data)return t.data};function Dn(n,e,t){const r=n.slice();r[8]=e[t].id,r[9]=e[t].question,r[10]=e[t].category,r[12]=e,r[13]=t;const s=r[10]==="standard";return r[11]=s,r}function Ka(n){let e,t,r,s,i;return{c(){e=y("p"),t=y("button"),r=O("How to Play")},l(o){e=b(o,"P",{});var a=T(e);t=b(a,"BUTTON",{});var l=T(t);r=j(l,"How to Play"),l.forEach(d),a.forEach(d)},m(o,a){$(o,e,a),v(e,t),v(t,r),s||(i=ce(t,"click",n[6]),s=!0)},p:q,d(o){o&&d(e),s=!1,i()}}}function Xa(n){let e,t,r,s;function i(l,u){return l[2]?Za:Qa}let o=i(n),a=o(n);return{c(){e=y("p"),t=O("Tell us about yourself:"),r=C(),a.c(),s=oe()},l(l){e=b(l,"P",{});var u=T(e);t=j(u,"Tell us about yourself:"),u.forEach(d),r=I(l),a.l(l),s=oe()},m(l,u){$(l,e,u),v(e,t),$(l,r,u),a.m(l,u),$(l,s,u)},p(l,u){o===(o=i(l))&&a?a.p(l,u):(a.d(1),a=o(l),a&&(a.c(),a.m(s.parentNode,s)))},d(l){l&&d(e),l&&d(r),a.d(l),l&&d(s)}}}function Qa(n){let e,t,r,s,i,o,a=n[1],l=[];for(let u=0;u<a.length;u+=1)l[u]=Mn(Dn(n,a,u));return{c(){e=y("form");for(let u=0;u<l.length;u+=1)l[u].c();t=C(),r=y("button"),s=O("Submit"),this.h()},l(u){e=b(u,"FORM",{});var h=T(e);for(let p=0;p<l.length;p+=1)l[p].l(h);t=I(h),r=b(h,"BUTTON",{type:!0});var c=T(r);s=j(c,"Submit"),c.forEach(d),h.forEach(d),this.h()},h(){S(r,"type","submit")},m(u,h){$(u,e,h);for(let c=0;c<l.length;c+=1)l[c].m(e,null);v(e,t),v(e,r),v(r,s),i||(o=ce(e,"submit",bs(n[4])),i=!0)},p(u,h){if(h&2){a=u[1];let c;for(c=0;c<a.length;c+=1){const p=Dn(u,a,c);l[c]?l[c].p(p,h):(l[c]=Mn(p),l[c].c(),l[c].m(e,t))}for(;c<l.length;c+=1)l[c].d(1);l.length=a.length}},d(u){u&&d(e),rt(l,u),i=!1,o()}}}function Za(n){let e,t;return{c(){e=y("p"),t=O("Error")},l(r){e=b(r,"P",{});var s=T(e);t=j(s,"Error"),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},p:q,d(r){r&&d(e)}}}function Mn(n){let e,t,r=n[9]+"",s,i,o,a,l,u,h,c;function p(){n[5].call(a,n[13])}return{c(){e=y("div"),t=y("label"),s=O(r),o=C(),a=y("input"),this.h()},l(_){e=b(_,"DIV",{});var m=T(e);t=b(m,"LABEL",{for:!0});var g=T(t);s=j(g,r),g.forEach(d),o=I(m),a=b(m,"INPUT",{id:!0,placeholder:!0}),m.forEach(d),this.h()},h(){S(t,"for",i="question-"+n[8]),a.required=l=n[11],S(a,"id",u="question-"+n[8]),S(a,"placeholder","")},m(_,m){$(_,e,m),v(e,t),v(t,s),v(e,o),v(e,a),$t(a,n[1][n[13]].answer),h||(c=ce(a,"input",p),h=!0)},p(_,m){n=_,m&2&&r!==(r=n[9]+"")&&le(s,r),m&2&&i!==(i="question-"+n[8])&&S(t,"for",i),m&2&&l!==(l=n[11])&&(a.required=l),m&2&&u!==(u="question-"+n[8])&&S(a,"id",u),m&2&&a.value!==n[1][n[13]].answer&&$t(a,n[1][n[13]].answer)},d(_){_&&d(e),h=!1,c()}}}function el(n){let e,t,r,s,i,o,a;function l(c,p){return c[0]?Ka:Xa}let u=l(n),h=u(n);return{c(){e=y("h2"),t=O("Welcome, WOD!"),r=C(),s=y("p"),i=O("Let's play a word game!"),o=C(),h.c(),a=oe(),this.h()},l(c){e=b(c,"H2",{class:!0});var p=T(e);t=j(p,"Welcome, WOD!"),p.forEach(d),r=I(c),s=b(c,"P",{});var _=T(s);i=j(_,"Let's play a word game!"),_.forEach(d),o=I(c),h.l(c),a=oe(),this.h()},h(){S(e,"class","svelte-1uepkdw")},m(c,p){$(c,e,p),v(e,t),$(c,r,p),$(c,s,p),v(s,i),$(c,o,p),h.m(c,p),$(c,a,p)},p(c,[p]){u===(u=l(c))&&h?h.p(c,p):(h.d(1),h=u(c),h&&(h.c(),h.m(a.parentNode,a)))},i:q,o:q,d(c){c&&d(e),c&&d(r),c&&d(s),c&&d(o),h.d(c),c&&d(a)}}}function tl(n,e,t){let r,s;x(n,It,c=>t(7,r=c)),x(n,ye,c=>t(3,s=c));let{wodReady:i}=e,o=[],a;const l=async()=>{console.log("submit");try{const c=o.map(p=>({game_id:r,question_id:p.id,answer:p.answer}));await Ya({table:"wordgame_wod-info",data:c}),t(0,i=!0),console.log({wodReady:i})}catch(c){console.log(c)}};yt(async()=>{console.log("mount");try{t(1,o=await Wa(r))}catch{t(2,a=!0)}});function u(c){o[c].answer=this.value,t(1,o)}const h=()=>{me(ye,s="rules",s)};return n.$$set=c=>{"wodReady"in c&&t(0,i=c.wodReady)},n.$$.update=()=>{n.$$.dirty&1&&console.log({wodReady:i})},[i,o,a,s,l,u,h]}class rl extends Z{constructor(e){super(),ee(this,e,tl,el,te,{wodReady:0})}}function nl(n){let e,t;return{c(){e=y("p"),t=O(n[1])},l(r){e=b(r,"P",{});var s=T(e);t=j(s,n[1]),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},p(r,s){s&2&&le(t,r[1])},d(r){r&&d(e)}}}function sl(n){let e,t;return{c(){e=y("p"),t=O("Submitting responses...")},l(r){e=b(r,"P",{});var s=T(e);t=j(s,"Submitting responses..."),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},p:q,d(r){r&&d(e)}}}function il(n){let e,t,r,s;function i(l,u){return l[0]===void 0?sl:nl}let o=i(n),a=o(n);return{c(){e=y("h2"),t=O("Thanks for playing!"),r=C(),a.c(),s=oe()},l(l){e=b(l,"H2",{});var u=T(e);t=j(u,"Thanks for playing!"),u.forEach(d),r=I(l),a.l(l),s=oe()},m(l,u){$(l,e,u),v(e,t),$(l,r,u),a.m(l,u),$(l,s,u)},p(l,[u]){o===(o=i(l))&&a?a.p(l,u):(a.d(1),a=o(l),a&&(a.c(),a.m(s.parentNode,s)))},i:q,o:q,d(l){l&&d(e),l&&d(r),a.d(l),l&&d(s)}}}function ol(n,e,t){let r,s,i;x(n,It,a=>t(2,s=a)),x(n,Te,a=>t(3,i=a));let o;return yt(async()=>{try{const l=[].concat(...i.user).filter(h=>h.valid).map(h=>({game_id:s,round:h.round,text:h.text,timestamp:h.timestamp,points:h.points,lemmas:h.lemmas}));(await Va({table:"wordgame_wod-answers",data:l})).length?(t(0,o=!0),await us({table:"wordgame_games",column:"wod_finished",value:!0,id:s})):t(0,o=!1)}catch{t(0,o=!1)}}),n.$$.update=()=>{n.$$.dirty&1&&t(1,r=o?"Game successfully submitted!":"There was an error submitting your game. Please contact admins.")},[o,r]}class al extends Z{constructor(e){super(),ee(this,e,ol,il,te,{})}}const ll=async n=>{if("clipboard"in navigator)await navigator.clipboard.writeText(n);else{const e=document.createElement("input");e.type="text",e.disabled=!0,e.style.setProperty("position","fixed"),e.style.setProperty("z-index","-100"),e.style.setProperty("pointer-events","none"),e.style.setProperty("opacity","0"),e.value=n,document.body.appendChild(e),e.click(),e.select(),document.execCommand("copy"),document.body.removeChild(e)}},ul=(n,e)=>{async function t(){if(e)try{await ll(e),n.dispatchEvent(new CustomEvent("svelte-copy",{detail:e}))}catch(r){n.dispatchEvent(new CustomEvent("svelte-copy:error",{detail:r}))}}return n.addEventListener("click",t,!0),{update:r=>e=r,destroy:()=>n.removeEventListener("click",t,!0)}};function cl(n){let e,t,r,s,i,o,a,l,u,h,c,p,_;return{c(){e=y("p"),t=O("Use the copy button below, then "),r=y("a"),s=O("click here"),i=O(" to give us feedback!"),o=C(),a=y("textarea"),l=C(),u=y("button"),h=O("Copy to clipboard"),this.h()},l(m){e=b(m,"P",{class:!0});var g=T(e);t=j(g,"Use the copy button below, then "),r=b(g,"A",{href:!0,target:!0});var k=T(r);s=j(k,"click here"),k.forEach(d),i=j(g," to give us feedback!"),g.forEach(d),o=I(m),a=b(m,"TEXTAREA",{style:!0,class:!0}),T(a).forEach(d),l=I(m),u=b(m,"BUTTON",{});var E=T(u);h=j(E,"Copy to clipboard"),E.forEach(d),this.h()},h(){S(r,"href","https://forms.gle/P8npksT5XLE6tFWT8"),S(r,"target","_blank"),S(e,"class","svelte-bkfopd"),ks(a,"width","100%"),a.value=n[0],S(a,"class","svelte-bkfopd")},m(m,g){$(m,e,g),v(e,t),v(e,r),v(r,s),v(e,i),$(m,o,g),$(m,a,g),$(m,l,g),$(m,u,g),v(u,h),p||(_=Es(c=ul.call(null,u,n[0])),p=!0)},p(m,[g]){g&1&&(a.value=m[0]),c&&Ts(c.update)&&g&1&&c.update.call(null,m[0])},i:q,o:q,d(m){m&&d(e),m&&d(o),m&&d(a),m&&d(l),m&&d(u),p=!1,_()}}}function hl(n,e,t){let r,s;return x(n,Te,i=>t(1,s=i)),n.$$.update=()=>{n.$$.dirty&2&&t(0,r=JSON.stringify([].concat(...s.user)))},[r,s]}class fl extends Z{constructor(e){super(),ee(this,e,hl,cl,te,{})}}function Bn(n){let e,t,r,s;const i=[pl,dl],o=[];function a(l,u){return l[3]?0:1}return e=a(n),t=o[e]=i[e](n),{c(){t.c(),r=oe()},l(l){t.l(l),r=oe()},m(l,u){o[e].m(l,u),$(l,r,u),s=!0},p(l,u){let h=e;e=a(l),e===h?o[e].p(l,u):(ge(),F(o[h],1,1,()=>{o[h]=null}),we(),t=o[e],t?t.p(l,u):(t=o[e]=i[e](l),t.c()),D(t,1),t.m(r.parentNode,r))},i(l){s||(D(t),s=!0)},o(l){F(t),s=!1},d(l){o[e].d(l),l&&d(r)}}}function dl(n){let e,t;return e=new lo({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},p:q,i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function pl(n){let e,t,r;function s(o){n[10](o)}let i={};return n[1]!==void 0&&(i.wodReady=n[1]),e=new rl({props:i}),Yn.push(()=>Ss(e,"wodReady",s)),{c(){re(e.$$.fragment)},l(o){ne(e.$$.fragment,o)},m(o,a){se(e,o,a),r=!0},p(o,a){const l={};!t&&a&2&&(t=!0,l.wodReady=o[1],Os(()=>t=!1)),e.$set(l)},i(o){r||(D(e.$$.fragment,o),r=!0)},o(o){F(e.$$.fragment,o),r=!1},d(o){ie(e,o)}}}function Ln(n){let e,t;return e=new io({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function xn(n){let e,t,r,s;const i=[vl,ml],o=[];function a(l,u){return l[3]?0:1}return e=a(n),t=o[e]=i[e](n),{c(){t.c(),r=oe()},l(l){t.l(l),r=oe()},m(l,u){o[e].m(l,u),$(l,r,u),s=!0},p(l,u){let h=e;e=a(l),e!==h&&(ge(),F(o[h],1,1,()=>{o[h]=null}),we(),t=o[e],t||(t=o[e]=i[e](l),t.c()),D(t,1),t.m(r.parentNode,r))},i(l){s||(D(t),s=!0)},o(l){F(t),s=!1},d(l){o[e].d(l),l&&d(r)}}}function ml(n){let e,t;return e=new fl({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function vl(n){let e,t;return e=new al({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function Fn(n){let e;function t(i,o){return i[0]?gl:_l}let r=t(n),s=r(n);return{c(){e=y("p"),s.c(),this.h()},l(i){e=b(i,"P",{class:!0});var o=T(e);s.l(o),o.forEach(d),this.h()},h(){S(e,"class","svelte-17qdobc")},m(i,o){$(i,e,o),s.m(e,null)},p(i,o){r===(r=t(i))&&s?s.p(i,o):(s.d(1),s=r(i),s&&(s.c(),s.m(e,null)))},d(i){i&&d(e),s.d()}}}function _l(n){let e,t;return{c(){e=y("span"),t=O("loading...")},l(r){e=b(r,"SPAN",{});var s=T(e);t=j(s,"loading..."),s.forEach(d)},m(r,s){$(r,e,s),v(e,t)},p:q,d(r){r&&d(e)}}}function gl(n){let e,t,r,s;return{c(){e=y("button"),t=O(n[2])},l(i){e=b(i,"BUTTON",{});var o=T(e);t=j(o,n[2]),o.forEach(d)},m(i,o){$(i,e,o),v(e,t),r||(s=ce(e,"click",n[7]),r=!0)},p(i,o){o&4&&le(t,i[2])},d(i){i&&d(e),r=!1,s()}}}function Gn(n){let e,t;return e=new Wi({}),e.$on("end",n[8]),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},p:q,i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function wl(n){let e,t,r,s,i,o,a=n[4]==="pre"&&Bn(n),l=n[4]!=="pre"&&Ln(),u=n[4]==="post"&&xn(n),h=n[6]&&Fn(n),c=n[5]&&Gn(n);return{c(){a&&a.c(),e=C(),l&&l.c(),t=C(),u&&u.c(),r=C(),h&&h.c(),s=C(),c&&c.c(),i=oe()},l(p){a&&a.l(p),e=I(p),l&&l.l(p),t=I(p),u&&u.l(p),r=I(p),h&&h.l(p),s=I(p),c&&c.l(p),i=oe()},m(p,_){a&&a.m(p,_),$(p,e,_),l&&l.m(p,_),$(p,t,_),u&&u.m(p,_),$(p,r,_),h&&h.m(p,_),$(p,s,_),c&&c.m(p,_),$(p,i,_),o=!0},p(p,[_]){p[4]==="pre"?a?(a.p(p,_),_&16&&D(a,1)):(a=Bn(p),a.c(),D(a,1),a.m(e.parentNode,e)):a&&(ge(),F(a,1,1,()=>{a=null}),we()),p[4]!=="pre"?l?_&16&&D(l,1):(l=Ln(),l.c(),D(l,1),l.m(t.parentNode,t)):l&&(ge(),F(l,1,1,()=>{l=null}),we()),p[4]==="post"?u?(u.p(p,_),_&16&&D(u,1)):(u=xn(p),u.c(),D(u,1),u.m(r.parentNode,r)):u&&(ge(),F(u,1,1,()=>{u=null}),we()),p[6]?h?h.p(p,_):(h=Fn(p),h.c(),h.m(s.parentNode,s)):h&&(h.d(1),h=null),p[5]?c?(c.p(p,_),_&32&&D(c,1)):(c=Gn(p),c.c(),D(c,1),c.m(i.parentNode,i)):c&&(ge(),F(c,1,1,()=>{c=null}),we())},i(p){o||(D(a),D(l),D(u),D(c),o=!0)},o(p){F(a),F(l),F(u),F(c),o=!1},d(p){a&&a.d(p),p&&d(e),l&&l.d(p),p&&d(t),u&&u.d(p),p&&d(r),h&&h.d(p),p&&d(s),c&&c.d(p),p&&d(i)}}}function yl(n,e,t){let r,s,i,o,a,l,u,h;x(n,xe,P=>t(3,o=P)),x(n,Tr,P=>t(4,a=P)),x(n,Ee,P=>t(11,l=P)),x(n,et,P=>t(12,u=P)),x(n,It,P=>t(13,h=P));let{loaded:c}=e,p=!1,_;const m={pre:"Begin game",mid:"Next round"},g=()=>{o&&us({table:"wordgame_games",column:"wod_started",value:!0,id:h}),t(5,p=!0)},k=()=>{me(et,u=!0,u),me(Ee,l+=1,l),t(5,p=!1)};function E(P){_=P,t(1,_)}return n.$$set=P=>{"loaded"in P&&t(0,c=P.loaded)},n.$$.update=()=>{n.$$.dirty&16&&t(2,r=m[a]),n.$$.dirty&26&&t(9,s=o&&a==="pre"&&!_),n.$$.dirty&524&&t(6,i=r&&(!o||!s))},[c,_,r,o,a,p,i,g,k,s,E]}class bl extends Z{constructor(e){super(),ee(this,e,yl,wl,te,{loaded:0})}}async function kl(n){const e=`https://pudding.cool/projects/word-game-data/game-clues/${n}.csv?version=${Date.now()}`,r=(await jr(e)).map(s=>ht(Ne({},s),{round:+s.round}));return r.sort((s,i)=>Ps(s.round,i.round)),r}async function El(n){const e=[];for(let t of n){const r=`https://pudding.cool/projects/word-game-data/clue-answers/${t}.csv?version=${Date.now()}`,i=(await jr(r)).map(o=>ht(Ne({},o),{points:+o.points}));e.push(i)}return e}async function Tl(n){return await(await fetch(n)).json()}function Hn(n){let e,t;return e=new ti({}),{c(){re(e.$$.fragment)},l(r){ne(e.$$.fragment,r)},m(r,s){se(e,r,s),t=!0},i(r){t||(D(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){ie(e,r)}}}function qn(n){let e,t,r;return t=new qi({props:{clues:n[0],answers:n[1]}}),{c(){e=y("section"),re(t.$$.fragment),this.h()},l(s){e=b(s,"SECTION",{id:!0,class:!0});var i=T(e);ne(t.$$.fragment,i),i.forEach(d),this.h()},h(){S(e,"id","play"),S(e,"class","svelte-zc6s8i")},m(s,i){$(s,e,i),se(t,e,null),r=!0},p(s,i){const o={};i&1&&(o.clues=s[0]),i&2&&(o.answers=s[1]),t.$set(o)},i(s){r||(D(t.$$.fragment,s),r=!0)},o(s){F(t.$$.fragment,s),r=!1},d(s){s&&d(e),ie(t)}}}function zn(n){let e,t,r;return t=new bl({props:{loaded:n[2]}}),{c(){e=y("section"),re(t.$$.fragment),this.h()},l(s){e=b(s,"SECTION",{id:!0,class:!0});var i=T(e);ne(t.$$.fragment,i),i.forEach(d),this.h()},h(){S(e,"id","modal"),S(e,"class","svelte-zc6s8i")},m(s,i){$(s,e,i),se(t,e,null),r=!0},p(s,i){const o={};i&4&&(o.loaded=s[2]),t.$set(o)},i(s){r||(D(t.$$.fragment,s),r=!0)},o(s){F(t.$$.fragment,s),r=!1},d(s){s&&d(e),ie(t)}}}function Sl(n){let e,t,r,s,i=n[5]&&Hn(),o=n[4]&&qn(n),a=n[3]&&zn(n);return{c(){i&&i.c(),e=C(),o&&o.c(),t=C(),a&&a.c(),r=oe()},l(l){i&&i.l(l),e=I(l),o&&o.l(l),t=I(l),a&&a.l(l),r=oe()},m(l,u){i&&i.m(l,u),$(l,e,u),o&&o.m(l,u),$(l,t,u),a&&a.m(l,u),$(l,r,u),s=!0},p(l,[u]){l[5]?i?u&32&&D(i,1):(i=Hn(),i.c(),D(i,1),i.m(e.parentNode,e)):i&&(ge(),F(i,1,1,()=>{i=null}),we()),l[4]?o?(o.p(l,u),u&16&&D(o,1)):(o=qn(l),o.c(),D(o,1),o.m(t.parentNode,t)):o&&(ge(),F(o,1,1,()=>{o=null}),we()),l[3]?a?(a.p(l,u),u&8&&D(a,1)):(a=zn(l),a.c(),D(a,1),a.m(r.parentNode,r)):a&&(ge(),F(a,1,1,()=>{a=null}),we())},i(l){s||(D(i),D(o),D(a),s=!0)},o(l){F(i),F(o),F(a),s=!1},d(l){i&&i.d(l),l&&d(e),o&&o.d(l),l&&d(t),a&&a.d(l),l&&d(r)}}}function Ol(n,e,t){let r,s,i,o,a,l,u;x(n,dr,m=>t(5,i=m)),x(n,It,m=>t(8,o=m)),x(n,xe,m=>t(9,a=m)),x(n,Tr,m=>t(6,l=m)),x(n,et,m=>t(7,u=m));let h,c,p;const _=async()=>{if(a)return o;const g=`https://pudding.cool/projects/word-game-data/games.json?version=${Date.now()}`,{updated:k,games:E}=await Tl(g);console.log("updated:",k);const{id:P}=E.find(L=>L.live);return P};return yt(async()=>{me(dr,i=await _(),i);const m=await kl(i);t(0,h=m.map(g=>g.clue)),t(1,c=await El(m.map(g=>g.clueId))),t(2,p=!0)}),n.$$.update=()=>{n.$$.dirty&192&&t(4,r=l==="mid"&&u),n.$$.dirty&192&&t(3,s=!u||["pre","post"].includes(l))},[h,c,p,s,r,i,l,u]}class jl extends Z{constructor(e){super(),ee(this,e,Ol,Sl,te,{})}}function $l(n){let e,t,r,s,i,o,a,l,u,h,c,p,_,m,g,k,E,P,L,W,B,R,G,U,J,K,A,z,M,f,w,N,V,Y,H,ve,de,Se,Ge,He,qe,nt,Mt,Bt,Lt,ze,st,xt,Ft,Gt,it,Ht,qt,be,ot,zt,Jt,at,Wt,Vt,lt,Yt,Kt,ut,Xt,Qt,ct,Je,Zt,er,Cr;return{c(){e=y("section"),t=y("div"),r=y("h3"),s=O("How to Play"),i=C(),o=y("ul"),a=y("li"),l=y("strong"),u=O("Goal:"),h=O(" score more points than the Word Opponent of the Day (WOD)."),c=C(),p=y("li"),_=y("strong"),m=O("Duration:"),g=O(" Four one-minute rounds."),k=C(),E=y("li"),P=y("strong"),L=O("Gameplay:"),W=O(` Enter as many words as possible that satisfy a clue.
        `),B=y("ul"),R=y("li"),G=y("strong"),U=O("Sample clue"),J=O(": "),K=y("em"),A=O("words that start with "),z=y("strong"),M=O("A"),f=O(`
            . Answers: `),w=y("em"),N=O("apple"),V=O(", "),Y=y("em"),H=O("awesome"),ve=O(", "),de=y("em"),Se=O("activate"),Ge=O(", etc."),He=C(),qe=y("li"),nt=y("strong"),Mt=O("Blocking!"),Bt=O(` Whoever gets a word first gets points. If the WOD entered the
            word before you, you get no points. If you enter a word before the WOD, she gets no points.`),Lt=C(),ze=y("li"),st=y("strong"),xt=O("The more obscure the better!"),Ft=O(` You get more points for less commonly used
            words.`),Gt=C(),it=y("h3"),Ht=O("Rules"),qt=C(),be=y("ul"),ot=y("li"),zt=O("4+ letter words"),Jt=C(),at=y("li"),Wt=O("No proper nouns"),Vt=C(),lt=y("li"),Yt=O("No hyphenated words"),Kt=C(),ut=y("li"),Xt=O("No variations (e.g. plurals) of a played word"),Qt=C(),ct=y("p"),Je=y("button"),Zt=O("CLOSE"),this.h()},l(Ie){e=b(Ie,"SECTION",{class:!0});var We=T(e);t=b(We,"DIV",{class:!0});var Oe=T(t);r=b(Oe,"H3",{});var Ir=T(r);s=j(Ir,"How to Play"),Ir.forEach(d),i=I(Oe),o=b(Oe,"UL",{});var Ve=T(o);a=b(Ve,"LI",{});var tr=T(a);l=b(tr,"STRONG",{});var Nr=T(l);u=j(Nr,"Goal:"),Nr.forEach(d),h=j(tr," score more points than the Word Opponent of the Day (WOD)."),tr.forEach(d),c=I(Ve),p=b(Ve,"LI",{});var rr=T(p);_=b(rr,"STRONG",{});var Ur=T(_);m=j(Ur,"Duration:"),Ur.forEach(d),g=j(rr," Four one-minute rounds."),rr.forEach(d),k=I(Ve),E=b(Ve,"LI",{});var Et=T(E);P=b(Et,"STRONG",{});var Dr=T(P);L=j(Dr,"Gameplay:"),Dr.forEach(d),W=j(Et,` Enter as many words as possible that satisfy a clue.
        `),B=b(Et,"UL",{});var Ye=T(B);R=b(Ye,"LI",{});var ke=T(R);G=b(ke,"STRONG",{});var Mr=T(G);U=j(Mr,"Sample clue"),Mr.forEach(d),J=j(ke,": "),K=b(ke,"EM",{});var nr=T(K);A=j(nr,"words that start with "),z=b(nr,"STRONG",{});var Br=T(z);M=j(Br,"A"),Br.forEach(d),nr.forEach(d),f=j(ke,`
            . Answers: `),w=b(ke,"EM",{});var Lr=T(w);N=j(Lr,"apple"),Lr.forEach(d),V=j(ke,", "),Y=b(ke,"EM",{});var xr=T(Y);H=j(xr,"awesome"),xr.forEach(d),ve=j(ke,", "),de=b(ke,"EM",{});var Fr=T(de);Se=j(Fr,"activate"),Fr.forEach(d),Ge=j(ke,", etc."),ke.forEach(d),He=I(Ye),qe=b(Ye,"LI",{});var sr=T(qe);nt=b(sr,"STRONG",{});var Gr=T(nt);Mt=j(Gr,"Blocking!"),Gr.forEach(d),Bt=j(sr,` Whoever gets a word first gets points. If the WOD entered the
            word before you, you get no points. If you enter a word before the WOD, she gets no points.`),sr.forEach(d),Lt=I(Ye),ze=b(Ye,"LI",{});var ir=T(ze);st=b(ir,"STRONG",{});var Hr=T(st);xt=j(Hr,"The more obscure the better!"),Hr.forEach(d),Ft=j(ir,` You get more points for less commonly used
            words.`),ir.forEach(d),Ye.forEach(d),Et.forEach(d),Ve.forEach(d),Gt=I(Oe),it=b(Oe,"H3",{});var qr=T(it);Ht=j(qr,"Rules"),qr.forEach(d),qt=I(Oe),be=b(Oe,"UL",{});var Re=T(be);ot=b(Re,"LI",{});var zr=T(ot);zt=j(zr,"4+ letter words"),zr.forEach(d),Jt=I(Re),at=b(Re,"LI",{});var Jr=T(at);Wt=j(Jr,"No proper nouns"),Jr.forEach(d),Vt=I(Re),lt=b(Re,"LI",{});var Wr=T(lt);Yt=j(Wr,"No hyphenated words"),Wr.forEach(d),Kt=I(Re),ut=b(Re,"LI",{});var Vr=T(ut);Xt=j(Vr,"No variations (e.g. plurals) of a played word"),Vr.forEach(d),Re.forEach(d),Qt=I(Oe),ct=b(Oe,"P",{});var Yr=T(ct);Je=b(Yr,"BUTTON",{});var Kr=T(Je);Zt=j(Kr,"CLOSE"),Kr.forEach(d),Yr.forEach(d),Oe.forEach(d),We.forEach(d),this.h()},h(){S(t,"class","svelte-5rby5g"),S(e,"class","svelte-5rby5g"),_e(e,"visible",n[0]==="rules")},m(Ie,We){$(Ie,e,We),v(e,t),v(t,r),v(r,s),v(t,i),v(t,o),v(o,a),v(a,l),v(l,u),v(a,h),v(o,c),v(o,p),v(p,_),v(_,m),v(p,g),v(o,k),v(o,E),v(E,P),v(P,L),v(E,W),v(E,B),v(B,R),v(R,G),v(G,U),v(R,J),v(R,K),v(K,A),v(K,z),v(z,M),v(R,f),v(R,w),v(w,N),v(R,V),v(R,Y),v(Y,H),v(R,ve),v(R,de),v(de,Se),v(R,Ge),v(B,He),v(B,qe),v(qe,nt),v(nt,Mt),v(qe,Bt),v(B,Lt),v(B,ze),v(ze,st),v(st,xt),v(ze,Ft),v(t,Gt),v(t,it),v(it,Ht),v(t,qt),v(t,be),v(be,ot),v(ot,zt),v(be,Jt),v(be,at),v(at,Wt),v(be,Vt),v(be,lt),v(lt,Yt),v(be,Kt),v(be,ut),v(ut,Xt),v(t,Qt),v(t,ct),v(ct,Je),v(Je,Zt),er||(Cr=[ce(Je,"click",n[1]),ce(e,"click",n[1])],er=!0)},p(Ie,[We]){We&1&&_e(e,"visible",Ie[0]==="rules")},i:q,o:q,d(Ie){Ie&&d(e),er=!1,wt(Cr)}}}function Pl(n,e,t){let r;return x(n,ye,i=>t(0,r=i)),[r,()=>{me(ye,r=void 0,r)}]}class Rl extends Z{constructor(e){super(),ee(this,e,Pl,$l,te,{})}}function Al(n){let e,t,r,s,i,o,a,l,u,h;return{c(){e=y("section"),t=y("div"),r=y("h3"),s=O("About"),i=C(),o=y("p"),a=y("button"),l=O("CLOSE"),this.h()},l(c){e=b(c,"SECTION",{class:!0});var p=T(e);t=b(p,"DIV",{class:!0});var _=T(t);r=b(_,"H3",{});var m=T(r);s=j(m,"About"),m.forEach(d),i=I(_),o=b(_,"P",{});var g=T(o);a=b(g,"BUTTON",{});var k=T(a);l=j(k,"CLOSE"),k.forEach(d),g.forEach(d),_.forEach(d),p.forEach(d),this.h()},h(){S(t,"class","svelte-5rby5g"),S(e,"class","svelte-5rby5g"),_e(e,"visible",n[0]==="about")},m(c,p){$(c,e,p),v(e,t),v(t,r),v(r,s),v(t,i),v(t,o),v(o,a),v(a,l),u||(h=[ce(a,"click",n[1]),ce(e,"click",n[1])],u=!0)},p(c,[p]){p&1&&_e(e,"visible",c[0]==="about")},i:q,o:q,d(c){c&&d(e),u=!1,wt(h)}}}function Cl(n,e,t){let r;return x(n,ye,i=>t(0,r=i)),[r,()=>{me(ye,r=void 0,r)}]}class Il extends Z{constructor(e){super(),ee(this,e,Cl,Al,te,{})}}function Nl(n){let e,t,r,s,i,o,a,l;return e=new Qs({}),r=new jl({}),i=new Rl({}),a=new Il({}),{c(){re(e.$$.fragment),t=C(),re(r.$$.fragment),s=C(),re(i.$$.fragment),o=C(),re(a.$$.fragment)},l(u){ne(e.$$.fragment,u),t=I(u),ne(r.$$.fragment,u),s=I(u),ne(i.$$.fragment,u),o=I(u),ne(a.$$.fragment,u)},m(u,h){se(e,u,h),$(u,t,h),se(r,u,h),$(u,s,h),se(i,u,h),$(u,o,h),se(a,u,h),l=!0},p:q,i(u){l||(D(e.$$.fragment,u),D(r.$$.fragment,u),D(i.$$.fragment,u),D(a.$$.fragment,u),l=!0)},o(u){F(e.$$.fragment,u),F(r.$$.fragment,u),F(i.$$.fragment,u),F(a.$$.fragment,u),l=!1},d(u){ie(e,u),u&&d(t),ie(r,u),u&&d(s),ie(i,u),u&&d(o),ie(a,u)}}}class Fl extends Z{constructor(e){super(),ee(this,e,null,Nl,te,{})}}export{Fl as A,Bl as M,xe as a,xl as g,Ll as s,It as w};
